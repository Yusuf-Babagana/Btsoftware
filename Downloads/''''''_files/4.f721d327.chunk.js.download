(this.webpackJsonpRhyme=this.webpackJsonpRhyme||[]).push([[4,2],{1045:function(e,t,n){"use strict";var r,o,a,i,s,c,p,l,u,d,h,m=n(4),f=n(1065),y=n(87),v=n(5),b=n(11),g=n(30),O=n(28),C=n(29),k=(n(1298),n(88)),j=n.n(k),w=(n(1299),n(1152)),E=n(1071),_=n(290),S=function e(){Object(v.a)(this,e)},D=(r=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._input=void 0,n._keyEventCb=void 0,n._docClickCb=void 0,n._inputBlurEvent=void 0,n._clickFlag=void 0,n.state={filtered:[],highlighted:null,focused:!1,disabledFiltering:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.showSuggestions){var t=this.props.showSuggestions?this._input.value:"";this._performFiltering(t)}}},{key:"onChange",value:function(e){if(!this.state.disabledFiltering){var t=e.target.value;this._performFiltering(t)}this.props.onChange(e)}},{key:"onClick",value:function(e){e.stopPropagation(),this._clickFlag=!0}},{key:"onFocus",value:function(e){this.setState({focused:!0,disabledFiltering:!1}),this.props.onFocus(e)}},{key:"selectOption",value:function(e){this._clickFlag=!0;var t=e.target.getAttribute("data-sugg");this._applyOption(t)}},{key:"resetFocus",value:function(){this.setState({highlighted:null})}},{key:"preserveBlurEvent",value:function(e){this.state.filtered.length?(e.persist(),this._inputBlurEvent=e):this.props.onBlur(e)}},{key:"focusInput",value:function(){this._input.focus();var e=this._input.value.length;this._input.setSelectionRange(e,e)}},{key:"componentDidMount",value:function(){var e=this;this._input.addEventListener("keydown",this._keyEventCb=function(t){return e._keyboardControl(t)}),document.addEventListener("click",this._docClickCb=function(t){e._clickFlag?e._clickFlag=!1:e.setState({focused:!1},(function(){e.props.onBlur(e._inputBlurEvent)}))})}},{key:"componentWillUnmount",value:function(){this._input.removeEventListener("keydown",this._keyEventCb),document.removeEventListener("click",this._docClickCb)}},{key:"render",value:function(){var e=this,t=this.props.manager,n=!!this.state.filtered.length&&this.state.focused||this.props.showSuggestions;return m.createElement("div",{className:"autocomplete-input"},m.createElement("div",null,m.createElement(E.a,{type:"text",autoComplete:"off",spellCheck:!1,label:this.props.label,name:this.props.name,value:this.props.value,disabled:this.props.disabled,error:this.props.error,autoFocus:this.props.autoFocus,onRef:function(t){return e._input=t},onChange:this.onChange,onClick:this.onClick,onBlur:this.preserveBlurEvent,onFocus:this.onFocus})),m.createElement("ul",{className:n?"visible":"",onClick:this.selectOption,onMouseEnter:this.resetFocus},this.state.filtered.map((function(n,r){return m.createElement("li",{key:"k-"+r,className:e.state.highlighted===n?"highlighted":"","data-sugg":n.t},t.stringify(n.s))}))))}},{key:"_performFiltering",value:function(e){var t=this.props.suggestions,n=this.props.manager.filterStrategy(e,t);this.setState({filtered:n,highlighted:null})}},{key:"_applyOption",value:function(e){this._input.value=e,this.props.onSelect(e),this.setState({filtered:[],highlighted:null})}},{key:"_keyboardControl",value:function(e){if(this.state.filtered.length){[_.e,_.b,_.l,_.f].forEach((function(t){t===e.keyCode&&e.preventDefault()}));var t=this.state,n=t.highlighted,r=t.filtered;switch(e.keyCode){case _.b:case _.l:this.setState({highlighted:Object(w.a)(r,n,0,r.length-1)});break;case _.e:this.setState({highlighted:Object(w.a)(r,n,r.length-1,0)});break;case _.f:n&&this._applyOption(n.t);break;case _.g:this.setState({disabledFiltering:!0,filtered:[],highlighted:null})}}}}]),t}(m.Component),Object(y.a)(r.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"onChange"),r.prototype),Object(y.a)(r.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),Object(y.a)(r.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"onFocus"),r.prototype),Object(y.a)(r.prototype,"selectOption",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"selectOption"),r.prototype),Object(y.a)(r.prototype,"resetFocus",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"resetFocus"),r.prototype),Object(y.a)(r.prototype,"preserveBlurEvent",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"preserveBlurEvent"),r.prototype),r),P=n(1301),T=new(function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"filterStrategy",value:function(e,t){if("@"===e[e.length-1])return this._map(e,t).slice(0,8);var n=e.indexOf("@");if(-1!==n){var r=e.substring(n,e.length);return this._map(e,t.filter((function(e){return e.startsWith(r)&&e!==r}))).slice(0,8)}return[]}},{key:"stringify",value:function(e){return e}},{key:"_map",value:function(e,t){return t.map((function(t){return{s:t,t:e.split("@")[0]+t}}))}}]),t}(S)),R=(o=function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(o))))._ref=void 0,n._divPlaceholder=void 0,n._options=void 0,n._inputPaddingLeft=void 0,n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this._options=this._ref.querySelector("ul")}},{key:"onChange",value:function(e){if(e.target&&-1!==e.target.value.indexOf("@")&&this._options){var t=e.target.value.split("@")[0];this._divPlaceholder.innerHTML=t;var n=this._divPlaceholder.clientWidth;this._inputPaddingLeft||(this._inputPaddingLeft=parseInt(window.getComputedStyle(e.target)["padding-left"].replace("px",""),10)),n<157&&(this._options.style.left=n+this._inputPaddingLeft-25+"px")}this.props.input.onChange(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.input,r=t.meta,o=this.props,a=r.touched&&r.dirty&&r.error&&!r.active;return m.createElement("div",{className:"email-input",ref:function(t){return e._ref=t}},m.createElement(D,{label:o.label?o.label:"Email",manager:T,suggestions:this.emailProviders,name:n.name,value:n.value,error:a?r.error:null,disabled:this.props.disabled,autoFocus:this.props.autoFocus,onSelect:this.props.input.onChange,onChange:this.onChange,onFocus:n.onFocus,onBlur:n.onBlur}),m.createElement("div",{ref:function(t){return e._divPlaceholder=t},className:"mail-name-holder"}))}},{key:"emailProviders",get:function(){return P.map((function(e){return"@"+e}))}}]),t}(m.Component),Object(y.a)(o.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(o.prototype,"onChange"),o.prototype),o),x=(n(1302),a=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._autocompleteInputRef=void 0,n._clickFlag=void 0,n._docClickCb=void 0,n.state={optionsVisible:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag?e._clickFlag=!1:e.setState({optionsVisible:!1})})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb)}},{key:"toggleOptionsVisiblity",value:function(){this._clickFlag=!0,this.setState({optionsVisible:!this.state.optionsVisible})}},{key:"onFocus",value:function(e){this._clickFlag=!0,this.props.onFocus(e),this.setState({optionsVisible:!0})}},{key:"onSelect",value:function(e){this.props.onChange(e),this._clickFlag=!0,this.setState({optionsVisible:!1})}},{key:"focusInput",value:function(){this._autocompleteInputRef&&this._autocompleteInputRef.focusInput()}},{key:"render",value:function(){var e=this,t=D;return m.createElement("div",{className:"autocomplete-select"+(this.state.optionsVisible?" visible":"")},m.createElement(t,{ref:function(t){return e._autocompleteInputRef=t},manager:this.props.manager,suggestions:this.props.options,error:this.props.error,label:this.props.label,name:this.props.name,value:this.props.value,onChange:this.props.onChange,onBlur:this.props.onBlur,onFocus:this.onFocus,onSelect:this.onSelect,showSuggestions:this.state.optionsVisible}),m.createElement("div",{className:"arrow",onClick:this.toggleOptionsVisiblity}))}}]),t}(m.Component),Object(y.a)(a.prototype,"toggleOptionsVisiblity",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleOptionsVisiblity"),a.prototype),Object(y.a)(a.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"onFocus"),a.prototype),Object(y.a)(a.prototype,"onSelect",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"onSelect"),a.prototype),a),M=n(1084),N=n(1085),V=(i=function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onBlur",value:function(){if(this.props.onBlur){var e="+1 "===this.props.value?"":this.props.value;this.props.onBlur(e)}}},{key:"onChange",value:function(e){this.props.onChange(e.target.value)}},{key:"onFocus",value:function(e){e.target.value||this.props.onChange("+1 "),this.props.onFocus&&this.props.onFocus(e)}},{key:"render",value:function(){return m.createElement(E.a,{type:"text",placeholder:"+1 XXX-XXX-XXXX",label:this.props.label||"Cell Number",name:this.props.name,className:this.props.className,value:this.props.value,error:this.props.error,autoComplete:"off",alwaysShowPlaceholder:this.props.alwaysShowPlaceholder,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onDragStart:this.props.onDragStart,onDrop:this.props.onDrop})}}]),t}(m.PureComponent),Object(y.a)(i.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onBlur"),i.prototype),Object(y.a)(i.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onChange"),i.prototype),Object(y.a)(i.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onFocus"),i.prototype),i),A=n(119),I=function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.meta,r=Object(A.a)(e,["input","meta"]),o=n.touched&&n.dirty&&n.error&&!n.active;return m.createElement(V,Object.assign({},r,{name:t.name,value:t.value,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,onDragStart:t.onDragStart,onDrop:t.onDrop,error:o?n.error:null}))}}]),t}(m.PureComponent),U=(n(1306),m.Component,n(1307),function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return m.createElement("div",{className:"coursera-login-btn "+(this.props.className||""),onClick:this.props.onClick},m.createElement("span",{className:"icon"}),m.createElement("span",{className:"label"},this.props.label))}}]),t}(m.Component)),L=(n(1308),function(e){var t=e.input,n=e.meta,r=Object(A.a)(e,["input","meta"]),o=n.touched&&n.dirty&&n.error&&!n.active;return m.createElement(E.a,Object.assign({},r,{name:t.name,value:t.value,className:e.className,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,onDragStart:t.onDragStart,onDrop:t.onDrop,error:o?n.error:null}))}),F=(n(1309),function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(o))))._textarea=void 0,n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"focus",value:function(){this._textarea&&this._textarea.focus()}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"rhyme-textarea","data-name":this.props.name},m.createElement("textarea",{ref:function(t){return e._textarea=t},value:this.props.value,cols:this.props.cols,rows:this.props.rows,disabled:this.props.disabled,autoFocus:this.props.autoFocus,className:this.className,name:this.props.name,placeholder:this.props.placeholder,onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur}),this.props.label&&m.createElement("span",{className:"label"},this.props.label),this.props.error&&m.createElement("span",{className:"input-error-msg"},this.props.error))}},{key:"className",get:function(){var e="";return this.props.className&&(e+=this.props.className),this.props.value&&(e+=" filled-input"),this.props.error&&(e+=" error"),e}}]),t}(m.Component)),z=function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.meta,r=Object(A.a)(e,["input","meta"]);return m.createElement(F,Object.assign({value:t.value,name:t.name,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,error:this.errored?n.error:null},r))}},{key:"errored",get:function(){var e=this.props.meta;return e.touched&&e.dirty&&e.error&&!e.active}}]),t}(m.Component),B=n(1096),W=n(1114),H=(n(1311),function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(o))))._ref=void 0,n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this._listenForFocusChanges()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=Object(A.a)(t,["className"]);return m.createElement("fieldset",Object.assign({ref:function(t){return e._ref=t},className:"rhyme-fieldset"+(n?" "+n:"")},r),this.props.children)}},{key:"_listenForFocusChanges",value:function(){var e=this;if(/Edge/.test(window.navigator.userAgent)){var t=this._ref.getElementsByTagName("input");[].slice.call(t).forEach((function(t){t.addEventListener("focus",(function(){return e._focus()})),t.addEventListener("blur",(function(){return e._unfocus()}))}))}}},{key:"_focus",value:function(){this._ref.style.zIndex="9"}},{key:"_unfocus",value:function(){this._ref.style.zIndex="0"}}]),t}(m.Component)),K=function(e){var t=e.input,n=e.meta,r=Object(A.a)(e,["input","meta"]);return m.createElement(B.a,Object.assign({},r,{value:t.value,onChange:function(n){return Y(n,t.onChange,e.onSelect)},dirty:n.dirty}))},Y=function(e,t,n){t(e),n&&n(e)},G=n(1561),J=(s=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._input=void 0,n._label=void 0,n._arrow=void 0,n._inputWrapper=void 0,n.state={isCalendarOpen:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onClickOutside",value:function(e){var t=e.target;this._isOutsideFieldWrapper(t)&&this.unfocusInput(e)}},{key:"unfocusInput",value:function(e){this.onInputBlur(e),this.setState({isCalendarOpen:!1})}},{key:"onInputFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"onInputBlur",value:function(e){this.props.onBlur&&this.props.onBlur(e)}},{key:"onInputClick",value:function(e){this.props.focused||this.onInputFocus(e)}},{key:"onClick",value:function(e){if(this.props.onClick&&!this.props.disabled){var t=e.target===this._inputWrapper||!this.state.isCalendarOpen;t&&(this._input&&this._input.focus(),this.props.onClick(e)),this.setState({isCalendarOpen:t})}}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"date-picker-field"+(this.props.focused?" focused":"")+(this.props.disabled?" disabled":""),"data-name":this.props.name,onClick:this.onClick},m.createElement("div",{className:"selected",ref:function(t){return e._inputWrapper=t}},this.props.label&&m.createElement("span",{ref:function(t){return e._label=t},className:"label"},this.props.label),m.createElement("input",{ref:function(t){return e._input=t},className:"rhyme-date-picker-input",value:this.props.value,onChange:this.props.onChange,onFocus:this.onInputFocus,onClick:this.onInputClick,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,name:this.props.name,disabled:this.props.disabled})),m.createElement("div",{className:"arrow",ref:function(t){return e._arrow=t}}))}},{key:"_isOutsideFieldWrapper",value:function(e){return e!==this._label&&e!==this._arrow&&e!==this._inputWrapper}}]),t}(m.Component),Object(y.a)(s.prototype,"onInputFocus",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputFocus"),s.prototype),Object(y.a)(s.prototype,"onInputBlur",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputBlur"),s.prototype),Object(y.a)(s.prototype,"onInputClick",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputClick"),s.prototype),Object(y.a)(s.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onClick"),s.prototype),s),Z=(n(1312),c=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._calendar=void 0,n.state={focused:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"onBlur",value:function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()}},{key:"onClickOutside",value:function(e){this._calendar.input.onClickOutside(e)}},{key:"onChange",value:function(e,t){e&&this.props.onDateChange(e),this._calendar.input.unfocusInput(t),this.onBlur()}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"rhyme-date-picker"},m.createElement(G.a,{ref:function(t){return e._calendar=t},customInput:m.createElement(J,{focused:this.state.focused,label:this.props.label}),selected:this.props.date,dateFormat:"YYYY-MM-DD",onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.props.disabled,minDate:this.props.minDate,onClickOutside:this.onClickOutside}))}}]),t}(m.Component),Object(y.a)(c.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onFocus"),c.prototype),Object(y.a)(c.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onBlur"),c.prototype),Object(y.a)(c.prototype,"onClickOutside",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onClickOutside"),c.prototype),Object(y.a)(c.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onChange"),c.prototype),c),q=n(1473),X=n(291),$=(n(1313),n(491)),Q=["Canada/Atlantic","US/Alaska"],ee=new Map([["HST","Hawaii Time"],["US/Alaska","Alaska Time"],["Canada/Atlantic","Atlantic Time"],["PST8PDT","Pacific Time"],["MST7MDT","Mountain Time"],["CST6CDT","Central Time"],["EST5EDT","Eastern Time"]]),te=new Map([["HST",["HTS","HDT"]],["US/Alaska",["AKDT","AKST"]],["Canada/Atlantic",["AST","ADT"]],["PST8PDT",["PST","PDT"]],["MST7MDT",["MST","MDT"]],["CST6CDT",["CST","CDT"]],["EST5EDT",["EST","EDT"]]]),ne=function(e){return!e.startsWith("Etc/")&&"EST"!==e&&"MST"!==e},re=function(e){var t=e.map((function(e){return e.split("|")[0]})).filter(ne);t=t.concat(Q);var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value,p=X.tz(c).format("Z");n.push({location:c,offset:p})}}catch(l){o=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n.sort((function(e,t){var n=e.offset.replace(":",""),r=t.offset.replace(":","");return parseInt(n,10)-parseInt(r,10)})).map((function(e){var t=e.location,n=e.offset,r=ee.has(t)?ee.get(t):t.split("_").join(" "),o=te.get(t);return{location:t,label:"(GMT ".concat(n,") ").concat(r),aliases:o}}))}($.zones),oe={threshold:.3,keys:["label","aliases"]},ae=new(function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"filterStrategy",value:function(e,t){return e?new q(t,oe).search(e).map((function(e){return{s:e,t:e.location}})):t.map((function(e){return{s:e,t:e.location}}))}},{key:"stringify",value:function(e){return e.label}}]),t}(S)),ie=x,se=(p=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._autocompleteSelectRef=void 0,n.state={selected:!1,inputValue:n._getTimezoneLabel(n.props.timezone)},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentWillUpdate",value:function(e,t){(e.timezone!==this.props.timezone||!t.selected&&t.selected!==this.state.selected)&&this.setState({inputValue:this._getTimezoneLabel(e.timezone)})}},{key:"componentDidUpdate",value:function(e,t){this.state.selected&&this.state.selected!==t.selected&&this._autocompleteSelectRef&&this._autocompleteSelectRef.focusInput()}},{key:"onToggle",value:function(){this.setState((function(e){return{selected:!e.selected}}))}},{key:"onChange",value:function(e){if("object"===typeof e)this.setState({inputValue:e.target.value});else{var t=re.find((function(t){return t.location===e}));t?this.props.onTimezoneChange(t.location):this.props.onTimezoneChange(this.props.timezone)}}},{key:"onBlur",value:function(e){this.setState({selected:!1})}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"rhyme-timezone"+(this.props.disabled?" disabled":"")},this.state.selected&&!this.props.disabled?m.createElement(ie,{ref:function(t){return e._autocompleteSelectRef=t},manager:ae,options:re,name:"timezone",value:this.state.inputValue,onChange:this.onChange,onBlur:this.onBlur,onFocus:function(){}}):m.createElement("div",{className:"selected",onClick:this.onToggle},this._getTimezoneLabel(this.props.timezone)))}},{key:"_getTimezoneLabel",value:function(e){var t=re.find((function(t){return t.location===e}));return t?t.label:e}}]),t}(m.Component),Object(y.a)(p.prototype,"onToggle",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onToggle"),p.prototype),Object(y.a)(p.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onChange"),p.prototype),Object(y.a)(p.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onBlur"),p.prototype),p),ce=function(e){var t=e.input,n=(e.meta,Object(A.a)(e,["input","meta"]));return m.createElement(se,Object.assign({},n,{timezone:t.value,onTimezoneChange:t.onChange}))},pe=n(1129),le=n(164),ue=(n(1319),l=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._timeOptions=function(e,t,n){for(var r=le.duration(1,"day").as(n),o=[],a=le(e,"hh:mm"),i=0;i<r;i+=t)a.add(0===i?0:t,n),o.push(a.format("hh:mma"));return o}("00:00",30,"m"),n._timeRef=void 0,n.state={focused:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onTimeChange",value:function(e){var t=this._getTimeDate(e),n=t.isValid()?t:this.props.date;this.props.onTimeChange(n)}},{key:"onTimeShowOptions",value:function(){if(this._timeRef){var e=this._roundTime(this.props.date).format("hh:mma");this._timeRef.scrollToOption(e)}}},{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"onBlur",value:function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()}},{key:"render",value:function(){var e=this.props.date.format("hh:mma");return m.createElement("div",{className:"rhyme-time-picker"+(this.props.disabled?" disabled":"")+(this.state.focused?" focused":"")},m.createElement(B.a,{ref:this._setTimeRef,className:"time-select",editable:!0,value:e,disabled:this.props.disabled,onChange:this.onTimeChange,onFocus:this.onFocus,onBlur:this.onBlur,onShowOptions:this.onTimeShowOptions},this.renderTimeOptions()))}},{key:"renderTimeOptions",value:function(){var e=this;return this._timeOptions.map((function(t){var n=!1;e.props.minDate&&(n=!e._getTimeDate(t).isSameOrAfter(e.props.minDate,"minute"));return m.createElement(W.a,{value:t,key:t,disabled:n},t)}))}},{key:"_roundTime",value:function(e){var t=le(e),n=t.minute()%30;return 0!==n&&(t=le(t).add(-n,"minutes")),t}},{key:"_setTimeRef",value:function(e){this._timeRef=e}},{key:"_getTimeDate",value:function(e){var t=this.props.date.format("MM-DD-YYYY")+e;return le(t,"".concat("MM-DD-YYYY").concat("hh:mma"))}}]),t}(m.Component),Object(y.a)(l.prototype,"onTimeChange",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onTimeChange"),l.prototype),Object(y.a)(l.prototype,"onTimeShowOptions",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onTimeShowOptions"),l.prototype),Object(y.a)(l.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onFocus"),l.prototype),Object(y.a)(l.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onBlur"),l.prototype),Object(y.a)(l.prototype,"_setTimeRef",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"_setTimeRef"),l.prototype),l),de=(n(1320),u=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={focused:!1},n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onDateChange",value:function(e){var t=this._mergeDateAndTime(e,this.props.date);this.props.onDateChange(t)}},{key:"onTimeChange",value:function(e){var t=this._mergeDateAndTime(this.props.date,e);this.props.onDateChange(t)}},{key:"onFocusChange",value:function(e){this.setState({focused:e})}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"rhyme-date-time-picker","data-name":this.props.name},m.createElement("div",{className:"pickers"+(this.props.disabled?" disabled":"")+(this.state.focused?" focused":"")},m.createElement("span",{className:"label"},this.props.label),m.createElement("div",{className:"fields"},m.createElement(Z,{date:this.props.date,minDate:this.props.minDate,disabled:this.props.disabled,onDateChange:this.onDateChange,onFocus:function(){return e.onFocusChange(!0)},onBlur:function(){return e.onFocusChange(!1)}}),m.createElement("span",{className:"at-label"},"at"),m.createElement(ue,{date:this.props.date,minDate:this.props.minDate,disabled:this.props.disabled,onTimeChange:this.onTimeChange,onFocus:function(){return e.onFocusChange(!0)},onBlur:function(){return e.onFocusChange(!1)}}))))}},{key:"_mergeDateAndTime",value:function(e,t){var n=le(t);return n.year(e.year()).month(e.month()).date(e.date()),n}}]),t}(m.Component),Object(y.a)(u.prototype,"onDateChange",[j.a],Object.getOwnPropertyDescriptor(u.prototype,"onDateChange"),u.prototype),Object(y.a)(u.prototype,"onTimeChange",[j.a],Object.getOwnPropertyDescriptor(u.prototype,"onTimeChange"),u.prototype),u),he=function(e){var t=e.input,n=(e.meta,Object(A.a)(e,["input","meta"]));return m.createElement(de,Object.assign({},n,{name:t.name,date:t.value,onDateChange:t.onChange}))},me=n(1478),fe=n.n(me),ye=(n(1321),d=function(e){function t(){return Object(v.a)(this,t),Object(g.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(b.a)(t,[{key:"onStarClick",value:function(e,t,n,r){(r.pageX-r.currentTarget.getBoundingClientRect().left)/r.currentTarget.offsetWidth<=.5&&(e-=.5),this.props.onChange(e)}},{key:"render",value:function(){return m.createElement("div",{className:"rhyme-rating"},m.createElement("div",null,this.props.label?m.createElement("span",{className:"label"},this.props.label):null,m.createElement(fe.a,{className:"stars",name:"rating",value:this.props.value,starColor:"#edd15b",emptyStarColor:"#edd15b",onStarClick:this.onStarClick,renderStarIcon:function(e,t){return m.createElement("i",{className:e<=t?"fa fa-star":"fa fa-star-o"})},renderStarIconHalf:function(){return m.createElement("i",{className:"fa fa-star-half-o"})}})))}}]),t}(m.Component),Object(y.a)(d.prototype,"onStarClick",[j.a],Object.getOwnPropertyDescriptor(d.prototype,"onStarClick"),d.prototype),d),ve=function(e){var t=e.input,n=Object(A.a)(e,["input"]);return m.createElement(ye,Object.assign({},n,{value:t.value,onChange:t.onChange}))},be=n(289),ge=(n(1322),n(1047),n(9)),Oe=n(1218),Ce=n(1154),ke=(h=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(g.a)(this,Object(O.a)(t).call(this,e)))._textareas=[],n._dirty=Object(ge.List)([]),n.state={expanded:-1,timeFocused:!1,textFocused:!1},e.onRef&&e.onRef(Object(be.a)(n)),n}return Object(C.a)(t,e),Object(b.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=e.input.value;this.annotations.forEach((function(e,r){var o=n.get(r);!o||e.content===o.content&&e.time===o.time||t._updateDirty(t._dirty.push(r))}))}},{key:"openLastAnnotation",value:function(){var e=this;this.setState({expanded:this.annotations.size-1},(function(){return e._focusTextarea()}))}},{key:"cleanse",value:function(){this.setState({expanded:-1}),this._updateDirty(Object(ge.List)([]))}},{key:"updateTime",value:function(e,t,n){t=t.set("time",e.target.value),this.props.input.onChange(this.annotations.set(n,t))}},{key:"updateText",value:function(e,t,n){t=t.set("content",e.target.value),this.props.input.onChange(this.annotations.set(n,t))}},{key:"onContainerToggle",value:function(e,t){var n=this;e?this.setState({expanded:t},(function(){return n._focusTextarea()})):e||t!==this.state.expanded||this.setState({expanded:-1})}},{key:"onDelete",value:function(e,t){var n=this;this.props.onDelete(e).then((function(e){n.setState({expanded:-1}),e&&n.props.input.onChange(n.annotations.delete(t))}))}},{key:"onTimeFocus",value:function(e){this.setState({timeFocused:!0,expanded:e})}},{key:"onTimeBlur",value:function(){this.setState({timeFocused:!1})}},{key:"onTextFocus",value:function(e){this.setState({textFocused:!0,expanded:e})}},{key:"onTextBlur",value:function(){this.setState({textFocused:!1})}},{key:"onTextareaRef",value:function(e,t){e&&(this._textareas[t]=e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.timeFocused,r=t.textFocused;return m.createElement("div",{className:"redux-form-annotations-list form-styles"},this.annotations.map((function(t,o){var a,i,s=(e.props.meta.error||{})[o]||{},c=!s.time&&(a=e.props,i=t.time,1e3*a.chapterDuration>Object(Oe.a)(i))?"":"Invalid time";return m.createElement(Ce.a,{expanded:e.state.expanded===o,onToggle:function(t){return e.onContainerToggle(t,o)},expandHeader:e.renderExpandHeader(o+1),collapseHeader:e.renderCollapseHeader(t,o+1),errored:("{}"!==JSON.stringify(s)||!!c)&&!n&&!r,key:"eca-"+o},m.createElement(E.a,{value:t.time,label:"Notify at",error:e.state.timeFocused?"":c,onChange:function(n){return e.updateTime(n,t,o)},onFocus:function(){return e.onTimeFocus(o)},onBlur:e.onTimeBlur}),m.createElement("div",{className:"row"},m.createElement(F,{value:t.content,ref:function(t){return e.onTextareaRef(t,o)},className:"annon-text",label:"Message",error:e.state.textFocused?"":s.content,onChange:function(n){return e.updateText(n,t,o)},onFocus:function(){return e.onTextFocus(o)},onBlur:e.onTextBlur}),m.createElement("p",{className:"field-info delete"},m.createElement("a",{href:"javascript:void(0);",onClick:function(){return e.onDelete(t,o)}},"Delete Annotation "+(o+1)))))})))}},{key:"renderExpandHeader",value:function(e){return m.createElement("span",{className:"expand-header"},"Edit Annotation ",e)}},{key:"renderCollapseHeader",value:function(e,t){return m.createElement("span",{className:"collapse-header"},m.createElement("span",{className:"label"},"Annotation ",t),m.createElement("span",{className:"name"},"(",e.time,") ",e.content))}},{key:"_focusTextarea",value:function(){var e=this.state.expanded;-1!==e&&this._textareas[e]&&this._textareas[e].focus()}},{key:"_updateDirty",value:function(e){this._dirty=e,this.props.onDirty(this._dirty)}},{key:"annotations",get:function(){return this.props.input.value}}]),t}(m.Component),Object(y.a)(h.prototype,"onTimeBlur",[j.a],Object.getOwnPropertyDescriptor(h.prototype,"onTimeBlur"),h.prototype),Object(y.a)(h.prototype,"onTextBlur",[j.a],Object.getOwnPropertyDescriptor(h.prototype,"onTextBlur"),h.prototype),h),je=n(18),we=Object(je.b)({id:"",time:"",content:""});n.d(t,"l",(function(){return f.c})),n.d(t,"A",(function(){return f.e})),n.d(t,"j",(function(){return f.b})),n.d(t,"m",(function(){return f.d})),n.d(t,"g",(function(){return f.a})),n.d(t,"E",(function(){return f.j})),n.d(t,"B",(function(){return f.f})),n.d(t,"I",(function(){return f.p})),n.d(t,"L",(function(){return f.t})),n.d(t,"D",(function(){return f.i})),n.d(t,"M",(function(){return f.u})),n.d(t,"K",(function(){return f.s})),n.d(t,"G",(function(){return f.l})),n.d(t,"J",(function(){return f.q})),n.d(t,"C",(function(){return f.g})),n.d(t,"F",(function(){return f.k})),n.d(t,"H",(function(){return f.n})),n.d(t,"f",(function(){return R})),n.d(t,"a",(function(){return M.a})),n.d(t,"b",(function(){return N.a})),n.d(t,"c",(function(){return V})),n.d(t,"p",(function(){return I})),n.d(t,"d",(function(){return U})),n.d(t,"k",(function(){return E.a})),n.d(t,"s",(function(){return L})),n.d(t,"v",(function(){return z})),n.d(t,"x",(function(){return B.a})),n.d(t,"n",(function(){return W.a})),n.d(t,"h",(function(){return H})),n.d(t,"u",(function(){return K})),n.d(t,"w",(function(){return ce})),n.d(t,"z",(function(){return se})),n.d(t,"q",(function(){return pe.a})),n.d(t,"y",(function(){return F})),n.d(t,"r",(function(){return he})),n.d(t,"e",(function(){return de})),n.d(t,"t",(function(){return ve})),n.d(t,"o",(function(){return ke})),n.d(t,"i",(function(){return we}))},1047:function(e,t,n){},1051:function(e,t,n){"use strict";var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=n.n(c);n(1304);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=p.a.createElement("circle",{cx:84,cy:50,r:0,fill:"#ffffff"},p.a.createElement("animate",{attributeName:"r",values:"5;0;0;0;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),p.a.createElement("animate",{attributeName:"cx",values:"84;84;84;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),h=p.a.createElement("circle",{cx:47.7776,cy:50,r:5,fill:"#ffffff",fillOpacity:.5},p.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-1.25s"}),p.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-1.25s"})),m=p.a.createElement("circle",{cx:16,cy:50,r:4.67318,fill:"#ffffff",fillOpacity:.1},p.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-0.625s"}),p.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-0.625s"})),f=p.a.createElement("circle",{cx:84,cy:50,r:.326821,fill:"#ffffff"},p.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),p.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),y=p.a.createElement("circle",{cx:81.7776,cy:50,r:5,fill:"#ffffff"},p.a.createElement("animate",{attributeName:"r",values:"0;0;5;5;5",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),p.a.createElement("animate",{attributeName:"cx",values:"16;16;16;50;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),v=function(e){var t=e.svgRef,n=e.title,r=u(e,["svgRef","title"]);return p.a.createElement("svg",l({viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",className:"lds-ellipsis",style:{background:"none"},ref:t},r),n?p.a.createElement("title",null,n):null,d,h,m,f,y)},b=p.a.forwardRef((function(e,t){return p.a.createElement(v,l({svgRef:t},e))}));n.p;n.d(t,"a",(function(){return g}));var g=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-loader"+(this.props.theme?" "+this.props.theme:"")},c.createElement(b,null))}}]),t}(c.PureComponent)},1053:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"k",(function(){return p})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return y})),n.d(t,"i",(function(){return v}));var r,o,a=n(3),i=n(0),s=30;!function(e){e.DefaultWin="DefaultWin",e.CustomWin="CustomWin",e.DefaultUbuntu="DefaultUbuntu",e.CustomUbuntu="CustomUbuntu"}(o||(o={}));var c=(r={},Object(a.a)(r,o.DefaultWin,i.K.Win),Object(a.a)(r,o.CustomWin,i.K.Win),Object(a.a)(r,o.DefaultUbuntu,i.K.Linux),Object(a.a)(r,o.CustomUbuntu,i.K.Linux),r),p=function(e,t){switch(e){case i.Z.Micro:return"Micro (2 vCPU, 1GB RAM, 30GB SSD)";case i.Z.Small:return"Small (2 vCPU, 2GB RAM, 30GB SSD)";case i.Z.Medium:return"Medium (2 vCPUs, 4GB RAM, 30GB SSD)";case i.Z.Large:return"Normal (2 vCPUs, 8GB RAM, 50GB SSD)";case i.Z.XLarge:return"Double (4 vCPUs, 16GB RAM, 100GB SSD)";case i.Z.XXLarge:return"Quadruple (8 vCPUs, 32GB RAM, 250 SSD)";case i.Z.GPUMicro:return"GPU Micro (1 NVIDIA Tesla M60 2048 cores, 4 vCPUs, 30.5GB RAM, 100 SSD)";case i.Z.GPUSmall:return"GPU Small (1 NVIDIA K80 2496 cores, 4 vCPUs, 61GB RAM, 100 SSD)";case i.Z.GPUMedium:return"GPU Medium (1 NVIDIA Tesla V100 5120 cores, 8 vCPUs, 61GB RAM, 100 SSD)";case i.Z.GPULarge:return"GPU Large (4 NVIDIA Tesla V100 5120 cores each, 32 vCPUs, 244GB RAM, 100 SSD)";case i.Z.MemMicro:return"Memory Micro (8 vCPUs, 64GB RAM, 100 SSD)";case i.Z.MemSmall:return"Memory Small (16 vCPUs, 128GB RAM, 100 SSD)";default:return""}},l=function(e){var t=e.find((function(e){return e.defaultTemplate&&e.os===i.K.Win}))||{},n=e.find((function(e){return e.defaultTemplate&&e.os===i.K.Linux}))||{};return{DefaultWin:{price:t.cost||0,currency:t.currency},CustomWin:{price:t.customCost||0,currency:t.currency},DefaultUbuntu:{price:n.cost||0,currency:n.currency},CustomUbuntu:{price:n.customCost||0,currency:n.currency}}},u=function(e,t){var n=e.get(t);if(n.defaultTemplate)switch(n.os){case i.K.Win:return o.DefaultWin;case i.K.Linux:return o.DefaultUbuntu}else switch(n.os){case i.K.Win:return o.CustomWin;case i.K.Linux:return o.CustomUbuntu}throw new Error("Template type haven't been found. Check backend response.")},d=function(e,t){var n=l(e);if(t.defaultTemplate)switch(t.os){case i.K.Win:return n.DefaultWin;case i.K.Linux:return n.DefaultUbuntu}else switch(t.os){case i.K.Win:return n.CustomWin;case i.K.Linux:return n.CustomUbuntu}return{price:0,currency:""}},h=function(e,t){var n=l(e);switch(t){case o.DefaultWin:return n.DefaultWin;case o.CustomWin:return n.CustomWin;case o.DefaultUbuntu:return n.DefaultWin;case o.CustomUbuntu:return n.CustomUbuntu;default:return{price:0,currency:""}}},m=function(e){var t,n=l(e);return t={},Object(a.a)(t,o.DefaultWin,{icon:"windows",name:"Default Windows",price:n.DefaultWin.price,currency:n.DefaultWin.currency,default:!0,os:i.K.Win}),Object(a.a)(t,o.CustomWin,{icon:"windows",name:"Custom Windows",price:n.CustomWin.price,currency:n.CustomWin.currency,default:!1,os:i.K.Win}),Object(a.a)(t,o.DefaultUbuntu,{icon:"ubuntu",name:"Default Ubuntu",price:n.DefaultUbuntu.price,currency:n.DefaultUbuntu.currency,default:!0,os:i.K.Linux}),Object(a.a)(t,o.CustomUbuntu,{icon:"ubuntu",name:"Custom Ubuntu",price:n.CustomUbuntu.price,currency:n.CustomUbuntu.currency,default:!1,os:i.K.Linux}),t},f=function(e,t){var n=e.find((function(e){return e.defaultTemplate&&e.os===i.K.Win}));if(!t)return n?n.screenshotUrl:"";if(!t.screenshotUrl)switch(t.os){case i.K.Linux:var r=e.find((function(e){return e.defaultTemplate&&e.os===i.K.Linux}));return r?r.screenshotUrl:"";case i.K.Win:return n?n.screenshotUrl:""}return t.screenshotUrl},y=function(e){return e&&!e.ownerId&&!e.defaultTemplate},v=function(e){return e.state!==i.ab.Deleted}},1055:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return l}));var r=n(3),o=n(1059),a=n(1066),i=Object(r.a)({},a.c,(function(){return new a.a})),s=function(e){var t=Object(o.b)(e),n=i[t];if(!n)throw new Error("InputCodec with version ".concat(t," not supported"));return n()},c=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(this.result)},r.readAsArrayBuffer(e)}))},p=function(e){var t=0;return e.left&&(t|=1),e.middle&&(t|=2),e.right&&(t|=4),e.up&&(t|=8),e.down&&(t|=16),t},l=function(e){return{left:!!(1&e),middle:!!(2&e),right:!!(4&e),up:!!(8&e),down:!!(16&e)}}},1059:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c}));var r=0;function o(){return"".concat(r++)}function a(e){return new DataView(e).getUint8(0)}function i(e){return new Promise((function(t){var n=document.createElement("video");n.preload="metadata",n.onloadedmetadata=function(){t(Math.round(1e3*n.duration))},n.src=e}))}function s(e,t,n){var r=e.reduce((function(e,n){return e+t(n).byteLength}),0)-e.size+1,o=new ArrayBuffer(r),i=new Uint8Array(o);i[0]=n.version[0];var s=0,c=1;return e.forEach((function(e){var r=t(e),p=a(r);if(p!==n.version[0])throw new Error("Merging streams with different versions is not supported. Expected version: ".concat(n.version[0]," actual version: ").concat(p));if((r.byteLength-1)%n.packetSize!==0)throw new Error("Invalid buffer size. It is not dividable by ".concat(n.packetSize));var l=new Uint8Array(r,1);i.set(l,c);for(var u=new DataView(o,c,l.length),d=new DataView(r,1,l.length),h=0;h<d.byteLength;h+=n.packetSize){var m=n.getPacketTimestamp(d,h);n.setPacketTimestamp(u,h,m+s)}c+=l.length,s+=e.duration})),o}function c(e,t,n){for(var r=t(e),o=new DataView(e),a=1;a<o.byteLength&&r.getPacketTimestamp(o,a)<=n;)a+=r.packetSize;return e.slice(0,a)}},1060:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var r,o=n(49),a=n(1055),i=n(1066);function s(e){if(e[0]===i.b)return{type:r.Keyboard,timestamp:e[1],down:1===e[2],keyCode:e[3]};var t=Object(a.b)(e[2]);return Object(o.a)({type:r.Mouse,timestamp:e[1],x:e[3],y:e[4]},t)}!function(e){e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse"}(r||(r={}))},1062:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1257),n(1216)),l=50,u=50,d=20,h=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"getInitials",value:function(){if(!this.props.source.name)return"...";var e=this.props.source.name.split(" "),t=e[0],n=e[1];return t[0]+(n?n[0]:"")}},{key:"render",value:function(){var e,t=this.props.source;return t.avatarUrl?e=t.avatarUrl:t.photo&&(e=p.a[t.photo-1]),c.createElement("div",{className:"avatar"+(this.props.tooltip?" tooltip rel b":""),style:this.styles,"data-tooltip":this.props.source.name},e?c.createElement("img",{src:e,width:this.styles.width,height:this.styles.height}):c.createElement("span",null,this.getInitials()))}},{key:"styles",get:function(){var e=this.props;return{width:e.width||l,height:e.height||u,fontSize:e.fontSize||d}}}]),t}(c.Component)},1064:function(e,t,n){"use strict";var r,o=n(97),a=n(5),i=n(11),s=n(30),c=n(28),p=n(289),l=n(29),u=n(1050),d=n.n(u),h=n(9),m=n(208),f=n.n(m),y=n(4),v=n(163),b=n(1061),g=n(209),O=n(1069),C=n(0),k=n(1103),j=n(20),w=n.n(j),E=n(45),_=n(1465),S=function(e){return function(t){if(t.seekable&&Number.isFinite(t.duration)){var n=Object(_.a)(0,t.duration,t.currentTime+e);t.currentTime=n}}},D=function(e){return function(t){t.volume=Object(_.a)(0,1,t.volume+e)}},P=function(e){var t=document,n=t.fullscreenElement,r=t.webkitFullscreenElement;return n===e||r===e},T=function(e){return e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.requestFullscreen()},R=function(){var e=Object(E.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(t)){e.next=4;break}return e.next=3,T(t);case 3:return e.abrupt("return",!0);case 4:return e.next=6,document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen();case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){return e.muted=!e.muted},M=n(1074),N=n(131),V=n(1051),A=n(1105),I=n(40),U=function(e){if(e.startsWith("blob:"))return e;var t,n,r,o,a,i=e.replace("https://","").split("/"),s=Object(I.a)(i,2),c=s[0],p=s[1].split("."),l=Object(I.a)(p,1)[0],u=c.split(".");if(5===u.length){var d=Object(I.a)(u,5);t=d[0],n=d[1],r=d[2],o=d[3],a=d[4]}else{var h=Object(I.a)(u,4);t=h[0],n=h[1],o=h[2],a=h[3],r="us-east-1"}var m=t.split("-"),f=m.indexOf("skillspace");return t=m.slice(0,f).join("-")+"-mp4-"+m.slice(f,m.length).join("-"),"https://".concat(t,".").concat(n,".").concat(r,".").concat(o,".").concat(a,"/").concat(l,".mp4")},L=(n(1165),function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={current:void 0},n._leftOn=!1,n._ref=void 0,n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onMouseEvent",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this;if(!this.state.current)return null;var t=this.state.current,n=t.x,r=t.y,o=t.left,a=this.props.scale;return o&&this._leftOn!==o&&this._playRipple(n*a,r*a),this._leftOn=o,y.createElement("div",{ref:function(t){return e._ref=t},className:"cursor-player cursor"})}},{key:"_playRipple",value:function(e,t){if(this._ref){var n=document.createElement("div");n.className="ripple ripple-effect",this._ref.appendChild(n),n.style.left=e-n.offsetHeight/2+"px",n.style.top=t-n.offsetWidth/2+"px",n.addEventListener("animationend",(function(){var e=n.parentElement;e&&e.removeChild(n)}))}}}]),t}(y.Component)),F=n(1106);n(1166);n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return z})),function(e){e.x025="0.25",e.x050="0.5",e.x075="0.75",e.x100="1",e.x125="1.25",e.x150="1.5",e.x200="2"}(r||(r={}));var z=function(e){function t(e){var n;Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={zoomPointerCenter:{x:0,y:0},videoSize:{width:0,height:0},videoDimm:{width:0,height:0},firstFrame:null,videoPlayable:!1,windowBlured:!1,failedUrls:new Set},n._video=void 0,n._videoWrapper=void 0,n._inputPlayer=void 0,n._annotationsPlayer=void 0,n._expandModePlayer=void 0,n._cursor=void 0,n._lastSync=NaN,n._resizeObserver=void 0,n._mouseDownTimestamp=0,n._playbackRate=r.x100,n._screenshotCanvas=void 0,n._canPlayTimeout=null,n._moveZoomPointerCenter=void 0,n._resetZoomPointerMovementHistory=void 0,n._keyboardActionHandlers={"video.toggleMute":n._withVideoRef(x),"video.toggleFullscreen":n._withVideoRef(R),"video.volumeUp":n._withVideoRef(D(.1)),"video.volumeDown":n._withVideoRef(D(-.1)),"video.forward":n._withVideoRef(S(15)),"video.backward":n._withVideoRef(S(-15))},n.onVideoRef=function(e){n._video=e,e&&(e.playbackRate=parseFloat(n._playbackRate),e.oncanplay=function(){n._obtainDimmensions(e),n._createFirstFrame(e),n._canPlayTimeout=setTimeout((function(){n.setState({videoPlayable:!0},(function(){return n.props.onCanPlay(!0)}))}),500),e.oncanplay=null},e.onplaying=function(){n.setState({firstFrame:null}),e.onplaying=null})},n.onLoadedData=function(){n._video&&n._video.readyState>=1&&n.props.onReadyMetadata()},n._onSourceError=function(e){var t=e.target.src;n.setState({videoPlayable:!1,failedUrls:new Set([].concat(Object(o.a)(n.state.failedUrls),[t]))})},n._onClick=function(){Date.now()-n._mouseDownTimestamp<=500&&n.props.onClick()},n._onWrapperRef=function(e){e&&(n._videoWrapper=e,n._resizeObserver&&n._resizeObserver.disconnect(),n._resizeObserver=new b.a((function(){if(n._video){var e={width:n._video.clientWidth,height:n._video.clientHeight};n.setState({videoSize:e})}})),n._resizeObserver.observe(n._videoWrapper))},n._onMediaPlay=function(){if(n._inputPlayer){n.props.captionPlayer&&n.props.captionPlayer.reset(),n._annotationsPlayer&&n._annotationsPlayer.play(n.currentTimeInMs),n._expandModePlayer&&n._expandModePlayer.play(n.currentTimeInMs);var e=n._inputPlayer.play(n.currentTimeInMs);n._playMouseEvent(e.mouse)}},n._onSeeked=function(){if(n._video&&n._inputPlayer){n._resetZoomPointerMovementHistory();var e=n._inputPlayer.getKeyframeAt(n.currentTimeInMs);n._playMouseEvent(e.mouse)}},n._onMediaPause=function(){n._inputPlayer&&(n._inputPlayer.pause(),n._annotationsPlayer&&n._annotationsPlayer.pause(),n._expandModePlayer&&n._expandModePlayer.pause())},n._frameHandler=function(e){e.type===O.a.Mouse?n._playMouseEvent(e):n._playKeyboardEvent(e)},n._onLoadedMetadata=function(e){var t=e.target;t.duration===1/0&&(t.currentTime=1e101,t.ontimeupdate=function(){t.currentTime=.1,t.ontimeupdate=null})},n._syncInput=function(){if(n._video&&n._inputPlayer){var e=Date.now();!n._video.paused&&(isNaN(n._lastSync)||e-n._lastSync>500)&&(n._lastSync=e,n._inputPlayer.sync(n.currentTimeInMs))}},n._onWindowFocus=function(){n.play(),n.setState({windowBlured:!1},(function(){return n.props.onCanPlay(!0)})),window.removeEventListener("focus",n._onWindowFocus)},n._onWindowBlur=function(){n.playing&&(n.pause(),n.setState({windowBlured:!0},(function(){return n.props.onCanPlay(!1)})),window.addEventListener("focus",n._onWindowFocus))},n._tryInitInputPlayer(e),n._tryInitAnnotationsPlayer(e),n._tryInitExpandModePlayer(e),n._screenshotCanvas=document.createElement("canvas");var i=Object(M.b)(Object(p.a)(n));return n._moveZoomPointerCenter=i.moveCenter,n._resetZoomPointerMovementHistory=i.resetHistory,n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("blur",this._onWindowBlur)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.input,r=t.expandModeData;n&&n!==e.input&&this._tryInitInputPlayer(this.props),!n&&this._inputPlayer&&(this._inputPlayer.pause(),this._inputPlayer=void 0),r&&r!==e.expandModeData&&this._tryInitExpandModePlayer(this.props),!r&&this._expandModePlayer&&(this._expandModePlayer.pause(),this._expandModePlayer=void 0),this._handleNewUrlProps(e),this._tryInitAnnotationsPlayer(this.props)}},{key:"componentWillUnmount",value:function(){this._inputPlayer&&this._inputPlayer.pause(),this._annotationsPlayer&&this._annotationsPlayer.destroy(),this._expandModePlayer&&this._expandModePlayer.destroy(),this._canPlayTimeout&&clearTimeout(this._canPlayTimeout),window.removeEventListener("blur",this._onWindowBlur),window.removeEventListener("focus",this._onWindowFocus)}},{key:"play",value:function(){return this._inputPlayer&&this._video&&this.canPlay?(this.props.captionPlayer&&this.props.captionPlayer.reset(),this._video.play()):Promise.reject()}},{key:"pause",value:function(){this._inputPlayer&&this._video&&this.canPlay&&(window.removeEventListener("focus",this._onWindowFocus),this._video.pause())}},{key:"changePlaybackRate",value:function(e){if(this._video&&this._inputPlayer){this._playbackRate=e;var t=parseFloat(this._playbackRate);this._video.playbackRate=t,this._inputPlayer.setPlaybackRate(t),this._annotationsPlayer&&this._annotationsPlayer.setPlaybackRate(t,this.currentTimeInMs),this._expandModePlayer&&this._expandModePlayer.setPlaybackRate(t,this.currentTimeInMs)}}},{key:"toggleViewbox",value:function(){if(this.props.onViewboxToggle)return this.props.onViewboxToggle(!this.props.showViewbox),!this.props.showViewbox}},{key:"setCurrentTime",value:function(e){this._video&&(this.props.captionPlayer&&this.props.captionPlayer.reset(),e&&!isNaN(e)||(e=0),this._video.currentTime=e)}},{key:"learnerChangedSidebarMode",value:function(){this._expandModePlayer&&this._expandModePlayer.learnerChangedSidebarMode(this.currentTimeInMs)}},{key:"takeScreenshot",value:function(){if(!this._video)return null;var e=this._video,t=e.videoWidth,n=e.videoHeight;this._screenshotCanvas.width=t,this._screenshotCanvas.height=n,this._screenshotCanvas.getContext("2d").drawImage(this._video,0,0,t,n);var r=this._screenshotCanvas.toDataURL("image/png");return new Blob([g.a.toArrayBuffer(r)],{type:"image/png"})}},{key:"render",value:function(){var e=this,t=d()("vm-player",this.props.className);return this.props.src?y.createElement("div",{className:t},y.createElement(N.Hotkeys,{handlers:this._keyboardActionHandlers}),y.createElement("div",{className:"video-wrapper",ref:this._onWrapperRef},this.state.firstFrame&&y.createElement("img",{className:"first-frame",src:this.state.firstFrame}),y.createElement("video",{key:"".concat(this.props.mp4).concat(this.props.webm).concat(this.props.src),autoPlay:this.props.autoPlay,onTimeUpdate:this._syncInput,onSeeked:this._onSeeked,ref:this.onVideoRef,onLoadedMetadata:this._onLoadedMetadata,onLoadedData:this.onLoadedData,controls:Boolean(this.props.src||this.props.mp4||this.props.webm)&&this.props.controls,onPlaying:this._onMediaPlay,onPause:this._onMediaPause,onMouseDown:function(){return e._mouseDownTimestamp=Date.now()},onMouseUp:this._onClick,crossOrigin:"anonymous",onError:this._onSourceError},this.props.mp4&&y.createElement("source",{type:"video/mp4",src:this.props.mp4}),this.props.webm&&y.createElement("source",{type:"video/webm",src:this.props.webm}),this.props.src&&y.createElement("source",{type:"video/mp4",src:U(this.props.src)}),this.props.src&&y.createElement("source",{type:"video/webm",src:this.props.src}),(this.props.subtitles||Object(h.Map)()).filter(k.c).map((function(t){return y.createElement(F.a,{key:t.url,url:t.url,srcLang:t.language,default:t.language===e.props.subtitleLang,onCueChange:e.props.onCueChange})})).toList()),this.props.mouse?y.createElement(L,{ref:function(t){return e._cursor=t},scale:this.scale}):null,this.renderViewbox(),this.props.errorContainer?v.createPortal(this.renderSourceSplash(),this.props.errorContainer):this.renderSourceSplash())):y.createElement("div",{className:t},y.createElement("div",{className:"video-placeholder"}))}},{key:"renderViewbox",value:function(){var e=this.props,t=e.showViewbox,n=e.viewboxSize,r=this.state,o=r.videoSize,a=r.videoDimm,i=r.zoomPointerCenter;if(!t||!n)return null;var s=o.width/a.width,c=i.x,p=i.y;return y.createElement("div",{className:"zoom-wrapper"},y.createElement(A.a,{isExpanded:this.props.isViewExpanded||!1,width:n.width*s,height:n.height*s,maxWidth:o.width,maxHeight:o.height,x:c*s,y:p*s}))}},{key:"renderSourceSplash",value:function(){var e=this.state,t=e.videoPlayable,n=e.windowBlured,r=e.failedUrls;if(t||n)return null;var o=[this.props.webm,this.props.mp4,this.props.src,this.props.src].reduce((function(e,t){return e+(t?1:0)}),0),a=r.size>0&&r.size>=o;return y.createElement("div",{className:"source-splash"},a?y.createElement(y.Fragment,null,y.createElement("p",null,"We are sorry, but we were not able to load the video. :("),y.createElement("p",null,"Please, try again later.")):y.createElement(V.a,null))}},{key:"_tryInitInputPlayer",value:function(e){this._inputPlayer&&this._inputPlayer.pause(),e.input&&(this._inputPlayer=new O.f(e.input),this._inputPlayer.onFrame(this._frameHandler),this._inputPlayer.setPlaybackRate(parseFloat(this._playbackRate)))}},{key:"_tryInitAnnotationsPlayer",value:function(e){!this._annotationsPlayer&&e.annotations&&e.annotations.size&&(this._annotationsPlayer=Object(O.k)(this),this._annotationsPlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs))}},{key:"_tryInitExpandModePlayer",value:function(e){this._expandModePlayer&&this._expandModePlayer.destroy(),e.expandModeData&&(this._expandModePlayer=new O.b(e.expandModeData),this._expandModePlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs),this.props.onExpandModeChange&&this._expandModePlayer.onExpandModeChange(this.props.onExpandModeChange))}},{key:"_playMouseEvent",value:function(e){this._cursor&&this._cursor.onMouseEvent(e),this._moveZoomPointerCenter(e),this.props.onMouseFrame&&this.props.onMouseFrame(e)}},{key:"_playKeyboardEvent",value:function(e){this.props.captionPlayer&&this.props.captionPlayer.onKey(e),this.props.onKeyboardFrame&&this.props.onKeyboardFrame(e)}},{key:"_obtainDimmensions",value:function(e){this.setState({videoDimm:{width:e.videoWidth,height:e.videoHeight}}),this.props.onVideoDimmensions&&this.props.onVideoDimmensions(e.videoWidth,e.videoHeight)}},{key:"_createFirstFrame",value:function(e){var t=e.videoWidth,n=e.videoHeight,r=document.createElement("canvas");r.width=t,r.height=n;var o=r.getContext("2d");o&&(o.filter="blur(5px) opacity(40%)",o.drawImage(e,0,0,t,n),this.setState({firstFrame:r.toDataURL()}))}},{key:"_withVideoRef",value:function(e){var t=this;return function(){return t._video?e(t._video):void 0}}},{key:"_handleNewUrlProps",value:function(e){var t=this.props,n=t.webm,r=t.mp4,a=t.src,i=[n!==e.webm&&e.webm,r!==e.mp4&&e.mp4].concat(Object(o.a)(a!==e.src&&e.src?[U(e.src),e.src]:[])).filter(Boolean);if(0!==i.length){var s=this.state.failedUrls.size>0?i.reduce((function(e,t){return e.delete(t),e}),new Set(this.state.failedUrls)):this.state.failedUrls;this.setState({videoPlayable:!1,failedUrls:s}),this.props.onCanPlay(!1)}}},{key:"playing",get:function(){return!!this._video&&!this._video.paused}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"canPlay",get:function(){return this.state.videoPlayable&&!this.state.windowBlured}},{key:"zoomPointerDimensions",get:function(){return this.props.viewboxSize||{height:0,width:0}}},{key:"currentTime",get:function(){return this._video?this._video.currentTime:0}},{key:"currentTimeInMs",get:function(){return Math.round(1e3*this.currentTime)}},{key:"duration",get:function(){return this._video?this._video.duration:0}},{key:"scale",get:function(){if(!this._video)return 1;var e=this._video.getBoundingClientRect(),t=e.width,n=e.height,r=this.state.videoDimm.width/this.state.videoDimm.height;return Math.min(t,n*r)/this.state.videoDimm.width}}]),t}(y.Component);z.defaultProps={subtitleLang:C.X.enUS,onCanPlay:f.a,onReadyMetadata:f.a,onClick:f.a}},1065:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"p",(function(){return m})),n.d(t,"t",(function(){return y})),n.d(t,"i",(function(){return v})),n.d(t,"u",(function(){return b})),n.d(t,"s",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"m",(function(){return w})),n.d(t,"h",(function(){return E})),n.d(t,"l",(function(){return S})),n.d(t,"q",(function(){return D})),n.d(t,"g",(function(){return P})),n.d(t,"o",(function(){return T})),n.d(t,"k",(function(){return x})),n.d(t,"n",(function(){return M}));var r=n(49),o=n(1128),a={email:{min:6,max:300},password:{min:6,max:200},name:{min:2,max:200},securityCode:{min:6,max:6},inviteCode:{min:6,max:20},sessionName:{min:4,max:200},sessionDescription:{min:0,max:1e4},templateName:{min:4,max:200},rhymeCard:{min:16,max:16},feedback:{min:0,max:1e4},feedbackRequired:{min:3,max:1e4},bio:{min:0,max:1e4},twitterUrl:{min:13,max:300},githubUrl:{min:12,max:300},linkedinUrl:{min:17,max:300},facebookUrl:{min:14,max:300},annotation:{min:5,max:100}},i=/^(http(?:s)?:\/\/)?(?:www\.)?(twitter\.com\/\S+$)/g,s=/^(http(?:s)?:\/\/)?(?:www\.)?(github\.com\/\S+$)/g,c=/^(http(?:s)?:\/\/)?(?:www\.)?(linkedin\.com\/in\/\S+$)/g,p=/^(http(?:s)?:\/\/)?(?:www\.)?(facebook\.com\/\S+$)/g,l={twitterUrl:"Twitter profile should be of the form: twitter.com/username",githubUrl:"GitHub profile should be of the form: github.com/username",linkedinUrl:"LinkedIn profile should be of the form: linkedin.com/in/username",facebookUrl:"Facebook profile should be of the form: facebook.com/username"},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"password",n=arguments.length>2?arguments[2]:void 0,r={},o=(e[t]||"").trim();return""===o&&n?r:(o?(o.length<a.password.min||a.password.max<o.length)&&(r[t]="Password must be between ".concat(a.password.min," and ").concat(a.password.max," characters")):r[t]="Required",r)},d=function(e,t){var n={},r=(e[t]||"").trim();return r?r.length<a.email.min||a.email.max<r.length?n[t]="Email must be between ".concat(a.email.min," and ").concat(a.email.max," characters"):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+$/i.test(r)||(n[t]="Invalid email address"):n[t]="Required",n},h=function(e){var t={},n=e.cellNumber;if(!n)return t;if(n.length<7||30<n.length)t.cellNumber="Cell number must be between 7 and 30 characters";else if(n.startsWith("+")){if(n){var r=Object(o.b)(n);r&&r.country&&r.phone||(t.cellNumber="Invalid cell number")}}else t.cellNumber='Cell number should start with country code. E.g., for USA, start with "+1"';return t},m=function(e){var t={},n=e.newPassword,r=e.repeatPassword;return t.newPassword||t.repeatPassword||r||(t.repeatPassword="Repeat your new password"),t.newPassword||t.repeatPassword||n===r||(t.repeatPassword="Password doesn't match"),t},f=function(e,t,n){var r={},o=(e[t]||"").trim();if(o){var i=a[t];if(o.length<i.min||o.length>i.max)r[t]="The link should be between ".concat(i.min," and ").concat(i.max," characters");else o.match(n)||(r[t]=l[t])}return r},y=function(e){var t={};t=Object(r.a)({},u(e,"password",!1),{},d(e,"email"),{},function(e){var t={},n=e.bio;return n?(n.length>a.bio.max&&(t.bio="The About You shouldn't exceed ".concat(a.bio.max," characters")),t):t}(e),{},function(e){return Object(r.a)({},f(e,"twitterUrl",i),{},f(e,"githubUrl",s),{},f(e,"linkedinUrl",c),{},f(e,"facebookUrl",p))}(e));var n=(e.name||"").trim();return n?(n.length<a.name.min||a.name.max<n.length)&&(t.name="Name must be between ".concat(a.name.min," and ").concat(a.name.max," characters")):t.name="Required",t},v=function(e){return u(e,"confirmPassword",!1)},b=function(e){var t={};return t=Object(r.a)({},y(e),{},h(e)),e.newPassword&&(t=Object(r.a)({},u(e,"newPassword",!0),{},m(e))),t},g=function(e){var t={},n=(e.courseName||"").trim();return n?(n.length<a.sessionName.min||a.sessionName.max<n.length)&&(t.courseName="The name should be between ".concat(a.sessionName.min," and ").concat(a.sessionName.max," characters")):t.courseName="Required",t},O=function(e){var t={},n=(e.templateName||"").trim();return n?(n.length<a.templateName.min||a.templateName.max<n.length)&&(t.templateName="The name should be between ".concat(a.templateName.min," and ").concat(a.templateName.max," characters")):t.templateName="Required",t},C=function(e){var t=Object(r.a)({},g(e));return(e.description||"").trim().length>a.sessionDescription.max&&(t.description="The description shouldn't exceed ".concat(a.sessionDescription.max," characters")),t},k=function(e){var t={},n=(e.name||"").trim();return n?(n.length<a.sessionName.min||a.sessionName.max<n.length)&&(t.name="The name should be between ".concat(a.sessionName.min," and ").concat(a.sessionName.max," characters")):t.name="Required",t},j=function(e){var t={};return(e.description||"").trim().length>a.sessionDescription.max&&(t.description="The description shouldn't exceed ".concat(a.sessionDescription.max," characters")),t},w=function(e){return Object(r.a)({},C(e),{},E(e))},E=function(e){var t=[];return e.chapters?(e.chapters.forEach((function(e){return t.push((n=e,Object(r.a)({},k(n),{},j(n))));var n})),0===t.filter((function(e){return 0!==Object.keys(e).length})).length?{}:{chapters:JSON.stringify(t)}):{}},_=function(e){var t={},n="Invalid time";if(/^(\d{1,2}:)?\d{1,2}:\d{1,2}$/.test(e.time)){var r=e.time.split(":").map((function(e){return parseInt(e,10)})),o=0,i=0,s=0;r.length>2?(o=r[0],i=r[1],s=r[2]):(i=r[0],s=r[1]),0<=o&&o<=23&&0<=i&&i<=59&&0<=s&&s<=59&&(n="")}return n&&(t.time=n),(!e.content||e.content.length<a.annotation.min||a.annotation.max<e.content.length)&&(t.content="Text should be between ".concat(a.annotation.min," and ").concat(a.annotation.max," characters.")),t},S=function(e){var t=e.annotations;if(!t)return{};var n=(t.toArray()||[]).map(_);return n.filter((function(e){return Object.keys(e).length>0})).length?{annotations:n}:{}},D=function(e){var t={},n=(e.securityCode||"").trim();return n?n.length!==a.securityCode.max?t.securityCode="Security code must be ".concat(a.securityCode.max," digits"):/^[0-9]+$/.test(n)||(t.securityCode="Security code must contain only digits"):t.securityCode="Required",t},P=function(e){return Object(r.a)({},u(e,"newPassword",!1),{},m(e),{},D(e))},T=function(e){var t={};if(e.card){var n=e.card.replace(/\s/g,"");"99"!==n.substr(0,2)?t.card="The card number should start with 99":/^\d+$/.test(n)?n.length!==a.rhymeCard.max&&(t.card="The card number should be exactly ".concat(a.rhymeCard.max," digits")):t.card="The card should contain only digits"}else t.card="The card number is required";return t},R=function(e,t){var n={},r=(e.feedbackText||"").trim();return(r.length<t.min||r.length>t.max)&&(n.feedbackText="The feedback should be between ".concat(t.min," and ").concat(t.max," characters")),n},x=function(e){return R(e,a.feedback)},M=function(e){return R(e,a.feedbackRequired)}},1066:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return d}));var r=n(5),o=n(11),a=Math.pow(2,8)-1,i=Math.pow(2,16)-1,s=Math.pow(2,32)-1,c=0,p=1,l=new Uint8Array([0]),u=new Uint8Array([p]),d=function(){function e(){Object(r.a)(this,e),this.version=new Uint8Array([c]),this.packetSize=10}return Object(o.a)(e,[{key:"encodeMouseEvent",value:function(e,t,n,r){if(e>s)throw new Error("Cannot encode time stamps bigger than 32bit");if(n>i)throw new Error("Cannot encode x coordinate bigger than 16bit");if(r>i)throw new Error("Cannot encode y coordinate bigger than 16bit");if(t>a)throw new Error("Cannot encode mouse mask bigger than 8bit");var o=new Uint32Array([e]),c=new Uint8Array([t]),p=new Uint16Array([n]),u=new Uint16Array([r]);return new Blob([l,o,c,p,u])}},{key:"encodeKeyboardEvent",value:function(e,t,n){if(e>s)throw new Error("Cannot encode time stamps bigger than 32bit");if(0!==t&&1!==t)throw new Error("Cannot encode down flag in more than 8bits");if(n>s)throw new Error("Cannot key code in more than 32bits");var r=new Uint32Array([e]),o=new Uint8Array([t]),a=new Uint32Array([n]);return new Blob([u,r,o,a])}},{key:"decodeBuffer",value:function(e){for(var t=[],n=0;n+10<=e.byteLength;n+=10)t.push(this.decodePacket(new DataView(e,n,10)));if(n!==e.byteLength)throw new Error("Invalid package size. It is not dividable by 10.");return t}},{key:"decodePacket",value:function(e){if(10===e.byteLength)return e.getInt8(0).toString()===l.toString()?this.decodeMousePacket(e):this.decodeKeyboardPacket(e);throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"decodeMousePacket",value:function(e){return[0,e.getUint32(1,!0),e.getUint8(5),e.getUint16(6,!0),e.getUint16(8,!0)]}},{key:"decodeKeyboardPacket",value:function(e){return[p,e.getUint32(1,!0),e.getUint8(5),e.getUint32(6,!0)]}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t+1,!0)}},{key:"setPacketTimestamp",value:function(e,t,n){e.setUint32(t+1,n,!0)}}]),e}()},1067:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(1060),i=n(1055),s={x:0,y:0,left:!1,middle:!1,right:!1,up:!1,down:!1,timestamp:0,type:a.a.Mouse},c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,e),this._events=t,this._start=n}return Object(o.a)(e,[{key:"next",value:function(){return this._start<this._events.length?{done:!1,value:Object(a.b)(this._events[this._start++])}:{done:!0,value:null}}}]),e}(),p=function(){function e(t){Object(r.a)(this,e),this._codec=void 0,this._events=void 0,this._codec=Object(i.a)(t),this._events=this._codec.decodeBuffer(t.slice(1))}return Object(o.a)(e,[{key:"getKeyframeAt",value:function(e){for(var t=l(this._events,e),n=s,r=t-1;r>=0;r-=1){var o=Object(a.b)(this._events[r]);if(o.type===a.a.Mouse){n=o;break}}return{mouse:n,keysDown:[]}}},{key:"getIteratorAt",value:function(e){var t=l(this._events,e);return-1===t&&(t=this._events.length),new c(this._events,t)}}]),e}(),l=function(e,t){if(1===e.length)return 0;for(var n=0,r=e.length;n<r;){var o=Math.floor(n+(r-n)/2);if(e[o][1]>=t&&(!e[o-1]||e[o-1][1]<t))return o;e[o][1]<t?n=o+1:r=o}return-1}},1068:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1155),n(88)),d=n.n(u),h=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._docEvent=void 0,n._clickFlag=void 0,n.state={visible:!1},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"onClick",value:function(){this._clickFlag=!0,this.setState({visible:!this.state.visible})}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docEvent=function(){e._clickFlag?e._clickFlag=!1:e.setState({visible:!1})})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docEvent)}},{key:"render",value:function(){return l.createElement("div",{onClick:this.onClick,className:"hint "+(this.state.visible?"visible ":"")+(this.props.className||"")},l.createElement("div",{className:"question"},"?"),l.createElement("p",{className:"text"+(this.props.position?" "+this.props.position:" top")},this.props.children))}}]),t}(l.Component),Object(p.a)(r.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),r)},1069:function(e,t,n){"use strict";var r;!function(e){e[e.Collapse=0]="Collapse",e[e.Expand=1]="Expand"}(r||(r={}));var o,a=n(20),i=n.n(a),s=n(45),c=n(5),p=n(11),l=n(1059),u=n(1098),d=n(1079),h=function(){function e(){Object(c.a)(this,e),this._encoder=new d.a}return Object(p.a)(e,[{key:"trim",value:function(e,t){var n=Object(l.e)(e.expandTrackBuffer,u.createExpandModeCodec,t);return Promise.resolve(n)}},{key:"merge",value:function(e){var t=Object(l.c)(e,(function(e){return e.expandTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),m=n(1080),f=n(1066),y=function(){function e(){Object(c.a)(this,e),this._encoder=new f.a}return Object(p.a)(e,[{key:"trim",value:function(e,t){var n=Object(l.e)(e.inputTrackBuffer,m.createInputCodec,t);return Promise.resolve(n)}},{key:"merge",value:function(e){var t=Object(l.c)(e,(function(e){return e.inputTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),v=n(294),b=function(){function e(){Object(c.a)(this,e),this._expandEditor=new h,this._inputEditor=new y}return Object(p.a)(e,[{key:"trim",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r,o,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.d)(t,n);case 2:return r=e.sent,e.next=5,this._expandEditor.trim(t,n);case 5:return o=e.sent,e.next=8,this._inputEditor.trim(t,n);case 8:return a=e.sent,s=URL.createObjectURL(r),e.abrupt("return",{id:Object(l.d)(),videoTrack:r,inputTrackBuffer:a,expandTrackBuffer:o,dataSize:r.size+a.byteLength+o.byteLength,mediaUrl:s,duration:n});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"merge",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,o,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.c)(t);case 2:return n=e.sent,e.next=5,this._expandEditor.merge(t);case 5:return r=e.sent,e.next=8,this._inputEditor.merge(t);case 8:return o=e.sent,a=t.reduce((function(e,t){return e+t.duration}),0),s=URL.createObjectURL(n),e.abrupt("return",{id:Object(l.d)(),videoTrack:n,inputTrackBuffer:o,expandTrackBuffer:r,dataSize:n.size+o.byteLength+r.byteLength,mediaUrl:s,duration:a});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),g=n(40),O=n(30),C=n(28),k=n(29),j=n(1467),w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(O.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).notificationText="Recording too short",n}return Object(k.a)(t,e),t}(Object(j.a)(Error)),E=function(){function e(t,n,r){Object(c.a)(this,e),this._mediaRecorder=t,this._inputRecorder=n,this._expandModeRecorder=r,this._state="stopped",this._startTime=void 0,this._duration=0,this._recorders=void 0,this._recorders=[this._mediaRecorder,this._inputRecorder,this._expandModeRecorder]}return Object(p.a)(e,[{key:"start",value:function(){"stopped"===this._state&&(this._startTime=Date.now(),this._duration=0,this._state="recording",this._recorders.forEach((function(e){return e.start()})))}},{key:"stop",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("recording"===this._state){e.next=2;break}return e.abrupt("return",Promise.reject("Cannot stop ScreenRecorder. Current state is ".concat(this._state)));case 2:return this._state="processing",t=Date.now()-this._startTime,this._duration=t,e.abrupt("return",Promise.all(this._recorders.map((function(e){return e.stop()}))).then(function(){var e=Object(s.a)(i.a.mark((function e(r){var o,a,s,c,p,u,d,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(g.a)(r,3),a=o[0],s=o[1],c=o[2],n._state="stopped",!(t<1e3)){e.next=4;break}throw new w;case 4:return e.next=6,Object(v.a)(a);case 6:return a=e.sent,p=URL.createObjectURL(a),e.next=10,Object(m.toArrayBuffer)(s);case 10:return u=e.sent,e.next=13,Object(m.toArrayBuffer)(c);case 13:return d=e.sent,e.next=16,Object(l.a)(p);case 16:return h=e.sent,e.abrupt("return",{id:Object(l.d)(),videoTrack:a,inputTrack:s,inputTrackBuffer:u,expandTrack:c,expandTrackBuffer:d,dataSize:a.size+s.size+c.size,mediaUrl:p,duration:h});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateStream",value:function(e){this._recorders.forEach((function(t){return t.updateStream(e)}))}},{key:"size",get:function(){return this._recorders.reduce((function(e,t){return e+t.size}),0)}},{key:"duration",get:function(){return"recording"===this._state?Date.now()-this._startTime:this._duration}},{key:"isRecording",get:function(){return"recording"===this._state}}]),e}(),_=n(97),S=n(87),D=n(88),P=n.n(D);var T,R,x=(o=function(){function e(t,n,r){Object(c.a)(this,e),this._client=t,this._audioStream=n,this._resolution=r,this._state="stopped",this._config=function(){var e,t=[{mediaType:"video/webm;codecs=vp9,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:30,timeSlice:1e3},{mediaType:"video/webm;codecs=vp8,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:24,timeSlice:1e3}];return function(){if(e)return e;if(!(e=t.find((function(e){return MediaRecorder.isTypeSupported(e.mediaType)}))))throw new Error("No supported media codec found");return e}()}(),this._videoElement=document.createElement("video"),this._recorder=void 0,this._videoStreamCanvasContext=void 0,this._blobBuffer=[],this._pollingTimeout=void 0,this._pollingDuration=void 0,this._isUsingUpdatedVideoStream=!1,this._stopResolve=void 0,this._stopReject=void 0}return Object(p.a)(e,[{key:"start",value:function(){if("stopped"===this._state){this._pollingDuration=1e3/(this._config.frameRate||30);var e=this._createVideoStreamCanvas(),t=new MediaStream([].concat(Object(_.a)(e.getTracks()),Object(_.a)(this._audioStream.getAudioTracks())));this._recorder=new MediaRecorder(t,{mimeType:this._config.mediaType,audioBitsPerSecond:this._config.audioBitRate,videoBitsPerSecond:this._config.videoBitRate}),this._recorder.ondataavailable=this._onRecorderDataAvailable,this._recorder.onstop=this._onRecorderStopped,this._recorder.onerror=this._onRecorderError,this._recorder.start(this._config.timeSlice),this._poll(),this._state="recording",console.log("Recording started. MediaType: ".concat(this._config.mediaType," FrameRate: ").concat(this._config.frameRate," Resolution: ").concat(this._resolution.width,"/").concat(this._resolution.height))}}},{key:"stop",value:function(){var e=this;return this._stopPolling(),this._recorder.stop(),this._state="processing",new Promise((function(t,n){e._stopResolve=function(){e._state="stopped",t(new Blob(e._blobBuffer,{type:"video/webm"})),e._cleanUp()},e._stopReject=n}))}},{key:"updateStream",value:function(e){this._isUsingUpdatedVideoStream=!!e,e&&(this._videoElement.autoplay=!0,this._videoElement.srcObject=e,this._videoElement.height=this._resolution.height,this._videoElement.width=this._resolution.width)}},{key:"_onRecorderDataAvailable",value:function(e){this._blobBuffer.push(e.data)}},{key:"_onRecorderStopped",value:function(e){this._stopResolve&&this._stopResolve()}},{key:"_onRecorderError",value:function(e){console.error("MediaRecorder error",e),this._state="error",this._stopReject&&this._stopReject(e),this._cleanUp()}},{key:"_poll",value:function(){this._refreshCanvas(),this._pollingTimeout=setTimeout(this._poll,this._pollingDuration)}},{key:"_cleanUp",value:function(){this._stopPolling(),this._blobBuffer=[],this._stopResolve=void 0,this._stopReject=void 0}},{key:"_stopPolling",value:function(){this._pollingTimeout&&(clearTimeout(this._pollingTimeout),this._pollingTimeout=void 0)}},{key:"_createVideoStreamCanvas",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=e.captureStream(this._config.frameRate),r=this._resolution,o=r.width,a=r.height;if(e.width=o,e.height=a,!t)throw new Error("Cannot initialize the context");return this._videoStreamCanvasContext=t,n}},{key:"_refreshCanvas",value:function(){this._isUsingUpdatedVideoStream?this._drawVideoStream():this._drawVM()}},{key:"_drawVM",value:function(){var e=this._client.getDisplay(),t=this._client.getDisplayCanvas();if(t&&t.width&&t.height){var n=this._resolution;this._videoStreamCanvasContext.drawImage(t,0,0,e?e.getWidth():0,e?e.getHeight():0,0,0,n.width,n.height);var r=this._client.getMouse();if(r){var o=this._client.getCursorCanvas();if(o){var a=r.currentState,i=t.width/n.width;this._videoStreamCanvasContext.drawImage(o,0,0,o.width,o.height,(a.x-this._client.getDisplay().cursorHotspotX)/i/this._client.scaleX||1,(a.y-this._client.getDisplay().cursorHotspotY)/i/this._client.scaleY||1,o.width/i,o.height/i)}}}}},{key:"_drawVideoStream",value:function(){this._videoStreamCanvasContext.drawImage(this._videoElement,0,0,this._videoElement.width,this._videoElement.height)}},{key:"size",get:function(){return this._blobBuffer.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(o.prototype,"_onRecorderDataAvailable",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderDataAvailable"),o.prototype),Object(S.a)(o.prototype,"_onRecorderStopped",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderStopped"),o.prototype),Object(S.a)(o.prototype,"_onRecorderError",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderError"),o.prototype),Object(S.a)(o.prototype,"_poll",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_poll"),o.prototype),o),M=n(292),N=n(1060),V=n(1055),A=(T=function(){function e(t,n){Object(c.a)(this,e),this._client=void 0,this._onKeyboardEventCallback=void 0,this._codec=new f.a,this._startedAt=0,this._disableClicks=void 0,this._blobs=[],this._lastMouseMoveUpdate=void 0,this._recordKeyUp=this._recordKey(!1),this._recordKeyDown=this._recordKey(!0),this._client=t,this._onKeyboardEventCallback=n}return Object(p.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),Object(p.a)(e,[{key:"start",value:function(){this._isRecording||(this._startedAt=Date.now(),this._blobs=[new Blob([this._codec.version])],this._recordInitialMousePosition(),this._client.on(M.h,this._recordMouseUp),this._client.on(M.f,this._recordMouseDown),this._client.on(M.g,this._recordMouseMove),this._client.on(M.d,this._recordKeyDown),this._client.on(M.e,this._recordKeyUp))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));this._client.off(M.h,this._recordMouseUp),this._client.off(M.f,this._recordMouseDown),this._client.off(M.g,this._recordMouseMove),this._client.off(M.d,this._recordKeyDown),this._client.off(M.e,this._recordKeyUp);var e=new Blob(this._blobs);return this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){this._disableClicks=!!e}},{key:"_recordMouseUp",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseDown",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseMove",value:function(e){this._isRecording&&(!this._lastMouseMoveUpdate||Math.abs(this._lastMouseMoveUpdate.x-e.x)>=5||Math.abs(this._lastMouseMoveUpdate.y-e.y)>=5)&&(this._disableClicks&&(e.left=!1,e.right=!1,e.middle=!1),this._lastMouseMoveUpdate={x:e.x,y:e.y},this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY))}},{key:"_recordInitialMousePosition",value:function(){var e=this._client.getMouse();e&&this._recordMouseMove(e.currentState)}},{key:"_recordKey",value:function(e){var t=this;return function(n){if(t._isRecording){var r=t._encodeKeyboardEvent(e?1:0,n).timestamp;t._onKeyboardEventCallback({type:N.a.Keyboard,timestamp:r,keyCode:n,down:e})}}}},{key:"_encodeKeyboardEvent",value:function(e,t){var n=Date.now()-this._startedAt;return this._blobs.push(this._codec.encodeKeyboardEvent(n,e,t)),{timestamp:n,down:e,keyCode:t}}},{key:"_encodeMouseEvent",value:function(e,t,n){var r=Date.now()-this._startedAt;this._blobs.push(this._codec.encodeMouseEvent(r,e,t,n))}}]),e}(),Object(S.a)(T.prototype,"_recordMouseUp",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseUp"),T.prototype),Object(S.a)(T.prototype,"_recordMouseDown",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseDown"),T.prototype),Object(S.a)(T.prototype,"_recordMouseMove",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseMove"),T.prototype),T),I=(R=function(){function e(t){Object(c.a)(this,e),this._source=t,this._codec=new d.a,this._blobs=[],this._startedAt=0}return Object(p.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}}]),Object(p.a)(e,[{key:"start",value:function(){this._isRecording||(this._blobs=[new Blob([this._codec.version])],this._startedAt=Date.now(),this._recordInitialMode(this._source.currentMode),this._source.onCollapse(this._collapse),this._source.onExpand(this._expand))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));var e=new Blob(this._blobs);return this._source.offCollapse(this._collapse),this._source.offExpand(this._expand),this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){}},{key:"_collapse",value:function(){this._recordExpandModeEvent(r.Collapse)}},{key:"_expand",value:function(){this._recordExpandModeEvent(r.Expand)}},{key:"_recordExpandModeEvent",value:function(e){this._isRecording&&this._blobs.push(this._codec.encodeExpandModeEvent(Date.now()-this._startedAt,e))}},{key:"_recordInitialMode",value:function(e){this._blobs.push(this._codec.encodeExpandModeEvent(0,e))}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(R.prototype,"_collapse",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_collapse"),R.prototype),Object(S.a)(R.prototype,"_expand",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_expand"),R.prototype),Object(S.a)(R.prototype,"_recordExpandModeEvent",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_recordExpandModeEvent"),R.prototype),R),U=n(9),L=n(2),F=n(0),z=Object(U.List)([]),B=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(O.a)(this,Object(C.a)(t).call(this,e)))._timeout=void 0,n._playbackRate=1,n._isPlaying=!1,n}return Object(k.a)(t,e),Object(p.a)(t,[{key:"play",value:function(e){this._isPlaying=!0,this._instance.props.dispatch(new L.O("annotations-notification-contex"));var t=this._annotations.filter((function(t){return t.time>=e}));this._nextAnnotation(e,t)}},{key:"pause",value:function(){this._isPlaying=!1,this._timeout&&clearTimeout(this._timeout)}},{key:"destroy",value:function(){this.pause(),this._instance.props.dispatch(new L.O("annotations-notification-contex"))}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"_nextAnnotation",value:function(e,t){var n=this;if(this._timeout&&clearTimeout(this._timeout),t.size){var r=t.first(),o=(r.time-e)/this._playbackRate;this._timeout=setTimeout((function(){n._instance.props.dispatch(new L.i(new F.I({type:F.J.Annotation,title:"Annotation",text:r.content,context:"annotations-notification-contex",ttl:r.duration}))),n._nextAnnotation(r.time,t.delete(0))}),o)}}}]),t}(function(){function e(t){Object(c.a)(this,e),this._instance=t}return Object(p.a)(e,[{key:"_annotations",get:function(){return this._instance.props.annotations||z}}]),e}()),W=function(e){return new B(e)},H=n(48),K=(n(1067),Symbol("OnFrame")),Y=Symbol("Finish"),G=function(){function e(t){Object(c.a)(this,e),this._emitter=new H.EventEmitter,this._currentTime=0,this._startedFrom=0,this._playing=!1,this._view=void 0,this._iterator=void 0,this._lastMouseEvent=void 0,this._skipNextFrame=!1,this._startTime=0,this._currentTimeout=void 0,this._playbackRate=1,this._view=new m.InputPlayerView(t)}return Object(p.a)(e,[{key:"play",value:function(e){return clearTimeout(this._currentTimeout),this._startTime=Date.now(),this._startedFrom=e/this._playbackRate,this._currentTime=e/this._playbackRate,this._skipNextFrame=!1,this._iterator=this._view.getIteratorAt(e),this._playing=!0,this._nextFrame(),this._view.getKeyframeAt(e)}},{key:"setPlaybackRate",value:function(e){this._playbackRate=e}},{key:"getKeyframeAt",value:function(e){return this._view.getKeyframeAt(e)}},{key:"pause",value:function(){clearTimeout(this._currentTimeout),this._playing=!1}},{key:"resume",value:function(){this._playing||this._nextFrame()}},{key:"onFrame",value:function(e){var t=this;return this._emitter.on(K,e),function(){return t._emitter.off(K,e)}}},{key:"onFinish",value:function(e){var t=this;return this._emitter.on(Y,e),function(){return t._emitter.off(Y,e)}}},{key:"sync",value:function(e){Math.abs(e-this._currentTime)>150&&(console.log("Syncing the input player"),this.play(e))}},{key:"_nextFrame",value:function(){var e=this,t=this._iterator.next();if(!t.done&&t.value){var n=t.value,r=n.timestamp/this._playbackRate;if(this._skipNextFrame&&this._canSkip(n))return console.log("Skipping frame"),this._currentTime=r,this._nextFrame();var o=Date.now()-this._startTime,a=this._currentTime-this._startedFrom,i=r-this._currentTime,s=o-a,c=Math.max(0,i-s);0===c&&(this._skipNextFrame=!0),this._currentTimeout=setTimeout((function(){e._emitter.emit(K,n),e._currentTime=r,e._nextFrame()}),c)}else this._emitter.emit(Y)}},{key:"_canSkip",value:function(e){if(e.type===m.EventType.Keyboard)return!1;var t=this._lastMouseEvent;return!!t&&(t.down===e.down&&t.left===e.left&&t.middle===e.middle&&t.right===e.right&&e.up===e.up)}}]),e}(),J=function(){},Z=function(){function e(t){Object(c.a)(this,e),this._codec=void 0,this._events=void 0,this._playbackRate=1,this._learnerSidebarModeChangeTimestamp=-1,this._isPlaying=!1,this._timeout=void 0,this._expandModeChangeCallback=J,this._codec=Object(u.createExpandModeCodec)(t);var n=this._codec.decodeBuffer(t.slice(1));this._events=this._translate(n)}return Object(p.a)(e,[{key:"onExpandModeChange",value:function(e){this._expandModeChangeCallback=e}},{key:"play",value:function(e){this._isPlaying=!0;var t=this._events.filter((function(t){return t.timestamp<e}));if(t.length){var n=t[t.length-1];n.timestamp>this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(n.type)}else-1===this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(r.Collapse);var o=this._events.filter((function(t){return t.timestamp>=e}));this._nextExpandModeChange(e,o)}},{key:"pause",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"destroy",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"learnerChangedSidebarMode",value:function(e){this._learnerSidebarModeChangeTimestamp=e}},{key:"_nextExpandModeChange",value:function(e,t){var n=this;if(t.length){var r=t[0],o=(r.timestamp-e)/this._playbackRate;this._clearTimeout(),this._timeout=setTimeout((function(){n._expandModeChangeCallback(r.type),t.shift(),n._nextExpandModeChange(r.timestamp,t)}),o)}}},{key:"_clearTimeout",value:function(){this._timeout&&clearTimeout(this._timeout)}},{key:"_translate",value:function(e){return e.map((function(e){return{timestamp:e[0],type:e[1]}}))}}]),e}(),q=Symbol("Expand"),X=Symbol("Collapse"),$=function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(n=Object(O.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(a))))._currentMode=r.Collapse,n}return Object(k.a)(t,e),Object(p.a)(t,[{key:"onExpand",value:function(e){return this.addListener(q,e)}},{key:"onCollapse",value:function(e){return this.addListener(X,e)}},{key:"offExpand",value:function(e){return this.removeListener(q,e)}},{key:"offCollapse",value:function(e){return this.removeListener(X,e)}},{key:"didExpand",value:function(){this._currentMode=r.Expand,this.emit(q)}},{key:"didCollapse",value:function(){this._currentMode=r.Collapse,this.emit(X)}},{key:"currentMode",get:function(){return this._currentMode}}]),t}(H.EventEmitter);n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return E})),n.d(t,"i",(function(){return x})),n.d(t,"g",(function(){return A})),n.d(t,"c",(function(){return I})),n.d(t,"k",(function(){return W})),n.d(t,"f",(function(){return G})),n.d(t,"b",(function(){return Z})),n.d(t,"d",(function(){return $})),n.d(t,"a",(function(){return N.a}))},1070:function(e,t,n){"use strict";var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(1471),p=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(a.a)(this,Object(i.a)(t).call(this)))._handleConfig(e),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"destroy",value:function(){Object(c.a)(Object(i.a)(t.prototype),"removeAllListeners",this).call(this)}}]),t}(n(48).EventEmitter),l=Symbol("ComboPress"),u=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).emitted=void 0,n._pressed=new Set,n._keys=[],n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"_handleConfig",value:function(e){this._keys=e}},{key:"keys",get:function(){return this._keys}},{key:"pressed",get:function(){return this._pressed}}]),t}(p),d=new(function(){function e(){Object(r.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var n=new u(e);return n.addListener(l,t),this._instances.push(n),n}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the KeyComboListener"),document.addEventListener("click",(function(){e._instances.forEach((function(e){return e.pressed.clear()}))})),document.addEventListener("keydown",(function(t){e._instances.forEach((function(e){if(e.keys.indexOf(t.keyCode)>-1){if(e.pressed.add(t.keyCode),!e.emitted&&e.pressed.size===e.keys.length){var n=0;e.keys.forEach((function(t){e.pressed.has(t)&&(n+=1)})),n===e.keys.length&&(e.emit(l),e.emitted=!0)}}else e.pressed.clear()}))})),document.addEventListener("keyup",(function(t){e._instances.forEach((function(e){e.keys.indexOf(t.keyCode)>-1&&(e.pressed.delete(t.keyCode),e.emitted=!1)}))}))}}]),e}()),h=function(e){function t(e,n){var o;return Object(r.a)(this,t),(o=Object(a.a)(this,Object(i.a)(t).call(this,e)))._eventSymbol=n,o._delay=void 0,o._timeout=void 0,o}return Object(s.a)(t,e),Object(o.a)(t,[{key:"execute",value:function(){var e=this;this._timeout&&clearTimeout(this._timeout),this._delay>0?this._timeout=setTimeout((function(){return e.emit(e._eventSymbol)}),this._delay):this.emit(this._eventSymbol)}},{key:"_handleConfig",value:function(e){this._delay=100,void 0!==e.delay&&null!==e.delay&&(this._delay=e.delay)}}]),t}(p),m=new(function(){function e(){Object(r.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var n=Symbol("WindowResize"),r=new h(e,n);return r.addListener(n,t),this._instances.push(r),r}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the ResizeListener"),window.addEventListener("resize",(function(){e._instances.forEach((function(e){return e.execute()}))}))}}]),e}());n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}))},1071:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(88),u=n.n(l),d=n(4),h=(n(1300),r=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={focused:!1},n._ref=void 0,n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this._ref)}},{key:"onFocus",value:function(e){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur(e)}},{key:"render",value:function(){var e=this,t=this.props;return d.createElement("div",{className:"rhyme-input","data-name":this.props.name,onClick:this._focusInput},d.createElement("input",Object.assign({ref:function(t){return e._ref=t},className:this.className,onChange:this.props.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onClick:this.props.onClick,onDragStart:this.props.onDragStart,onDrop:this.props.onDrop,onKeyUp:this.props.onKeyUp,onKeyDown:this.props.onKeyDown,name:this.props.name,value:this.props.value,spellCheck:this.props.spellCheck,id:t.id,type:t.type,size:t.size,disabled:t.disabled,defaultValue:t.defaultValue,placeholder:this.placeholder,maxLength:t.maxLength,autoComplete:this.props.autoComplete,autoFocus:t.autoFocus},this.props.ignoreLastPass?{"data-lpignore":!0}:{})),t.label&&d.createElement("span",{className:"label"},t.label),this.props.error&&d.createElement("span",{className:"input-error-msg"},this.props.error))}},{key:"_focusInput",value:function(){this._ref&&this._ref.focus()}},{key:"className",get:function(){var e="";return this.props.className&&(e+=this.props.className),this.props.error&&(e+=" error"),this.props.value&&(e+=" filled-input"),this.props.ignoreLastPass&&(e+=" lpignore-search-box"),e}},{key:"placeholder",get:function(){return this.state.focused||this.props.alwaysShowPlaceholder?this.props.placeholder:""}}]),t}(d.Component),Object(p.a)(r.prototype,"onFocus",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"onFocus"),r.prototype),Object(p.a)(r.prototype,"onBlur",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"onBlur"),r.prototype),Object(p.a)(r.prototype,"_focusInput",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"_focusInput"),r.prototype),r)},1074:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n(49),o=n(97),a=n(5),i=n(11),s=function(e,t,n,r){return{left:e,top:t,right:n,bottom:r}},c=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){var n=t.x,r=t.y;return s(Math.min(e.left,n),Math.min(e.top,r),Math.max(e.right,n),Math.max(e.bottom,r))}),s(e.x,e.y,e.x,e.y))},p=function(e,t){return s(Math.max(e.left,t.left),Math.max(e.top,t.top),Math.min(e.right,t.right),Math.min(e.bottom,t.bottom))},l=function(e,t){var n=t.x,r=t.y,o=n-e.left,a=n-e.right,i=r-e.top,s=r-e.bottom;return{x:o<0?o:a>0?a:0,y:i<0?i:s>0?s:0}},u=function(){function e(t){Object(a.a)(this,e),this.minRectWidth=100,this.minRectHeight=100,this.keepHistoryFor=5e3,this.positions=[],this.center={x:0,y:0},this.now=Date.now,Object.assign(this,t)}return Object(i.a)(e,[{key:"update",value:function(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.center,s=i.x,u=i.y,d=c.apply(void 0,[{x:s-this.minRectWidth/2,y:u-this.minRectHeight/2},{x:s+this.minRectWidth/2,y:u+this.minRectHeight/2}].concat(Object(o.a)(this.positions))),h=a?p(a,d):d,m=l(h,t),f=this.now(),y=this.positions.filter((function(e){return f-e.ts<n.keepHistoryFor})),v=[].concat(Object(o.a)(y),[Object(r.a)({},t,{ts:f})]),b=m.x||m.y?{x:s+m.x,y:u+m.y}:this.center;return new e({positions:v,center:b})}}]),e}();u.empty=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u(e)};var d=function(e){var t=u.empty();return function(n){var r=n.x,o=n.y,a=e.padding,i=void 0===a?20:a,c={x:e.zoom*r,y:e.zoom*o},p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!t)return null;var r=e.getBoundingClientRect(),o=t.getBoundingClientRect(),a=o.left-r.left,i=o.top-r.top;return s(a+n,i+n,a+o.width-n,i+o.height-n)}(e.vmContainer,e.vmKeyhole,i),l=t.update(c,p);if(l.center!==t.center){var u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.minSmoothDist,o=void 0===r?10:r,a=n.maxIntermediatePoints,i=void 0===a?8:a,s=t.x-e.x,c=t.y-e.y,p=Math.max(Math.abs(s),Math.abs(c)),l=Math.floor(p/o)+1,u=Math.min(i,l),d=Array.from({length:u},(function(e,t){return(t+1)/u})),h=d.map((function(t){return{x:e.x+t*s,y:e.y+t*c}}));return h}(t.center,l.center),d=!0,h=!1,m=void 0;try{for(var f,y=u[Symbol.iterator]();!(d=(f=y.next()).done);d=!0){var v=f.value;e.setState({keyholeCenter:v})}}catch(b){h=!0,m=b}finally{try{d||null==y.return||y.return()}finally{if(h)throw m}}}t=l}},h=function(e){var t=u.empty();return{moveCenter:function(n){var r=e.zoomPointerDimensions,o=r.width,a=r.height,i=e.padding,s=void 0===i?20:i,c=o/2,p=a/2,l=t.center,u={left:l.x-c+s,top:l.y-p+s,right:l.x+c-s,bottom:l.y+p-s},d=t.update(n,u);d.center!==t.center&&e.setState({zoomPointerCenter:d.center}),t=d},resetHistory:function(){return t=u.empty()}}}},1076:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return l}));var r=n(0),o=function(e){return e.type!==r.s.Instruction},a=function(e,t){return!!t.find((function(t){return t.order<e.order&&t.paid&&o(t)&&t.state===r.h.NotCompleted}))},i=function(e){return e.type===r.s.ChallengePeerApproval||e.type===r.s.ChallengeHostApproval},s=function(e){return e.map((function(e){return o(e)&&e.state===r.h.Approved||!o(e)})).reduce((function(e,t){return!(!e||!t)}))},c=function(e){return e.filter((function(e){return e.state===r.h.Rejected}))},p=function(e){return!!function(e){return e.filter((function(e){return o(e)&&e.state===r.h.Submitted}))}(e).count()},l=function(e){return!!c(e).count()}},1077:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(164);var r=function(e){if(!e)return"-";var t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),a=n-60*r,i=t-60*n,s="";return r&&(s="".concat(o(r),":")),"".concat(s).concat(o(a),":").concat(o(i))},o=function(e){return"".concat(e<10?0:"").concat(e)}},1078:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=n(163),l=(n(1324),function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-v2-bg",style:this.props.overflow?{overflow:this.props.overflow}:{}},c.createElement("div",{className:"shape-second"}),c.createElement("div",{className:"shape-gray2"}))}}]),t}(c.PureComponent)),u=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._bgContainer=void 0,n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this._appendBackground()}},{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){(this.props.wrapper?this.props.wrapper:document.body).removeChild(this._bgContainer)}},{key:"_appendBackground",value:function(){this._bgContainer=document.createElement("div"),(this.props.wrapper?this.props.wrapper:document.body).appendChild(this._bgContainer),p.render(c.createElement(l,this.props),this._bgContainer)}}]),t}(c.PureComponent)},1079:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(5),o=n(11),a=Math.pow(2,32)-1,i=0,s=function(){function e(){Object(r.a)(this,e),this.version=new Uint8Array([i]),this.packetSize=5}return Object(o.a)(e,[{key:"encodeExpandModeEvent",value:function(e,t){if(e>a)throw new Error("Cannot encode time stamps bigger than 32bit");var n=new Uint32Array([e]),r=new Uint8Array([t]);return new Blob([n,r])}},{key:"decodeBuffer",value:function(e){for(var t=[],n=0;n+5<=e.byteLength;n+=5){var r=new DataView(e,n,5);t.push(this.decodePacket(r))}if(n!==e.byteLength)throw new Error("Invalid package size. It is not dividable by ".concat(5,"."));return t}},{key:"decodePacket",value:function(e){if(5===e.byteLength)return[e.getUint32(0,!0),e.getUint8(4)];throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t,!0)}},{key:"setPacketTimestamp",value:function(e,t,n){return e.setUint32(t,n,!0)}}]),e}()},1080:function(e,t,n){"use strict";var r=n(1060);n.d(t,"EventType",(function(){return r.a}));var o=n(1102);n.o(o,"InputPlayerView")&&n.d(t,"InputPlayerView",(function(){return o.InputPlayerView}));var a=n(1055);n.d(t,"toArrayBuffer",(function(){return a.c})),n.d(t,"createInputCodec",(function(){return a.a}));var i=n(1067);n.d(t,"InputPlayerView",(function(){return i.a}))},1084:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1303),n(1051)),l=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-btn "+(this.props.className||"")},c.createElement("button",{className:"native-btn",onClick:this.props.onClick,disabled:this.disabled,type:this.type}),c.createElement("div",{className:"rendered-btn"},this.props.loading?c.createElement(p.a,null):this.props.children))}},{key:"disabled",get:function(){return this.props.disabled||this.props.loading}},{key:"type",get:function(){return this.props.type||"submit"}}]),t}(c.Component)},1085:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1305),n(1051)),l=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("button",{className:"rhyme-btn2 "+(this.props.className||""),onClick:this.props.onClick,disabled:this.disabled,type:this.type},this.props.loading?c.createElement(c.Fragment,null,c.createElement(p.a,{theme:(this.props.className||"").indexOf("empty")<0?"light":"dark"}),"\xa0"):this.props.children)}},{key:"disabled",get:function(){return this.props.disabled||this.props.loading}},{key:"type",get:function(){return this.props.type||"submit"}}]),t}(c.Component)},1086:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d}));var r=function(e,t){return t.some((function(t){return t.courseId===e.id}))},o=function(e,t){var n=new Date;return t.some((function(t){return t.courseId===e.id&&t.startTime>n}))},a=function(e,t){return t.some((function(t){return t.courseId===e.id&&p(t)}))},i=function(e,t){return t.some((function(t){return t.courseId===e.id&&l(t)}))},s=function(e,t,n){return d(e,t,n).some((function(e){return l(e)}))},c=function(e,t,n){return d(e,t,n).some((function(e){return p(e)}))},p=function(e){return new Date>e.startTime&&!u(e)},l=function(e){var t=new Date,n=e.startTime.getTime()-t.getTime();return n>0&&n<6e5},u=function(e){var t=new Date;return t>e.expirationTime||!!e.endTime&&t>e.endTime},d=function(e,t,n){var r=t.filter((function(t){return t.templateId===e.id})).map((function(e){return e.id}));return n.filter((function(e){return r.includes(e.courseId)})).toList()}},1088:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return O}));var r,o=n(40),a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=n(163),h=n(88),m=n.n(h),f=n(15),y=n(1070),v=(n(1183),n(1346).default),b=600,g=500,O=(r=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e)))._splitter=void 0,n._leftResolver=void 0,n._rightResolver=void 0,n._leftPromise=new Promise((function(e){return n._leftResolver=e})),n._rightPromise=new Promise((function(e){return n._rightResolver=e})),n._resizeEntry=void 0,n._rightPanelSize=void 0,n.state={resizing:!1},n.props.onPanelsRefs&&Promise.all([n._leftPromise,n._rightPromise]).then((function(e){var t=Object(o.a)(e,2),r=t[0],a=t[1];return n.props.onPanelsRefs(r,a)})),n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._configureSplitter(),this._resizeEntry=y.b.create({delay:0},(function(){e._onResize(e._rightPanelSize)}))}},{key:"componentDidUpdate",value:function(){this._configureSplitter()}},{key:"componentWillUnmount",value:function(){y.b.destroy(this._resizeEntry)}},{key:"onResizeStart",value:function(){this.setState({resizing:!0}),this.props.onResizeStart&&this.props.onResizeStart()}},{key:"onResizeEnd",value:function(){this.setState({resizing:!1}),this.props.onResizeEnd&&this.props.onResizeEnd()}},{key:"onResize",value:function(e){this._rightPanelSize=e,this._onResize(this._rightPanelSize)}},{key:"render",value:function(){var e=this,t=this.props.children;return u.createElement(v,{ref:function(t){return e._splitter=t},onDragStart:this.onResizeStart,onSecondaryPaneSizeChange:this.onResize,onDragEnd:this.onResizeEnd,primaryMinSize:b,secondaryInitialSize:this.props.rightPanelInitialSize,customClassName:"split-view "+(this.props.className||"")},t&&t[0]?u.createElement("section",{className:"left-panel",ref:this._leftResolver},this.state.resizing?u.createElement("div",{className:"overlay"}):null,t[0]):null,t&&t[1]?u.createElement("section",{className:"right-panel",ref:this._rightResolver},t[1]):null)}},{key:"_createDotWrapper",value:function(){var e=function(){var e=document.createElement("i");return e.className="fa fa-circle",e},t=document.createElement("div");return t.appendChild(e()),t.appendChild(e()),t.appendChild(e()),t.className="dot-wrapper",t}},{key:"_configureSplitter",value:function(){if(this._splitter){var e=Object(d.findDOMNode)(this._splitter);if(!e||e instanceof Text)return;var t=e.querySelector(".splitter-layout > .layout-splitter");if(t)t.querySelector(".dot-wrapper")||t.appendChild(this._createDotWrapper())}}},{key:"_onResize",value:function(e){if(this.props.onResize){var t=window.innerWidth-e-f.a.SplitterWidth;this.props.onResize(t,e)}}}]),t}(u.Component),Object(l.a)(r.prototype,"onResizeStart",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResizeStart"),r.prototype),Object(l.a)(r.prototype,"onResizeEnd",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResizeEnd"),r.prototype),Object(l.a)(r.prototype,"onResize",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResize"),r.prototype),r)},1091:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1180),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._wrapperRef=void 0,n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.forceUpdate()}))}},{key:"getScale",value:function(){var e={scaleX:1,scaleY:1,width:0,height:0};if(this._wrapperRef&&this._wrapperRef.children[0]){var t=this.props.scaledWidth;(void 0===t||isNaN(t))&&(t=this._wrapperRef.parentElement.clientWidth),e.scaleX=t/this.props.originalWidth;var n=t/(this.props.originalWidth/this.props.originalHeight);e.scaleY=n/this.props.originalHeight,e.height=n,e.width=t}return!isNaN(e.width)&&!isNaN(e.height)&&isFinite(e.scaleX)&&isFinite(e.scaleY)?e:{scaleX:1,scaleY:1,width:0,height:0}}},{key:"render",value:function(){var e=this,t=this.props.children,n=this.getScale(),r=n.scaleX,o=n.scaleY,a=n.width,i=n.height;if(t.length&&t.length>=2)throw new Error("Only one scalable child allowed");var s={WebkitTransform:"scale(".concat(r,", ").concat(o,")"),msTransform:"scale(".concat(r,", ").concat(o,")"),transform:"scale(".concat(r,", ").concat(o,")"),WebkitTransformOrigin:"0 0 0",msTransformOrigin:"0 0 0",transformOrigin:"0 0 0"};return c.createElement("div",{ref:function(t){e._wrapperRef=t},style:Object.assign({width:a,height:i},this.props.style),className:"scalable-component"},c.cloneElement(t,{style:s}))}}]),t}(c.Component))},1093:function(e,t,n){"use strict";var r=n(5),o=n(30),a=n(28),i=n(11),s=n(29),c=n(4),p=n.n(c),l=(n(1169),n(1111));function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=p.a.createElement("defs",null,p.a.createElement("path",{id:"trash-a",d:"M19.1022222,10.6666667 L28.8985185,10.6666667 L28.417037,9.22296296 C28.1140741,8.31407407 27.2666667,7.7037037 26.3088889,7.7037037 L21.6911111,7.7037037 C20.7333333,7.7037037 19.8866667,8.31407407 19.582963,9.22296296 L19.1022222,10.6666667 Z M14.3340741,40.2962963 L33.6659259,40.2962963 L35.0733333,12.1481481 L12.9274074,12.1481481 L14.3340741,40.2962963 Z M26.3088889,6.22222222 C27.9059259,6.22222222 29.3177778,7.24 29.822963,8.75481481 L30.46,10.6666667 L38.8148148,10.6666667 L38.8148148,12.1481481 L36.5562963,12.1481481 L35.0748148,41.7777778 L12.9251852,41.7777778 L11.4437037,12.1481481 L9.18518519,12.1481481 L9.18518519,10.6666667 L17.5407407,10.6666667 L18.1777778,8.75481481 C18.682963,7.24 20.0948148,6.22222222 21.6911111,6.22222222 L26.3088889,6.22222222 Z M20.6661481,17.2995556 L19.1861481,17.366963 L19.9268889,33.6632593 L21.4068889,33.5958519 L20.6661481,17.2995556 Z M27.3342963,17.2995556 L26.5935556,33.5958519 L28.0735556,33.6632593 L28.8142963,17.366963 L27.3342963,17.2995556 Z"})),m=p.a.createElement("use",{fill:"#1F1F1F",fillRule:"evenodd",xlinkHref:"#trash-a"}),f=function(e){var t=e.svgRef,n=e.title,r=d(e,["svgRef","title"]);return p.a.createElement("svg",u({width:48,height:48,viewBox:"0 0 48 48",ref:t},r),n?p.a.createElement("title",null,n):null,h,m)},y=p.a.forwardRef((function(e,t){return p.a.createElement(f,u({svgRef:t},e))}));n.p;function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var g=p.a.createElement("title",null,"RHYME/SHAPES/48x48/Trim"),O=p.a.createElement("g",{id:"RHYME/SHAPES/48x48/Trim",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},p.a.createElement("path",{d:"M14.1212418,32.4102325 C16.5760566,32.4102325 18.5642047,34.3998622 18.5642047,36.854677 C18.5642047,39.3087511 16.5760566,41.2991214 14.1212418,41.2991214 C11.666427,41.2991214 9.67531586,39.3087511 9.67531586,36.854677 C9.67531586,34.3998622 11.666427,32.4102325 14.1212418,32.4102325 Z M33.8892,32.4102325 C36.3425333,32.4102325 38.3336444,34.4006029 38.3336444,36.854677 C38.3336444,39.3087511 36.3440148,41.2991214 33.8892,41.2991214 C31.4329037,41.2991214 29.4447556,39.3087511 29.4447556,36.854677 C29.4447556,34.3998622 31.4329037,32.4102325 33.8892,32.4102325 Z M30.1111111,39.2222222 L14.5555556,7 M17.8888889,39.2222222 L33.4444444,7",id:"Scissors-Shape",stroke:"#1F1F1F",strokeWidth:1.5})),C=function(e){var t=e.svgRef,n=e.title,r=b(e,["svgRef","title"]);return p.a.createElement("svg",v({width:"48px",height:"48px",viewBox:"0 0 48 48",ref:t},r),void 0===n?g:n?p.a.createElement("title",null,n):null,O)},k=p.a.forwardRef((function(e,t){return p.a.createElement(C,v({svgRef:t},e))})),j=(n.p,n(1112)),w=n(1050),E=n.n(w),_=n(9),S=n(1061),D=n(130),P=(n(1177),function(e){function t(){var e,n;Object(r.a)(this,t);for(var i=arguments.length,s=new Array(i),p=0;p<i;p++)s[p]=arguments[p];return(n=Object(o.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(s)))).state={tooltipVisible:!1,tooltipTimestamp:0,thumbDragging:!1,trimDragging:!1,skipOddFrames:!0},n._trackRef=c.createRef(),n._trackRect={left:0,width:0},n._resizeObserver=new S.a((function(){return n.updateTrackRect()})),n.updateTrackRect=function(){if(n._trackRef.current){var e=n._trackRef.current.getBoundingClientRect(),t=e.left,r=e.width;n._trackRect={left:t,width:r}}else n._trackRect={left:0,width:0};var o=n._trackRect.width<480;n.state.skipOddFrames!==o&&n.setState({skipOddFrames:o})},n.onProgressClick=function(e){var t=e.clientX;if(isFinite(n.props.totalDuration)){var r=n._trackRect,o=r.left,a=r.width,i=t-o;n._onSeek(n.props.totalDuration*(i/a))}},n.onShowToolTip=function(e){var t=e.clientX;n.updateTrackRect(),n.setState({tooltipVisible:!0,tooltipTimestamp:n._calculateTooltipTimestamp(t)})},n.onHideToolTip=function(){n.state.thumbDragging||n.setState({tooltipVisible:!1})},n.onThumbMouseDown=function(){n.setState({thumbDragging:!0}),document.body.style.cursor="grabbing"},n.onTrimThumbMouseDown=function(){n.props.trimDisabled||(n.setState({trimDragging:!0}),document.body.style.cursor="grabbing")},n._docMouseMove=function(e){var t=e.clientX;if(n.state.thumbDragging||n.state.trimDragging){var r=n._trackRect,o=(t-r.left)/r.width,a=n.props.totalDuration*o;0<=a&&a<=n.props.totalDuration&&(n.state.thumbDragging&&(n.props.onThumbDrag(),n._onSeek(a)),n.state.trimDragging&&n.props.onTrimDrag(a))}n.state.tooltipVisible&&n.setState({tooltipTimestamp:n._calculateTooltipTimestamp(t)})},n._docMouseUp=function(){n.state.thumbDragging&&n.props.onThumbRelease(),n.state.trimDragging&&n.props.onTrimRelease(),n.setState({thumbDragging:!1,trimDragging:!1,tooltipVisible:!1}),document.body.style.cursor="default"},n}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._docMouseMove),document.addEventListener("mouseup",this._docMouseUp),this._trackRef.current&&this._resizeObserver.observe(this._trackRef.current)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp),this._resizeObserver.disconnect()}},{key:"render",value:function(){var e=this._durationPercent(this.props.currentTime),t=this.props.totalDuration-this.props.trimEndDuration,n=this._durationPercent(t),r=t/this.props.totalDuration<.9;return c.createElement("div",{className:"trim-progress-bar"},c.createElement("div",{className:E()("track-cont",this.props.trimActive&&"trim-active")},c.createElement("div",{className:E()("tooltip",this.state.tooltipVisible&&"visible"),style:{left:this._durationPercent(this.state.tooltipTimestamp)}},Object(D.d)(this.props.startOffsetTime+this.state.tooltipTimestamp)),c.createElement("div",{className:"start-label"},Object(D.d)(this.props.startOffsetTime)),r&&c.createElement("div",{className:"end-label",style:{left:"100%"}},Object(D.d)(this.props.startOffsetTime+this.props.totalDuration)),c.createElement("div",{className:"trim-label",style:{left:n}},Object(D.d)(this.props.startOffsetTime+t)),c.createElement("div",{className:"track",ref:this._trackRef,onClick:this.onProgressClick,onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip},this.visibleFrames.map((function(e){return c.createElement("img",{key:e.durationFraction,src:e.url,className:"keyframe",style:{left:100*e.durationFraction+"%"}})}))),c.createElement("div",{className:"trim-box"},c.createElement("div",{className:"trim-window",style:{width:n}}),c.createElement("div",{className:"trim-dim",style:{left:n}})),c.createElement("div",{className:E()("trim-thumb",this.state.trimDragging&&"hold",this.props.trimDisabled&&"disabled"),style:{left:n},onMouseDown:this.onTrimThumbMouseDown},!this.props.trimDisabled&&c.createElement("div",{className:"trim-handle"})),c.createElement("div",{style:{left:e},className:E()("thumb",this.state.thumbDragging&&"hold"),onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip,onMouseDown:this.onThumbMouseDown})))}},{key:"_durationPercent",value:function(e){return e/this.props.totalDuration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._trackRect.width){var t=this._trackRect.width,n=this._trackRect.left,r=Math.max(e-n,0)/t;return Math.round(this.props.totalDuration*r*1e3)/1e3}return 0}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}},{key:"visibleFrames",get:function(){return this.props.frames?this.state.skipOddFrames?this.props.frames.filter((function(e,t){return t%2===0})):this.props.frames:Object(_.List)()}}]),t}(c.PureComponent));n.d(t,"a",(function(){return T}));var T=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(a.a)(t).call(this,e))).state={playing:!1,currentTime:0,trimEndDuration:0},n._controlsService=void 0,n._draggingWhilePlaying=void 0,n.onPlayerTimeUpdated=function(e){var t=n.trimTimestamp;e>n.trimTimestamp?(n._controlsService.onPause(),n._controlsService.onSeek(t)):n.setState({currentTime:e})},n.onPlay=function(){n.disabled||n._controlsService.onPlay()},n.onPause=function(){n.disabled||n._controlsService.onPause()},n.onSeek=function(e){n.disabled||n._controlsService.onSeek(e)},n.onThumbDrag=function(){n.state.playing&&(n._controlsService.onPause(),n._draggingWhilePlaying=!0)},n.onTrimDrag=function(e){n.state.playing&&(n._controlsService.onPause(),n._draggingWhilePlaying=!0),e=Math.max(e,1),n.setState({trimEndDuration:n.duration-e})},n.onThumbRelease=function(){n._draggingWhilePlaying&&(n._draggingWhilePlaying=!1,n._controlsService.onPlay())},n.onTrimRelease=function(){var e=Math.max(0,n.trimTimestamp-3);e<n.state.currentTime&&n._controlsService.onSeek(e),n._draggingWhilePlaying&&(n._draggingWhilePlaying=!1,n._controlsService.onPlay())},n.onTrim=function(){n.trimActive&&(n.state.playing&&n._controlsService.onPause(),n.props.onTrim(1e3*n.trimTimestamp))},n.onDelete=function(){n.state.playing&&n._controlsService.onPause(),n.props.onDelete()},n._controlsService=new l.b(n.props.dispatch,{currentChapter:null,course:null}),n._controlsService.onPlayerPlaying((function(e){return n.setState({playing:e})})),n._controlsService.onPlayerTimeUpdated(n.onPlayerTimeUpdated),n}return Object(s.a)(t,e),Object(i.a)(t,[{key:"disabled",get:function(){return!(this.props.videoPlayer&&this.props.canPlayVideo)}},{key:"duration",get:function(){return this.props.videoPlayer?this.props.videoPlayer.duration:0}},{key:"trimTimestamp",get:function(){return Math.max(0,this.duration-this.state.trimEndDuration)}},{key:"trimDisabled",get:function(){return this.props.trimDisabled}},{key:"trimActive",get:function(){return!this.props.trimDisabled&&!(this.state.trimEndDuration<.1)}}]),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.videoPlayer!==e.videoPlayer&&this._controlsService.setRefs(this.props.videoPlayer),this.props.canPlayVideo&&!e.canPlayVideo&&(this.setState({trimEndDuration:0,currentTime:0}),this.props.autoPlay&&this._controlsService.onPlay())}},{key:"render",value:function(){return c.createElement("div",{className:"edit-video-controls "+(this.disabled?" disabled":"")},c.createElement("div",{className:"progress-container"},c.createElement(j.a,{playing:this.state.playing,onClick:this.state.playing?this.onPause:this.onPlay}),c.createElement(P,{disabled:this.disabled,onSeek:this.onSeek,startOffsetTime:this.props.startOffsetTime,totalDuration:this.duration,currentTime:this.state.currentTime,trimDisabled:this.trimDisabled,trimActive:this.trimActive,onThumbDrag:this.onThumbDrag,onThumbRelease:this.onThumbRelease,trimEndDuration:this.state.trimEndDuration,onTrimDrag:this.onTrimDrag,onTrimRelease:this.onTrimRelease,frames:this.props.frames})),c.createElement("div",{className:"buttons"},c.createElement("button",{disabled:!this.trimActive,onClick:this.onTrim},c.createElement(k,null),c.createElement("span",null,"TRIM")),c.createElement("button",{disabled:!this.props.canPlayVideo,onClick:this.onDelete},c.createElement(y,null),c.createElement("span",null,"DELETE"))))}}]),t}(c.Component)},1094:function(e,t,n){"use strict";var r,o,a,i=n(5),s=n(11),c=n(30),p=n(28),l=n(29),u=n(87),d=n(4),h=(n(1256),n(88)),m=n.n(h),f=n(52),y=n(60),v=n(69),b=n(17),g=n(1062),O=(n(1047),n(1297),n(1045)),C=n(288),k=(r=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"closeModal",value:function(){this.props.onToggle(!1)}},{key:"logout",value:function(){Object(b.b)().logout()}},{key:"render",value:function(){return d.createElement(C.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},d.createElement("div",{className:"logout-modal form-styles"},d.createElement("p",{className:"text"},"Are you sure you want to log out?"),d.createElement("div",null,d.createElement(O.a,{onClick:this.closeModal,className:"short-btn"},"No, Stay")),d.createElement("div",null,d.createElement(O.a,{onClick:this.logout,className:"short-btn empty"},"Yes, Logout")),d.createElement("i",{className:"fa fa-power-off"})))}}]),t}(d.Component),Object(u.a)(r.prototype,"closeModal",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),Object(u.a)(r.prototype,"logout",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"logout"),r.prototype),r),j=(n(1323),o=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"close",value:function(){this.props.onToggle(!1)}},{key:"discard",value:function(){this.close(),this.props.onDiscard()}},{key:"render",value:function(){return d.createElement("div",{className:"unsaved-session-modal form-styles"},d.createElement(C.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},d.createElement("p",{className:"text"},"You have not finished creating the session. So, it will be discarded."),d.createElement("div",{className:"row"},d.createElement(O.a,{onClick:this.close},"No, Stay"),d.createElement(O.a,{onClick:this.discard,className:"empty"},"Yes, Discard")),d.createElement("div",{className:"trash-icon"})))}}]),t}(d.Component),Object(u.a)(o.prototype,"close",[m.a],Object.getOwnPropertyDescriptor(o.prototype,"close"),o.prototype),Object(u.a)(o.prototype,"discard",[m.a],Object.getOwnPropertyDescriptor(o.prototype,"discard"),o.prototype),o),w=n(12);n.d(t,"a",(function(){return _}));var E=(a=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={menuVisible:!1,logoutModalVisible:!1,unsavedModalVisible:!1},n._docClickCb=void 0,n._stopPropagation=void 0,n._root=void 0,n._headerLine=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._stopPropagation||e.setState({menuVisible:!1}),e._stopPropagation=!1}),this._root=document.getElementById("root"),this._root&&(this._headerLine=document.createElement("div"),this._headerLine.className="header-line",this._root.appendChild(this._headerLine))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb),this._root&&this._root.removeChild(this._headerLine)}},{key:"toggleMenu",value:function(e){this.setState({menuVisible:!this.state.menuVisible}),this._stopPropagation=!0}},{key:"navigateToMySessions",value:function(){this.props.location.pathname.startsWith(w.E)?this.toggleUnsavedModal(!0):this.goToDashboard()}},{key:"navigateToAdmin",value:function(){window.location.href=w.a+"?token="+Object(b.b)().getJwt()}},{key:"goToDashboard",value:function(){this.props.redirectTo(w.ob)}},{key:"logout",value:function(){this.toggleLogoutModal(!0)}},{key:"toggleLogoutModal",value:function(e){this.setState({logoutModalVisible:e})}},{key:"toggleUnsavedModal",value:function(e){this.setState({unsavedModalVisible:e})}},{key:"authLayout",value:function(){return d.createElement("div",{className:"menu"+(this.state.menuVisible?" visible":"")},d.createElement("div",{className:"avatar-wrapper",onClick:this.toggleMenu},d.createElement(g.a,{source:this.props.user})),d.createElement("ul",null,d.createElement("li",{onClick:this.navigateToMySessions},"Dashboard"),Object(b.b)().hasAdminAccess()&&d.createElement("li",{onClick:this.navigateToAdmin},"Admin Panel"),d.createElement("li",{onClick:this.logout},"Logout")),d.createElement(k,{visible:this.state.logoutModalVisible,onToggle:this.toggleLogoutModal}),d.createElement(j,{visible:this.state.unsavedModalVisible,onToggle:this.toggleUnsavedModal,onDiscard:this.goToDashboard}))}},{key:"unauthLayout",value:function(){return d.createElement("div",{className:"links"},d.createElement("a",{href:w.bb},"Home"))}},{key:"render",value:function(){return d.createElement("header",{className:"app-header"},d.createElement("a",{href:w.bb},d.createElement("div",{className:"logo"})),Object(b.b)().isAuthorized()?this.authLayout():this.unauthLayout())}}]),t}(d.Component),Object(u.a)(a.prototype,"toggleMenu",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleMenu"),a.prototype),Object(u.a)(a.prototype,"navigateToMySessions",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"navigateToMySessions"),a.prototype),Object(u.a)(a.prototype,"navigateToAdmin",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"navigateToAdmin"),a.prototype),Object(u.a)(a.prototype,"goToDashboard",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"goToDashboard"),a.prototype),Object(u.a)(a.prototype,"logout",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"logout"),a.prototype),Object(u.a)(a.prototype,"toggleLogoutModal",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleLogoutModal"),a.prototype),Object(u.a)(a.prototype,"toggleUnsavedModal",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleUnsavedModal"),a.prototype),a),_=Object(v.g)(Object(y.c)((function(e){return{user:e.user}}),(function(e){return{redirectTo:function(t){return e(Object(f.g)(t))}}}))(E))},1096:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,o=n(49),a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=(n(1310),n(88)),h=n.n(d),m=n(1152),f=n(290),y=(r=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e)))._selectLock=void 0,n._isInputChanged=void 0,n._docKeydownEventCb=void 0,n._docClickEventCb=void 0,n._listRef=void 0,n._inputRef=void 0,n.state={visible:!1,focused:!1,highlighted:null,selected:n._getSelectedOption(e.children,e.value),inputValue:e.value?e.value:""},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._docKeydownEventCb=function(t){return e._keyboardControl(t)}),document.addEventListener("click",this._docClickEventCb=function(){return e._unfocusComponent()})}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&(this.setState({selected:this._getSelectedOption(e.children,e.value)}),this._isInputChanged=!1),e.value!==this.state.inputValue&&this.setState({inputValue:e.value?e.value:""}),e.children!==this.props.children&&this.setState({selected:this._getSelectedOption(e.children,e.value)})}},{key:"componentDidUpdate",value:function(e,t){this.state.visible&&this.state.visible!==t.visible&&this.props.value&&(this.scrollToOption(this.props.value),this.props.onShowOptions&&this.props.onShowOptions()),this.state.focused&&this.state.focused!==t.focused&&this._inputRef.focus()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._docKeydownEventCb),document.removeEventListener("click",this._docClickEventCb)}},{key:"selectOption",value:function(e){for(var t=e.target;t&&!t.hasAttribute("data-value");)t=t.parentElement;if(t){var n=t.getAttribute("data-value"),r=this.props.children.find((function(e){return e.props.value===n}));r&&!r.props.disabled&&this._updateSelected(r)}}},{key:"toggleOptions",value:function(){this._selectLock=!0;var e=!this.state.visible;this.props.editable&&e&&this._focusInput(),this.setState({visible:e,focused:e})}},{key:"onInputChange",value:function(e){this._isInputChanged=!0;var t=e.target.value;this.setState({inputValue:t})}},{key:"onBlur",value:function(e){this.props.onBlur&&this.props.onBlur(e),this.props.editable&&this._isInputChanged&&this._updateWithInputValue(e.target)}},{key:"onFocus",value:function(e){this.props.disabled||(this.props.onFocus&&this.props.onFocus(e),this.setState({focused:!0,visible:!0}))}},{key:"renderSelected",value:function(){var e=this.props.selectedFilter?this.props.selectedFilter:function(e){return e};return this.state.selected?e(this.state.selected.props.children):this.props.deletedOnMissingOption?"- Deleted -":this.props.value?e(this.props.value):this.props.placeholder?this.props.placeholder:""}},{key:"scrollToOption",value:function(e){var t=this._listRef.querySelector('li[data-value="'.concat(e,'"]')),n=t?t.offsetTop:0;this._listRef.scrollTop=n}},{key:"render",value:function(){var e=this,t=this._updateChildrenProps(),n=this.renderSelected();return u.createElement("div",{className:"rhyme-select"+(this.props.className?" ".concat(this.props.className):"")+(this.state.visible?" visible":"")+(this.state.focused?" focused":"")+(this.props.dirty?" dirty":"")+(this.props.editable?" editable":"")+(this.props.disabled?" disabled":""),"data-value":n},u.createElement("input",{ref:function(t){return e._inputRef=t},className:"focus",value:this.state.inputValue,onChange:this.onInputChange,onFocus:this.onFocus,onBlur:this.onBlur}),u.createElement("div",{className:"selected",onClick:this.toggleOptions},this.props.label&&u.createElement("span",{className:"label"},this.props.label),u.createElement("div",{className:"value"},n)),u.createElement("ul",{ref:function(t){return e._listRef=t},className:"options",onClick:this.selectOption},t),u.createElement("div",{className:"arrow",onClick:this.toggleOptions}))}},{key:"_updateSelected",value:function(e){this.setState({selected:e}),this.props.onChange(e.props.value)}},{key:"_keyboardControl",value:function(e){if(this.state.focused){[f.e,f.b,f.f].forEach((function(t){t===e.keyCode&&e.preventDefault()}));var t=this.state.highlighted,n=this.props.children;switch(e.keyCode){case f.b:this._showOptionsIfHidden(),this.setState({highlighted:Object(m.a)(n,t,0,n.length-1)});break;case f.e:this._showOptionsIfHidden(),this.setState({highlighted:Object(m.a)(n,t,n.length-1,0)});break;case f.f:this.props.editable&&this._isInputChanged?this._updateWithInputValue(e.target):t&&this._updateSelected(t),this._unfocusComponent();break;case f.g:case f.l:this._unfocusComponent()}}}},{key:"_showOptionsIfHidden",value:function(){this.state.visible||this.setState({visible:!0})}},{key:"_unfocusComponent",value:function(){this._selectLock||this.setState({focused:!1,visible:!1}),this._selectLock=!1}},{key:"_updateChildrenProps",value:function(){var e=this;return u.Children.map(this.props.children,(function(t){var n=Object(o.a)({},t.props);return t===e.state.highlighted&&(n.highlighted=!0),e.state.selected&&t.props.value===e.state.selected.props.value&&(n.selected=!0),u.cloneElement(t,n)}))}},{key:"_focusInput",value:function(){this._inputRef.focus();var e=this._inputRef.value.length-2;this._inputRef.setSelectionRange(e,e)}},{key:"_updateWithInputValue",value:function(e){var t=e.value;this.props.onChange(t)}},{key:"_getSelectedOption",value:function(e,t){return e.find((function(e){return e.props.value===t}))||null}}]),t}(u.Component),Object(l.a)(r.prototype,"selectOption",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"selectOption"),r.prototype),Object(l.a)(r.prototype,"toggleOptions",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"toggleOptions"),r.prototype),Object(l.a)(r.prototype,"onInputChange",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onInputChange"),r.prototype),Object(l.a)(r.prototype,"onBlur",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onBlur"),r.prototype),Object(l.a)(r.prototype,"onFocus",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onFocus"),r.prototype),r)},1097:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1335),function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:this.className,onClick:this.props.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,"data-name":this.props.attribute},this.props.children)}},{key:"className",get:function(){var e="rhyme-bc";return this.props.className&&(e+=" "+this.props.className),this.props.border&&(e+=" border"),this.props.disabled&&(e+=" disabled"),e}}]),t}(c.Component))},1098:function(e,t,n){"use strict";n(1099),n(1100);var r=n(1101);n.d(t,"createExpandModeCodec",(function(){return r.a}))},1099:function(e,t){},1100:function(e,t){},1101:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),o=n(1059),a=n(1079),i=Object(r.a)({},a.b,(function(){return new a.a})),s=function(e){var t=Object(o.b)(e),n=i[t];if(!n)throw new Error("ExpandModeCodec with version ".concat(t," not supported"));return n()}},1102:function(e,t){},1103:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(e){return"pending"===e.status},o=function(e){return"transcribed"===e.status},a=function(e,t){if(t){var n=e.subtitles.get(t);return n&&o(n)}return e.subtitles.some(o)}},1105:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=(n(1164),function(e){var t=e.width,n=e.height,o=e.x,a=e.y,i=o-(t=isNaN(t)?0:t)/2,s=a-(n=isNaN(n)?0:n)/2;i=Math.max(i,0),s=Math.max(s,0);var c={width:t,height:n,left:i=Math.min(i,e.maxWidth-t)||0,top:s=Math.min(s,e.maxHeight-n)||0};return r.createElement("div",{className:"sc-zoom-pointer"+(e.isExpanded?" expanded":""),style:c})})},1106:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return v}));var r,o,a,i=n(5),s=n(11),c=n(30),p=n(28),l=n(29),u=n(87),d=n(88),h=n.n(d),m=n(48),f=n(4),y=function(){var e=new m.EventEmitter;return{emitTrackEvent:function(t){return e.emit("cuechange",t)},subscribeToTrack:function(t){return e.on("cuechange",t),function(){return e.off("cuechange",t)}}}},v=(a=o=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._track=null,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return f.createElement("track",{ref:this._onTrackRef,kind:"metadata",srcLang:this.props.srcLang,default:this.props.default,src:this.props.url})}},{key:"_onCueChange",value:function(e){this.props.onCueChange&&this.props.onCueChange(e)}},{key:"_onTrackRef",value:function(e){this._track&&this._track.removeEventListener("cuechange",this._onCueChange),this._track=e,this._track&&this._track.addEventListener("cuechange",this._onCueChange)}}]),t}(f.PureComponent),o.defaultProps={kind:"captions",default:!0},r=a,Object(u.a)(r.prototype,"_onCueChange",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onCueChange"),r.prototype),Object(u.a)(r.prototype,"_onTrackRef",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onTrackRef"),r.prototype),r)},1111:function(e,t,n){"use strict";n(1093);var r,o,a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(88),d=n.n(u),h=n(4),m=n.n(h),f=n(130),y=(n(1170),function(e){return h.createElement("div",{className:"cc-toggle-button ".concat(e.showCC?"":"disabled"),onClick:e.onCCToggle,title:"Toggle captions"})}),v=n(1112),b=n(3),g=(n(1172),n(131)),O=n(1064),C=(r={},Object(b.a)(r,O.a.x025,"0.2x"),Object(b.a)(r,O.a.x050,"0.5x"),Object(b.a)(r,O.a.x075,"0.7x"),Object(b.a)(r,O.a.x100,"1x"),Object(b.a)(r,O.a.x125,"1.2x"),Object(b.a)(r,O.a.x150,"1.5x"),Object(b.a)(r,O.a.x200,"2x"),r),k=Object.values(O.a),j=(o=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={visible:!1},n._keyboardActionHandlers={"video.speedUp":n._changePlaybackRate(1),"video.speedDown":n._changePlaybackRate(-1)},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return h.createElement("div",{className:"playback-rate-button"+(this.props.hidden?" hidden":"")},h.createElement(g.Hotkeys,{handlers:this._keyboardActionHandlers}),h.createElement("ul",{className:"list"+(this.state.visible?" visible":"")},k.map((function(t){return h.createElement("li",{onClick:function(){return e.props.onPlaybackRateChange(t)},key:t},C[t])}))),h.createElement("span",{className:"open",onClick:this._open},C[this.props.playbackRate]))}},{key:"_open",value:function(){var e=this;this.state.visible||this.setState({visible:!0},(function(){return document.addEventListener("click",e._close)}))}},{key:"_close",value:function(){var e=this;this.state.visible&&this.setState({visible:!1},(function(){return document.removeEventListener("click",e._close)}))}},{key:"_changePlaybackRate",value:function(e){var t=this;return function(){var n=k.findIndex((function(e){return parseFloat(e)===parseFloat(t.props.playbackRate)})),r=Math.max(0,Math.min(n+e,k.length-1)),o=k[r];o&&t.props.onPlaybackRateChange(o)}}}]),t}(h.PureComponent),Object(l.a)(o.prototype,"_open",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_open"),o.prototype),Object(l.a)(o.prototype,"_close",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_close"),o.prototype),Object(l.a)(o.prototype,"_changePlaybackRate",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_changePlaybackRate"),o.prototype),o);n(1173);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var _,S=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-next-icon",points:"35.7090909 0 35.7090909 13.2781818 15.3054545 0 15.3054545 9.96 0 0 0 26.8781818 15.3054545 16.9145455 15.3054545 26.8781818 35.7090909 13.5981818 35.7090909 26.8781818 40 26.8781818 40 0"})),D=m.a.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3341.000000, -1182.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Next",transform:"translate(0.000000, 392.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(0.000000, 6.000000)"},m.a.createElement("mask",{id:"mask-next-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-next-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-next-icon"}),m.a.createElement("g",{mask:"url(#mask-next-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(0.000000, -6.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),P=function(e){var t=e.svgRef,n=e.title,r=E(e,["svgRef","title"]);return m.a.createElement("svg",w({viewBox:"0 0 40 27",ref:t},r),n?m.a.createElement("title",null,n):null,S,D)},T=m.a.forwardRef((function(e,t){return m.a.createElement(P,w({svgRef:t},e))})),R=(n.p,_=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return h.createElement("div",{className:this.className,onClick:this.props.onClick},h.createElement(T,null))}},{key:"className",get:function(){var e="prev-next-button";switch(this.props.type){case"next":e+=" next";break;case"prev":e+=" prev"}return this.props.disabled&&(e+=" disabled"),this.props.hidden&&(e+=" hidden"),e}}]),t}(h.PureComponent),Object(l.a)(_.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(_.prototype,"onClick"),_.prototype),_);n(1174);function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function M(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var N,V,A,I,U=m.a.createElement("defs",null),L=m.a.createElement("path",{fill:"#fff",d:"M28.37,27.09,19,27.5a27,27,0,1,1,6.61,27.16A4,4,0,0,0,20,60.31a35,35,0,1,0,.07-49.5,36.35,36.35,0,0,0-9.43,16.47,1.37,1.37,0,0,0-.07.49l-7.71.35a2.93,2.93,0,0,0-2,.84,2.7,2.7,0,0,0-.71,1.13A3.06,3.06,0,0,0,1,33.35L14.27,45.53a3,3,0,0,0,4.24-.14L30.69,32.11a3.16,3.16,0,0,0,.5-3.32A3,3,0,0,0,28.37,27.09Z"}),F=function(e){var t=e.svgRef,n=e.title,r=M(e,["svgRef","title"]);return m.a.createElement("svg",x({id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 79.51 70.7",ref:t},r),n?m.a.createElement("title",null,n):null,U,L)},z=m.a.forwardRef((function(e,t){return m.a.createElement(F,x({svgRef:t},e))})),B=(n.p,N=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return h.createElement("div",{className:"repeat-button","data-time":this.props.predefinedTime,onClick:this.props.onClick},h.createElement(z,null))}}]),t}(h.PureComponent),Object(l.a)(N.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(N.prototype,"onClick"),N.prototype),N),W=(n(1175),V=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e)))._track=void 0,n._trackRect={left:0,width:0},n._docMouseMove=void 0,n._docMouseUp=void 0,n.state={tooltipVisible:!1,tooltipTimestamp:0,tipHold:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._onMouseMove(),this._onTipRelease()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp)}},{key:"onProgressClick",value:function(e){var t=e.clientX;if(this._track&&isFinite(this.props.duration)){var n=this._track.getBoundingClientRect(),r=n.left,o=n.width,a=t-r;this._onSeek(this.props.duration*(a/o))}}},{key:"onMouseEnter",value:function(e){var t=e.clientX;this._trackRect=this._getTrackRect(),this.setState({tooltipVisible:!0,tooltipTimestamp:this._calculateTooltipTimestamp(t)})}},{key:"onMouseLeave",value:function(){this.state.tipHold||this.setState({tooltipVisible:!1})}},{key:"onTipHold",value:function(){this.setState({tipHold:!0}),this._trackRect=this._getTrackRect(),document.body.style.cursor="grabbing"}},{key:"render",value:function(){var e=this;return h.createElement("div",{className:"video-progress-bar"},h.createElement("div",{className:"tooltip"+(this.state.tooltipVisible?" visible":""),style:{left:this._durationPerc(this.state.tooltipTimestamp)}},Object(f.d)(this.state.tooltipTimestamp)),h.createElement("div",{className:"track-cont"},h.createElement("div",{className:"track",ref:function(t){return e._track=t},onClick:this.onProgressClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},h.createElement("div",{style:{width:this._durationPerc(this.props.currentTime)},className:"progress"},h.createElement("div",{className:"tip"+(this.state.tipHold?" hold":""),onMouseDown:this.onTipHold})))))}},{key:"_durationPerc",value:function(e){return e/this.props.duration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._track){var t=this._track.clientWidth,n=this._trackRect.left,r=Math.max(e-n,0)/t;return Math.round(this.props.duration*r*1e3)/1e3}return 0}},{key:"_onMouseMove",value:function(){var e=this;document.addEventListener("mousemove",this._docMouseMove=function(t){var n=t.clientX;if(e.state.tipHold){var r=e._trackRect,o=(n-r.left)/r.width,a=e.props.duration*o;0<=a&&a<=e.props.duration&&(e.props.onDrag(),e._onSeek(a))}e.state.tooltipVisible&&e.setState({tooltipTimestamp:e._calculateTooltipTimestamp(n)})})}},{key:"_onTipRelease",value:function(){var e=this;document.addEventListener("mouseup",this._docMouseUp=function(){e.setState({tipHold:!1,tooltipVisible:!1}),document.body.style.cursor="default",e.props.onRelease()})}},{key:"_getTrackRect",value:function(){if(this._track){var e=this._track.getBoundingClientRect();return{left:e.left,width:e.width}}return{left:0,width:0}}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}}]),t}(h.PureComponent),Object(l.a)(V.prototype,"onProgressClick",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onProgressClick"),V.prototype),Object(l.a)(V.prototype,"onMouseEnter",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onMouseEnter"),V.prototype),Object(l.a)(V.prototype,"onMouseLeave",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onMouseLeave"),V.prototype),Object(l.a)(V.prototype,"onTipHold",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onTipHold"),V.prototype),V),H=(n(1176),A=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o))))._draggingWhilePlaying=void 0,n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onPlay",value:function(){this.props.disableAll||this.props.onPlay()}},{key:"onPause",value:function(){this.props.disableAll||this.props.onPause()}},{key:"onPredefinedBackward",value:function(){this.props.onSeek(Math.max(this.props.currentTime-15,0))}},{key:"onBackward",value:function(){this.props.backwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onBackward()}},{key:"onForward",value:function(){this.props.forwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onForward()}},{key:"onProgressDrag",value:function(){this.props.playing&&(this._draggingWhilePlaying=!0,this.props.onPause())}},{key:"onProgressRelease",value:function(){this._draggingWhilePlaying&&(this._draggingWhilePlaying=!1,this.props.onPlay())}},{key:"render",value:function(){return h.createElement("div",{className:this.className},h.createElement(W,{currentTime:this.props.currentTime,duration:this.props.duration,onSeek:this.props.onSeek,onDrag:this.onProgressDrag,onRelease:this.onProgressRelease,disabled:this.props.disableAll}),h.createElement("div",{className:"buttons"},h.createElement("nav",{className:"video-nav"},h.createElement(v.a,{playing:this.props.playing,onClick:this.props.playing?this.onPause:this.onPlay}),h.createElement(R,{type:"prev",disabled:this.props.backwardDisabled,hidden:this.props.navigationHidden,onClick:this.onBackward}),h.createElement(B,{predefinedTime:15,onClick:this.onPredefinedBackward}),h.createElement(R,{type:"next",disabled:this.props.forwardDisabled,hidden:this.props.navigationHidden,onClick:this.onForward}),h.createElement("div",{className:"label"},Object(f.d)(this.props.currentTime)+" / "+Object(f.d)(this.props.duration))),h.createElement("div",{className:"video-settings"},(this.props.onCCToggle,h.createElement(y,{showCC:this.props.showCC,onCCToggle:this.props.onCCToggle})),h.createElement(j,{playbackRate:this.props.playbackRate,onPlaybackRateChange:this.props.onPlaybackRateChange}))))}},{key:"className",get:function(){var e="video-controls "+(this.props.className||"")+(this.props.disableAll?" disabled":"");switch(this.props.theme){case"dark":e+=" dark-theme"}return e}}]),t}(h.PureComponent),Object(l.a)(A.prototype,"onPlay",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPlay"),A.prototype),Object(l.a)(A.prototype,"onPause",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPause"),A.prototype),Object(l.a)(A.prototype,"onPredefinedBackward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPredefinedBackward"),A.prototype),Object(l.a)(A.prototype,"onBackward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onBackward"),A.prototype),Object(l.a)(A.prototype,"onForward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onForward"),A.prototype),Object(l.a)(A.prototype,"onProgressDrag",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onProgressDrag"),A.prototype),Object(l.a)(A.prototype,"onProgressRelease",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onProgressRelease"),A.prototype),A),K=n(48),Y=n(2),G=n(0),J=Symbol("PlayerPlaying"),Z=Symbol("PlayerTimeUpdated"),q=Symbol("PlayerCompleted"),X=(I=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(a.a)(this,e),this._dispatch=t,this._props=n,this._hooks=r,this._emitter=new K.EventEmitter,this._interval=void 0,this._player=void 0}return Object(i.a)(e,[{key:"destroy",value:function(){this._dispatch(new Y.lb),this.clearInterval()}},{key:"setRefs",value:function(e){e&&(this._player=e)}},{key:"updateProps",value:function(e){this._props=e}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearInterval(this._interval)}))},{key:"onPlayerPlaying",value:function(e){this._emitter.addListener(J,e)}},{key:"onPlayerTimeUpdated",value:function(e){this._emitter.addListener(Z,e)}},{key:"onPlayerCompleted",value:function(e){this._emitter.addListener(q,e)}},{key:"onPause",value:function(){this._player&&(clearInterval(this._interval),this._emitter.emit(J,!1),this._player.pause())}},{key:"onPlay",value:function(){var e=this;if(this._player){clearInterval(this._interval),this._interval=setInterval(this._emitPlayerTimeAndPauses,50);var t=this._player.play();t?t.then(this._onSuccessfulPlay).catch((function(){e._emitter.emit(J,!1)})):this._onSuccessfulPlay()}}},{key:"onPlaybackRateChange",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"onSeek",value:function(e){this._player&&(this._emitter.emit(Z,e),this._player.setCurrentTime(e))}},{key:"onForward",value:function(){this.nextChapter&&this._selectChapter(this.nextChapter)}},{key:"onBackward",value:function(){this.prevChapter&&this._selectChapter(this.prevChapter)}},{key:"_selectChapter",value:function(e){this._dispatch(new Y.vb(e)),this._emitter.emit(Z,0)}},{key:"_onSuccessfulPlay",value:function(){this._emitter.emit(J,!0),this._hooks.onPlay&&this._hooks.onPlay()}},{key:"_emitPlayerTimeAndPauses",value:function(){this._player&&(this._emitter.emit(Z,this._player.currentTime),this._player.currentTime===this._player.duration&&this._player.canPlay?(this.onPause(),this._emitter.emit(q)):this._player.playing||this.onPause())}},{key:"chapters",get:function(){return this._props.course.chapters.filter((function(e){if(!e)return!1;var t=!(e instanceof G.g)||e.paid;return!!e.videoUrl||!t})).toList()}},{key:"nextChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter),n=t+1;return-1===t||n>=e.size?null:e.get(n)}},{key:"prevChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter)-1;if(!(t<0))return e.get(t)}},{key:"hasNextChapter",get:function(){return!!this.nextChapter}},{key:"hasPrevChapter",get:function(){return!!this.prevChapter}}]),e}(),Object(l.a)(I.prototype,"onPause",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPause"),I.prototype),Object(l.a)(I.prototype,"onPlay",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPlay"),I.prototype),Object(l.a)(I.prototype,"onPlaybackRateChange",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPlaybackRateChange"),I.prototype),Object(l.a)(I.prototype,"onSeek",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onSeek"),I.prototype),Object(l.a)(I.prototype,"onForward",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onForward"),I.prototype),Object(l.a)(I.prototype,"onBackward",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onBackward"),I.prototype),Object(l.a)(I.prototype,"_onSuccessfulPlay",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"_onSuccessfulPlay"),I.prototype),Object(l.a)(I.prototype,"_emitPlayerTimeAndPauses",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"_emitPlayerTimeAndPauses"),I.prototype),I);n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return X}))},1112:function(e,t,n){"use strict";var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(87),p=n(88),l=n.n(p),u=n(1050),d=n.n(u),h=n(4),m=n.n(h),f=(n(1171),n(131));function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=m.a.createElement("desc",null,"Created with Sketch."),g=m.a.createElement("defs",null,m.a.createElement("path",{d:"M23.7696833,0 L33.3864253,0 L33.3864253,40 L23.7696833,40 L23.7696833,0 Z M0,0 L9.61674208,0 L9.61674208,40 L0,40 L0,0 Z",id:"path-pause-icon"})),O=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3667.000000, -1105.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Pause",transform:"translate(323.000000, 321.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(3.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-pause-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-pause-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-pause-icon"}),m.a.createElement("g",{mask:"url(#mask-pause-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),C=function(e){var t=e.svgRef,n=e.title,r=v(e,["svgRef","title"]);return m.a.createElement("svg",y({viewBox:"0 0 34 40",ref:t},r),n?m.a.createElement("title",null,n):null,b,g,O)},k=m.a.forwardRef((function(e,t){return m.a.createElement(C,y({svgRef:t},e))}));n.p;function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var E,_=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-play-icon",points:"0 0 0 40 30.7275192 20"})),S=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3596.000000, -1103.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Play",transform:"translate(250.000000, 319.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(5.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-play-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-play-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-play-icon"}),m.a.createElement("g",{mask:"url(#mask-play-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-5.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),D=function(e){var t=e.svgRef,n=e.title,r=w(e,["svgRef","title"]);return m.a.createElement("svg",j({viewBox:"0 0 31 40",ref:t},r),n?m.a.createElement("title",null,n):null,_,S)},P=m.a.forwardRef((function(e,t){return m.a.createElement(D,j({svgRef:t},e))}));n.p;n.d(t,"a",(function(){return T}));var T=(E=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._keyboardActionHandlers={"video.togglePlay":n._onClick},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return h.createElement("div",{className:d()("play-pause-button",this.props.disabled&&"disabled",this.props.playing?" pause-btn":" play-btn"),onClick:this._onClick},h.createElement(f.Hotkeys,{handlers:this._keyboardActionHandlers}),this.props.playing?h.createElement(k,null):h.createElement(P,null))}},{key:"_onClick",value:function(){this.props.disabled||this.props.onClick()}}]),t}(h.PureComponent),Object(c.a)(E.prototype,"_onClick",[l.a],Object.getOwnPropertyDescriptor(E.prototype,"_onClick"),E.prototype),E)},1113:function(e,t,n){"use strict";var r,o,a,i,s=n(5),c=n(11),p=n(30),l=n(28),u=n(289),d=n(29),h=n(87),m=n(88),f=n.n(m),y=n(208),v=n.n(y),b=n(2),g=n(0),O=n(105),C=n(290),k=n(1074),j=n(1051),w=(n(1181),n(40)),E=n(4),_=(n(1182),[{width:800,height:600},{width:1024,height:768},{width:1280,height:960},{width:1400,height:1050},{width:1600,height:1200}]),S=[{width:800,height:600},{width:1024,height:768},{width:1280,height:960}],D=function(e,t){return e.width*e.height-t.width*t.height},P=(r=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(l.a)(t).call(this,e)))._responseTimeout=void 0,n.state={updatingResolution:!1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.state.updatingResolution&&!this._resolutionEquals(e.vm)&&(clearTimeout(this._responseTimeout),this.setState({updatingResolution:!1}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this._responseTimeout)}},{key:"increaseResolution",value:function(){this.isMaxRes||this._changeResolution(1)}},{key:"decreaseResolution",value:function(){this.isMinRes||this._changeResolution(-1)}},{key:"render",value:function(){return E.createElement("div",{className:"screen-controls"},E.createElement("div",{className:"resolution"+(this.disabled?" disabled":"")},E.createElement("span",{className:"btn"+(this.isMinRes?" disabled":""),onClick:this.decreaseResolution},"-"),this.state.updatingResolution?E.createElement(j.a,null):E.createElement("span",null,this.props.vm.width," x ",this.props.vm.height),E.createElement("span",{className:"btn"+(this.isMaxRes?" disabled":""),onClick:this.increaseResolution},"+")))}},{key:"_changeResolution",value:function(e){var t=this,n=this.props,r=n.dispatch,o=n.asyncActions,a=n.vm;this.setState({updatingResolution:!0}),this._responseTimeout=setTimeout((function(){return t.setState({updatingResolution:!1})}),3e4);var i=this._getNeighborResolution(e);r(o.changeVMResolution(a,i)).catch((function(){clearTimeout(t._responseTimeout),t.setState({updatingResolution:!1})}))}},{key:"_resolutionEquals",value:function(e){return t=this.props.vm,n=e,t.width===n.width&&t.height===n.height;var t,n}},{key:"_getNeighborResolution",value:function(e){var t=this,n=this.resolutions.map((function(e,t){return[e,t]})).find((function(e){var n=Object(w.a)(e,1)[0];return t._resolutionEquals(n)}));if(n){var r=Object(w.a)(n,2)[1];return this.resolutions[r+e]}var o=this.props.vm,a=this.resolutions.map((function(e){return{difference:D(e,o),resolution:e}})).filter((function(t){return e>0?t.difference>0:t.difference<0})).sort((function(t,n){return e>0?n.difference-t.difference:t.difference-n.difference})).pop();return a?a.resolution:{width:o.width,height:o.height}}},{key:"resolutions",get:function(){switch(this.props.template.os){case g.K.Win:return _;case g.K.Linux:default:return S}}},{key:"isMaxRes",get:function(){var e=this.resolutions[this.resolutions.length-1];return this._resolutionEquals(e)||D(e,this.props.vm)<0}},{key:"isMinRes",get:function(){var e=this.resolutions[0];return this._resolutionEquals(e)||D(e,this.props.vm)>0}},{key:"disabled",get:function(){return this.state.updatingResolution||this.props.disabled}}]),t}(E.Component),Object(h.a)(r.prototype,"increaseResolution",[f.a],Object.getOwnPropertyDescriptor(r.prototype,"increaseResolution"),r.prototype),Object(h.a)(r.prototype,"decreaseResolution",[f.a],Object.getOwnPropertyDescriptor(r.prototype,"decreaseResolution"),r.prototype),r),T=n(1105),R=n(292),x=n(298),M=n(209),N=n(15),V=n(131);n.d(t,"a",(function(){return A}));var A=(i=a=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(p.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).wrapper=void 0,n.body=void 0,n.displayScale=1,n.client=void 0,n.state={loading:!n.props.vmAccessLimitReached,zoomPointerCenter:{x:0,y:0},filter:void 0},n._controlsBound=!1,n._mouseenter=!1,n._modifierHandler=void 0,n._mouseMoveLock=void 0,n._disconnectHandler=void 0,n._connectHandler=void 0,n._reconnectionTimeout=void 0,n._screenshotCanvas=document.createElement("canvas"),n._moveZoomPointerCenter=Object(k.b)(Object(u.a)(n)).moveCenter,n._handlers={"cloudDesktop.loseFocus":n._lockFor1Second},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._modifierHandler=function(t){return t.keyCode!==C.i&&t.keyCode!==C.h&&t.keyCode!==C.l||!e._controlsBound||(console.log("prevent default",t.keyCode),t.preventDefault(),!1)}),!this.props.readOnly&&this.props.onReadWriteInit&&this.props.onReadWriteInit(),this._initClient(this.props)}},{key:"componentWillReceiveProps",value:function(e){if(e.cursorPosition){var t=e.cursorPosition,n=this.props.vm.width/this.props.width,r=t.x/n,o=t.y/n;this._setCursorPosition({x:r,y:o})}e.vm.connection.connectionId!==this.props.vm.connection.connectionId&&e.vm.state===g.jb.Ready&&this._initClient(e)}},{key:"componentDidUpdate",value:function(e){this.props.cameraStream===e.cameraStream&&this.props.width===e.width&&this.props.height===e.height||this._handleCamera(),e.readOnly!==this.props.readOnly&&(this.props.readOnly?this._unbindControls():this._bindControls());var t=!Object(O.b)(e.vm.state)&&Object(O.b)(this.props.vm.state),n=!Object(O.c)(e.vm.state)&&Object(O.c)(this.props.vm.state);!t&&!n||this.props.vmAccessLimitReached||(this._removeScreenContent(),this._destroyCurrentClient(),this.setState({loading:!0}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._modifierHandler),this._destroyCurrentClient()}},{key:"mousemove",value:function(e){var t=this;this.props.showViewbox&&this._moveZoomPointerCenter(e),!this._mouseMoveLock&&this.props.emitCursor&&(setTimeout((function(){return t._mouseMoveLock=!1}),this.props.mouseMoveLockInterval),this.props.dispatch(new b.U(e.x,e.y)),this._mouseMoveLock=!0)}},{key:"isScreenActive",value:function(){return this._controlsBound}},{key:"getBodyRef",value:function(e){e&&(this.body=e)}},{key:"takeScreenshot",value:function(){if(!this.body)return null;var e=null;if(this.isBroadcastingCamera){var t=this.body.getElementsByTagName("video")[0];if(t)this._screenshotCanvas.width=this.props.width,this._screenshotCanvas.height=this.props.height,this._screenshotCanvas.getContext("2d").drawImage(t,0,0,this.props.width,this.props.height),e=this._screenshotCanvas.toDataURL("image/png")}else{var n=Object(x.a)().getRemoteClient(this.props.vm.id);n&&(e=n.toDataURL("image/png",1,this.props.width,this.props.height,!1))}var r=null;return e&&(r=new Blob([M.a.toArrayBuffer(e)],{type:"image/png"})),r}},{key:"onMouseEnter",value:function(){this._mouseenter=!0,this._controlsBound||this.state.loading||(this.props.onScreenFocus&&this.props.onScreenFocus(),this._bindControls()),this.setState({filter:this._keyboardShortcutFilter})}},{key:"onMouseLeave",value:function(){this._mouseenter=!1,this.props.onScreenBlur&&this.props.onScreenBlur(),this._unbindControls(),this.setState({filter:void 0})}},{key:"render",value:function(){var e=this,t="sc-screen",n=this.props.showViewbox&&!this.props.readOnly;this.isScreenActive()||(t+=" sc-screen-no-cursor"),this.state.loading&&(t+=" loading");var r=Object.assign({},this.props.style,{width:this.props.width,height:this.props.height}),o=this.props.vm.id&&this.props.vm.state===g.jb.Ready,a=this.state.loading||n||this.props.vmAccessLimitReached?"sc-screen-overlay":"";this.state.loading&&o?a+=" loading":o&&!this.props.vmAccessLimitReached||(a+=" pending");var i="screen-wrapper";this.props.readOnly&&(i+=" read-only");var s=o&&n&&this.props.viewboxSize?this._renderViewbox():null;return E.createElement(V.Hotkeys,{handlers:this._handlers,filter:this.state.filter},E.createElement(E.Fragment,null,E.createElement("div",{className:i,style:r,ref:function(t){return e.wrapper=t},onClick:this.props.onClick},E.createElement("div",{className:a},this.isVmStarting&&[E.createElement(j.a,{key:"loader"}),E.createElement("p",{key:"loader-title"},"Starting your cloud desktop"),E.createElement("p",{key:"loader-sub-title"},"Please wait!")],this.props.vmAccessLimitReached?E.createElement("p",{key:"loader-title"},"You will no longer be assigned a cloud desktop"):Object(O.c)(this.props.vm.state)?E.createElement("p",{key:"loader-title"},"Your cloud desktop has been terminated"):null),E.createElement("div",{ref:this.getBodyRef,className:t}),s),this.showControls&&E.createElement(P,{asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,disabled:this.state.loading,vm:this.props.vm,template:this.props.template})))}},{key:"_renderViewbox",value:function(){return E.createElement(T.a,Object.assign({isExpanded:this.props.isViewExpanded||!1,maxWidth:this.props.width,maxHeight:this.props.height},this.zoomPointerDimensions,this.state.zoomPointerCenter))}},{key:"_bindControls",value:function(){this.client?this.props.readOnly||(this._bindMouseHandler(),this.client.unlockMouse(),this.isBroadcastingCamera||(this._bindKeyboardHandler(),this.client.unlockKeyboard()),this._controlsBound=!0,this.setState({filter:this._keyboardShortcutFilter})):console.error("Failed to set control of client input")}},{key:"_unbindControls",value:function(){this.client?(this._unbindMouseHandler(),this._unbindKeyboardHandler(),this.client.lockMouse(),this.client.lockKeyboard(),this._controlsBound=!1,this.setState({filter:void 0})):console.error("Failed to unset control of client input")}},{key:"_setCursorPosition",value:function(e){if(this.client){var t=this.client.getDisplay();if(t){t.moveCursor(e.x,e.y);var n=t.getCursorLayer().getElement(),r=this.props.cursorScale;t.getCursorLayer().distort(r,0,0,r,0,0),n.style.transformOrigin="0 0"}}}},{key:"_destroyCurrentClient",value:function(){this._unbindControls(),this.client&&(this.client.off(R.b,this._disconnectHandler),this.client.off(R.a,this._connectHandler),this.client.disconnect(),this.client=null)}},{key:"_initClient",value:function(e){var t=this;if(e.vm){this.client&&this._destroyCurrentClient();var n=e.vm.connection;if(n.connectionId){var r=Object(x.a)();this.client=r.createRemoteClient(e.vm.id,n),this.client.on(R.a,this._connectHandler=function(){t.props.dispatch(new b.b(e.vm.connection)),e.onConnect&&e.onConnect(t.client),t._attachScreen(t.client),t._handleCamera(),t.setState({loading:!1},(function(){!t._controlsBound&&t._mouseenter?t._bindControls():t._unbindControls()}))}),this.client.on(R.b,this._disconnectHandler=function(){console.log("DISCONNECTED event fired"),e.onDisconnect&&e.onDisconnect(),t.setState({loading:!0}),t._unbindControls(),clearTimeout(t._reconnectionTimeout),t._reconnectionTimeout=setTimeout((function(){t.client&&t.client.reconnect()}),N.a.RemoteMachineReconnectionTimeout)}),this.client.connected()?console.log("Client already connected"):(this.client&&this.client.connect(),this.setState({loading:!0}))}}else console.error("No cloud desktop data")}},{key:"_attachScreen",value:function(e){if(this.body&&this.wrapper){for(var t=this.body,n=Array.prototype.slice.call(t.children);n.length;){var r=n.pop();r.parentNode.removeChild(r)}this.wrapper.onmouseenter=this.onMouseEnter,this.wrapper.onmouseleave=this.onMouseLeave;var o=e.getDisplay();if(o){var a=this.props.width/this.props.vm.width;o.scale(a),this.displayScale=o.getScale(),o.onresize=this._updateResolution;var i=o.getWidth(),s=o.getHeight();this._updateResolution(i,s);var c=o.getElement();this._removeScreenContent(),t.appendChild(c)}}else console.error("Failed to obtain reference of body and/or wrapper")}},{key:"_handleCamera",value:function(){if(this.body)if(this.isBroadcastingCamera){var e=this.body.getElementsByTagName("video")[0],t=e?e.parentElement:null;e&&t&&t.removeChild(e);var n=this._createVideoElement(),r=n?this.body.getElementsByTagName("canvas")[0]:null,o=r?r.parentElement:null;o&&n&&(n.width=this.props.width,n.height=this.props.height,o.appendChild(n)),this.client&&this.client.lockKeyboard()}else{var a=this.body.getElementsByTagName("video")[0],i=a?a.parentElement:null;i&&a&&i.removeChild(a)}}},{key:"_createVideoElement",value:function(){if(!this.props.cameraStream)return null;var e=document.createElement("video");return e.autoplay=!0,e.srcObject=this.props.cameraStream,e}},{key:"_bindKeyboardHandler",value:function(){this.client?(this.client.on(R.d,this._onKeyDown),this.client.on(R.e,this._onKeyUp),console.log("Bind keyboard handler")):console.error("Failed to bind keyboard handler to null remote client")}},{key:"_unbindKeyboardHandler",value:function(){this.client?(this.client.off(R.d,this._onKeyDown),this.client.off(R.e,this._onKeyUp),console.log("Unbind keyboard handler")):console.warn("Failed to unbind keyboard handler from a null remote client")}},{key:"_bindMouseHandler",value:function(){this.client?(this.client.on(R.f,this._mouseHandler),this.client.on(R.h,this._mouseHandler),this.client.on(R.g,this._mouseHandler)):console.error("Failed to bind mouse handler to null remote client")}},{key:"_unbindMouseHandler",value:function(){this.client?(this.client.off(R.f,this._mouseHandler),this.client.off(R.h,this._mouseHandler),this.client.off(R.g,this._mouseHandler)):console.warn("Failed to unbind mouse handler from a null remote client")}},{key:"_updateResolution",value:function(e,t){this.props.vm.id&&this.props.dispatch(new b.Qb(this.props.vm.id,e,t))}},{key:"_keyboardShortcutFilter",value:function(e,t,n){return this._mouseenter&&"ctrl ctrl"!==n&&"ctrl"!==n}},{key:"_onKeyDown",value:function(e){if(this.props.onKeyDown&&this.props.onKeyDown(e),(this.props.disableKeys||[]).indexOf(e)>=0)console.log("Key is disabled",e);else if(this.client){var t=this.client.getKeyboard();(t.modifiers.ctrl||t.modifiers.meta)&&t.modifiers.shift&&65505===e?console.log("HOTKEY detected (keydown)"):!t.modifiers.alt||65289!==e&&96!==e?this.client.sendKeyEvent(1,e):console.log("SWITCH TAB combination (keydown)")}else console.error("Failed to send key down over null client",e)}},{key:"_onKeyUp",value:function(e){if(this.props.onKeyUp&&this.props.onKeyUp(e),(this.props.disableKeys||[]).indexOf(e)>=0)console.log("Key is disabled",e);else if(this.client){var t=this.client.getKeyboard();(t.modifiers.ctrl||t.modifiers.meta)&&t.modifiers.shift&&65505===e?console.log("HOTKEY detected (keyup)"):!t.modifiers.alt||65289!==e&&96!==e?this.client.sendKeyEvent(0,e):console.log("SWITCH TAB combination (keyup)")}else console.error("Failed to send key up over null client",e)}},{key:"_mouseHandler",value:function(e){if(this.props.onMouseEvent&&this.props.onMouseEvent(e),this.props.mouseDisabled)console.log("Mouse is disabled. Skip send mouse event");else if(this.client){var t={x:1,y:1};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);this.isBroadcastingCamera&&(t.left=0,t.right=0,t.middle=0);var r=this.client.getDisplay().getScale()||1,o=r,a=r;this.props.scaleRatio&&(o=this.props.scaleRatio.scaleX,a=this.props.scaleRatio.scaleY),this.client.scaleX=o,this.client.scaleY=a,t.x/=o,t.y/=a,this.mousemove(t),t.x>this.props.width||t.y>this.props.height||t.x<0||t.y<0||this.client.sendMouseState(t)}else console.error("Failed to send mouse state over null client")}},{key:"_lockFor1Second",value:function(){var e=this;this._mouseenter&&(this._unbindControls(),setTimeout((function(){e._mouseenter&&e._bindControls()}),1e3))}},{key:"_removeScreenContent",value:function(){if(this.body)for(var e=0;e<this.body.children.length;e+=1)this.body.removeChild(this.body.children[e])}},{key:"isBroadcastingCamera",get:function(){return!!this.props.cameraStream}},{key:"isVmStarting",get:function(){return!this.props.vmAccessLimitReached&&(Object(O.a)(this.props.vm.state)||Object(O.b)(this.props.vm.state))}},{key:"showControls",get:function(){return!this.props.vmAccessLimitReached&&!Object(O.c)(this.props.vm.state)&&!this.isBroadcastingCamera&&this.props.controls&&this.props.asyncActions&&this.props.template&&(this.props.template.defaultTemplate||this.props.template.createdAt.getTime()>new Date(2018,8,1).getTime())}},{key:"zoomPointerDimensions",get:function(){if(!this.props.viewboxSize)return{width:0,height:0};var e=this.props.width/this.props.viewboxSize.width,t=this.props.height/this.props.viewboxSize.height;return{width:this.props.vm.width/e,height:this.props.vm.height/t}}}]),t}(E.Component),a.defaultProps={disableKeys:[],mouseMoveLockInterval:100,onScreenBlur:v.a,onScreenFocus:v.a,cursorScale:1,mouseDisabled:!1},o=i,Object(h.a)(o.prototype,"getBodyRef",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"getBodyRef"),o.prototype),Object(h.a)(o.prototype,"onMouseEnter",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseEnter"),o.prototype),Object(h.a)(o.prototype,"onMouseLeave",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseLeave"),o.prototype),Object(h.a)(o.prototype,"_updateResolution",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_updateResolution"),o.prototype),Object(h.a)(o.prototype,"_keyboardShortcutFilter",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_keyboardShortcutFilter"),o.prototype),Object(h.a)(o.prototype,"_onKeyDown",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyDown"),o.prototype),Object(h.a)(o.prototype,"_onKeyUp",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyUp"),o.prototype),Object(h.a)(o.prototype,"_mouseHandler",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_mouseHandler"),o.prototype),Object(h.a)(o.prototype,"_lockFor1Second",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_lockFor1Second"),o.prototype),o)},1114:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props;return c.createElement("li",{"data-value":e.value,"data-disabled":e.disabled,"data-selected":e.selected,"data-highlighted":e.highlighted,"data-deleted":e.deleted,"data-text":e.text},e.children)}}]),t}(c.Component)},1115:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=n(88),d=n.n(u),h=n(1045),m=n(288),f=(n(1047),n(1316),r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={isDeleting:!1},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"delete",value:function(e){var t=this;e.preventDefault(),this.setState({isDeleting:!0}),this.props.onDelete().finally((function(){return t.setState({isDeleting:!1})}))}},{key:"render",value:function(){return l.createElement("div",{className:"delete-confirmation-modal form-styles"},l.createElement(m.a,{title:this.props.title,visible:this.props.visible,onToggle:this.props.onClose},this.props.messages.map((function(e,t){return l.createElement("p",{className:"text",key:t},e)})),l.createElement("div",{className:"row"},l.createElement(h.a,{className:"short-btn",onClick:this.props.onClose,disabled:this.state.isDeleting},"No, keep it"),l.createElement(h.a,{className:"short-btn empty",onClick:this.delete,loading:this.state.isDeleting},"Yes"))))}}]),t}(l.Component),Object(p.a)(r.prototype,"delete",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"delete"),r.prototype),r)},1118:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=n(88),d=n.n(u),h=n(1084),m=n(288),f=(r=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"cancel",value:function(){this.props.onToggle(!1)}},{key:"resolveAndExit",value:function(){var e=this;this.props.onResolve().then((function(){return e.props.onToggle(!1)}))}},{key:"render",value:function(){return l.createElement(m.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},l.createElement("div",{className:"leave-modal form-styles"},l.createElement("p",{className:"text"},this.props.text?"".concat(this.props.text," "):null,"Are you sure you want to leave?"),l.createElement("div",null,l.createElement(h.a,{onClick:this.cancel,className:"short-btn stay-btn"},"No")),l.createElement("div",null,l.createElement(h.a,{onClick:this.resolveAndExit,className:"short-btn empty leave-btn"},"Leave"))))}}]),t}(l.PureComponent),Object(p.a)(r.prototype,"cancel",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"cancel"),r.prototype),Object(p.a)(r.prototype,"resolveAndExit",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"resolveAndExit"),r.prototype),r)},1119:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(88),u=n.n(l),d=n(4),h=n(1061),m=n(1088),f=function(e){return parseInt(e.replace("px","")||"0",10)},y=(r=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._splitter=void 0,n._leftCont=void 0,n._initialLayoutPerformed=!1,n._resizeObserver=void 0,n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentWillUnmount",value:function(){this._leftCont&&this._resizeObserver.unobserve(this._leftCont)}},{key:"onLeftContRef",value:function(e){e&&e instanceof Element&&(this._leftCont=e,this._resizeObserver=new h.a(this.adjustLayout),this._resizeObserver.observe(e))}},{key:"adjustLayout",value:function(){if(this._leftCont){var e=window.getComputedStyle(this._leftCont),t=f(e.width||"")-this._horizontalPadding,n=f(e.height||"")-this._verticalPadding,r=t/n,o=this._screenWidth/this._screenHeight,a=0,i=0;r<o?i=(a=Math.max(t,400*o))/o:a=(i=Math.max(n,400))*o;var s=a/this._screenWidth;this.setState({width:a,height:i,scaleX:s,scaleY:s}),this._initialLayoutPerformed||(this._initialLayoutPerformed=!0)}}},{key:"_horizontalPadding",get:function(){return 35}},{key:"_verticalPadding",get:function(){return 35}},{key:"rightPanelSize",get:function(){if(this._initialLayoutPerformed)return 0;var e=window.document.body,t=e.clientWidth,n=e.clientHeight;if(t-m.b<m.a)return t-m.a;var r=Math.max(n,400)*(this._screenWidth/this._screenHeight)-70+10;return Math.max(m.b,t-r)}}]),t}(d.PureComponent),Object(p.a)(r.prototype,"onLeftContRef",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"onLeftContRef"),r.prototype),Object(p.a)(r.prototype,"adjustLayout",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"adjustLayout"),r.prototype),r)},1120:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(20),o=n.n(r),a=n(40),i=n(45),s=n(95),c=n(295),p=n(214),l=n(210),u=function(e){return new Promise((function(t,n){return e.onstatechange=function(e){switch(e){case s.a.Connected:return t();case s.a.Disconnecting:case s.a.Disconnected:return n(new Error("Client could not connect. State ".concat(e)))}}}))},d=function(e){return new Promise((function(t){return e.onfilesystem=function(e,n){return t(new c.a(e,n))}}))},h=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,i,s,c,h,m,f,y=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.length>1&&void 0!==y[1]?y[1]:0,r=y.length>2&&void 0!==y[2]?y[2]:0,e.next=4,Object(p.a)(t);case 4:return i=e.sent,s=new l.WebSocketTunnel(Object(p.b)(t,i,n,r)),(c=new l.Client(s)).connect(),e.next=10,Promise.all([u(c),d(c)]);case 10:return h=e.sent,m=Object(a.a)(h,2),f=m[1],e.abrupt("return",{client:c,tunnel:s,token:i,filesystem:f});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1129:function(e,t,n){"use strict";var r,o,a,i=n(3),s=n(49),c=n(119),p=n(5),l=n(11),u=n(30),d=n(28),h=n(29),m=n(87),f=n(4),y=n(88),v=n.n(y),b=n(9),g=n(1474),O=n(2),C=n(0),k=n(166),j=n(1076),w=n(290),E=n(1077),_=n(1154),S=n(1045),D=n(1115),P=(n(1047),n(1317),r={},Object(i.a)(r,C.s.Instruction,"Normal instruction task that learner will watch and follow along"),Object(i.a)(r,C.s.ChallengeSelfApproval,"Learners can self-approve the challenge solution"),Object(i.a)(r,C.s.ChallengePeerApproval,"Peers (other learners) can approve the challenge solution"),Object(i.a)(r,C.s.ChallengeHostApproval,"Only hosts can approve the challenge solution"),r),T=(o=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isExpanded:!e.chapter.id||!e.chapter.videoUrl,deleteConfirmationModalVisible:!1,isPreparingToRecord:!1},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.props.onExpand(e.props.chapter.key,e.state.isExpanded)}))}},{key:"toggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.isExpanded;this.setState({isExpanded:t},(function(){e.props.onExpand(e.props.chapter.key,t)}))}},{key:"updateChapter",value:function(e,t){var n=t.target.value,r=this.props.chapter.set(e,n);this.props.onChange(r)}},{key:"onTypeChange",value:function(e){this.updateChapter("type",{target:{value:e}})}},{key:"onFocus",value:function(e,t){this.toggle(!0),this.props.onFocus&&this.props.onFocus(e,t)}},{key:"onBlur",value:function(e,t){this.props.onBlur&&this.props.onBlur(e,t)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({deleteConfirmationModalVisible:!this.state.deleteConfirmationModalVisible})}},{key:"onConfirmDeletion",value:function(){return this.props.onDeleteChapter()}},{key:"record",value:function(e){var t=this;e.preventDefault(),this.setState({isPreparingToRecord:!0}),this.props.onRecord().finally((function(){return t.setState({isPreparingToRecord:!1})}))}},{key:"preview",value:function(e){e.preventDefault(),this.props.onPreview()}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"chapter-details form-styles"+this.className,"data-name":this.props.chapter.name},f.createElement(_.a,{expanded:this.state.isExpanded,expandHeader:this.renderExpandHeader(),collapseHeader:this.renderCollapseHeader(),onToggle:this.toggle,errored:!!this.props.errors||!this.isRecorded,errorMessage:this.isRecorded?"":"This task has not been recorded yet"},f.createElement("div",{className:"row"},f.createElement(S.x,{className:"chapter-type",value:this.props.chapter.type,label:"".concat(this.props.label," Type"),onChange:this.onTypeChange,onFocus:function(t){return e.onFocus(t,"type")},onBlur:function(t){return e.onBlur(t,"type")}},f.createElement(S.n,{value:C.s.Instruction},"Instruction"),f.createElement(S.n,{value:C.s.ChallengeSelfApproval},"Challenge: Self approval"),f.createElement(S.n,{value:C.s.ChallengePeerApproval,disabled:!0},"Challenge: Peer approval"),f.createElement(S.n,{value:C.s.ChallengeHostApproval,disabled:!0},"Challenge: Host approval")),f.createElement("p",{className:"field-info"},P[this.props.chapter.type])),f.createElement(S.k,{className:"chapter-name",value:this.props.chapter.name,label:"".concat(this.props.label," Name"),error:this.props.errors?this.props.errors.name:void 0,disabled:this.props.disabled,onChange:function(t){return e.updateChapter("name",t)},onFocus:function(t){return e.onFocus(t,"name")},onBlur:function(t){return e.onBlur(t,"name")},onKeyDown:this._handleEnter}),f.createElement("div",{className:"row"},f.createElement(S.y,{className:"chapter-description",value:this.props.chapter.description,label:"".concat(this.props.label," Description"),error:this.props.errors?this.props.errors.description:void 0,disabled:this.props.disabled,onChange:function(t){return e.updateChapter("description",t)},onFocus:function(t){return e.onFocus(t,"description")},onBlur:function(t){return e.onBlur(t,"description")}}),f.createElement("div",{className:"field-info"},f.createElement("div",null,this.props.chapter.type===C.s.Instruction?"Make your recording's landing page more descriptive. ":"Help learners better understand the challenge. ",f.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),f.createElement("div",{className:"row"},f.createElement("div",{className:"form-actions"+(this.props.chapter.videoUrl?"":" record")},this.props.chapter.videoUrl?f.createElement(f.Fragment,null,f.createElement("div",{className:"duration","data-duration":Math.floor(this.props.chapter.duration/1e3)},"Duration: ",Object(E.a)(this.props.chapter.duration)," mins"),f.createElement("div",{className:"buttons"},f.createElement(S.a,{className:"empty small purple preview-btn",onClick:this.preview,disabled:this.state.isPreparingToRecord,type:"button"},"Preview"),f.createElement(S.a,{className:"empty small purple rerecord-btn",onClick:this.record,loading:this.state.isPreparingToRecord,type:"button"},"Re-Record"))):f.createElement(S.a,{className:"small record-btn",onClick:this.record,disabled:!this.props.valid,loading:this.state.isPreparingToRecord,type:"button"},"Record")),f.createElement("p",{className:"field-info delete"},f.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete "+this.props.label)))),f.createElement(D.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Task",messages:[this.deleteMessage],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}))}},{key:"renderCollapseHeader",value:function(){return f.createElement("div",{className:"collapse-header"},this.props.label?f.createElement("div",{className:"label"},this.props.label,Object(j.f)(this.props.chapter)?f.createElement("i",{className:"fa fa-trophy"}):null):null,f.createElement("div",{className:"name"},this.props.chapter.name))}},{key:"renderExpandHeader",value:function(){return f.createElement("div",{className:"expand-header"},this.props.chapter.id?"Edit":"Add"," ",this.props.label)}},{key:"_handleEnter",value:function(e){e.keyCode===w.f&&(e.stopPropagation(),this.record(e))}},{key:"className",get:function(){var e="";return this.props.className&&(e+=" ".concat(this.props.className)),this.props.errors&&(e+=" error"),e}},{key:"deleteMessage",get:function(){var e="Are you sure you want to delete ";return this.props.chapter.name?"".concat(e,' task "').concat(this.props.chapter.name,'"?'):"".concat(e," ").concat(this.props.label,"?")}},{key:"isRecorded",get:function(){return this.props.chapter.videoUrl}}]),t}(f.Component),Object(m.a)(o.prototype,"toggle",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"toggle"),o.prototype),Object(m.a)(o.prototype,"updateChapter",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"updateChapter"),o.prototype),Object(m.a)(o.prototype,"onTypeChange",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onTypeChange"),o.prototype),Object(m.a)(o.prototype,"onFocus",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onFocus"),o.prototype),Object(m.a)(o.prototype,"onBlur",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onBlur"),o.prototype),Object(m.a)(o.prototype,"toggleDeleteConfirmationModal",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"toggleDeleteConfirmationModal"),o.prototype),Object(m.a)(o.prototype,"onConfirmDeletion",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onConfirmDeletion"),o.prototype),Object(m.a)(o.prototype,"record",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"record"),o.prototype),Object(m.a)(o.prototype,"preview",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"preview"),o.prototype),Object(m.a)(o.prototype,"_handleEnter",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"_handleEnter"),o.prototype),o),R=n(1086),x=n(1084);n(1318);n.d(t,"a",(function(){return V}));var M,N;!function(e){e.Instruction="Instruction",e.Challenge="Challenge"}(M||(M={})),function(e){e.Record="record",e.Preview="preview",e.Add="add",e.Delete="delete"}(N||(N={}));var V=(a=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e)))._chapterDetailsRefs=[],n._dragTimeout=void 0,n._initialValue=void 0,n._initialValue=e.input.value;var r=[];return e.input.value.forEach((function(e){r.push({name:{active:!1,dirty:!1},description:{active:!1,dirty:!1},type:{active:!1,dirty:!1}})})),n.state={componentsFieldsState:Object(b.List)(r),expandedItems:Object(b.Map)([[]])},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"showValidation",value:function(){var e=this,t=this.state.componentsFieldsState.map((function(e){return e.name.dirty=!0,e.description.dirty=!0,e.type.dirty=!0,e}));this.setState({componentsFieldsState:Object(b.List)(t)},(function(){var t=[];e._chapterDetailsRefs.forEach((function(e){e&&e.props.errors&&(e.setState({isExpanded:!0}),t.push(e.props.chapter.key))})),e.onChapterItemExpand(t,!0)}))}},{key:"onChapterChange",value:function(e,t){var n=this.chapters.get(t);if(e.videoUrl&&e.type!==n.type&&(e.type===C.s.Instruction||n.type===C.s.Instruction)){var r=n.type===C.s.Instruction?M.Instruction:M.Challenge,o=e.type===C.s.Instruction?M.Instruction:M.Challenge;this.props.actionDispatch(new O.i(new C.I({type:C.J.Info,title:"Re-record task?",text:'You just changed your task from type "'.concat(r,'" to type "').concat(o,'". In that case, you may want to re-record the task')})))}var a=this.chapters.set(t,e);this.props.input.onChange(a)}},{key:"onFocus",value:function(e,t,n){this._updateComponentActiveFields(n,t,!0)}},{key:"onBlur",value:function(e,t,n){this._updateComponentActiveFields(n,t,!1),this.props.input.onBlur(this.chapters)}},{key:"onAddChapter",value:function(e){if(e.preventDefault(),this._validateAction(N.Add)){var t=this.chapters.count()?this.chapters.last().order+1:1,n=this.chapters.sort((function(e,t){return t.key-e.key})).first(),r=n?n.key+1:0,o=this.chapters.push(new C.q({order:t,key:r}));this.props.input.onChange(o);var a=this.state.componentsFieldsState.push({name:{active:!1,dirty:!1},description:{active:!1,dirty:!1},type:{active:!1,dirty:!1}});this.setState({componentsFieldsState:a})}}},{key:"deleteChapter",value:function(e){var t=this;if(!this._validateAction(N.Delete))return Promise.reject("Deleting a task is not allowed");var n=this.chapters.get(e);return 1===this.chapters.filter((function(e){return!!e.videoUrl})).count()&&n.videoUrl&&Object(R.d)(this.props.course,this.props.rooms)?(this.props.actionDispatch(new O.i(new C.I({type:C.J.Error,title:"Used in session",text:"You cannot delete the last recorded task because this recording is used in a session"}))),Promise.reject("Cannot delete last recorded task")):n.id?this.props.actionDispatch(this.props.asyncActions.deleteChapter(this.props.course,n)).then((function(){return t._deleteChapter(e)})):(this._deleteChapter(e),Promise.resolve())}},{key:"onRecordOrPreview",value:function(e,t){var n=this,r=e===N.Record;if(r&&!Object(k.b)(window.navigator.userAgent))return this.props.onRecordUnsupported(),Promise.reject("Recording is not supported on this browser");var o=this.chapters.get(t);if(r){if(!this.template||this.template.state===C.ab.Deleted)return this.props.actionDispatch(new O.i(new C.I({type:C.J.Error,title:"Deleted cloud desktop",text:"The cloud desktop used for this recording has been deleted. Please use a different cloud desktop"}))),Promise.reject("Cloud desktop is deleted");if(this.template.state!==C.ab.Ready)return this.props.actionDispatch(new O.i(new C.I({type:C.J.Info,title:"Your cloud desktop is on the way",text:"Please wait a few minutes or record the task later"}))),Promise.reject("Cloud desktop is not ready")}return this._preserveChapterBeforeRecord(o).then((function(r){var o=n.chapters.set(t,r);if(n.props.input.onChange(o.map((function(e,t){return e.set("key",t)}))),e===N.Record){if(!n._validateAction(e))return;n.props.onRecordChapter(r)}else n.props.onPreviewChapter(r)}))}},{key:"onChapterItemDragStart",value:function(){var e=this,t=arguments[5];this._dragTimeout=setTimeout((function(){e._chapterDetailsRefs.forEach((function(e){return e.toggle(!1)})),t.style.transform="rotate(1deg)";var n=t.querySelector(".expandable-container");n&&(n.style.borderColor="#4a4a4a")}),300)}},{key:"onChapterItemDragStop",value:function(){var e=arguments[5];e.style.transform="",e.style.border="";var t=e.querySelector(".expandable-container");t&&(t.style.borderColor=""),clearTimeout(this._dragTimeout)}},{key:"onChapterItemExpand",value:function(e,t){var n=this.state.expandedItems.withMutations((function(n){var r=n;e.forEach((function(e){return r=r.set(e.toString(),t)}))}));this.setState({expandedItems:n})}},{key:"onGridLayoutChange",value:function(e){var t={};e.forEach((function(e){return t[e.i]=e.y}));var n=this.chapters.sort((function(e,n){return t[e.key]-t[n.key]})).map((function(e,t){return e.set("order",t+1)}));this.props.input.onChange(n)}},{key:"generateGridLayout",value:function(){var e=this;return this.chapters.map((function(t,n){return{i:t.key.toString(),x:1,y:n,w:1,h:e._isChapterExpanded(t)?5.75:1}})).toArray()}},{key:"render",value:function(){var e=this;this._chapterDetailsRefs=[];var t=this.props,n=t.input,r=t.meta,o=Object(c.a)(t,["input","meta"]),a=r.error?JSON.parse(r.error):[],i=n.value;return f.createElement("div",{className:"redux-form-chapters-list"},f.createElement("div",{className:"fill-items"},i.map((function(t,n){return f.createElement("div",{className:"f-item",key:"fi-"+n,style:{height:e._isChapterExpanded(t)?406:50}})}))),f.createElement(g,{className:"grid-layout",draggableHandle:".cdi-handle",layout:this.generateGridLayout(),cols:1,width:520,rowHeight:50,margin:[0,25],isResizable:!1,useCSSTransforms:!1,onDragStart:this.onChapterItemDragStart,onDragStop:this.onChapterItemDragStop,onLayoutChange:this.onGridLayoutChange},i.map((function(t,n){var i=a[n],s=e.state.componentsFieldsState.get(n),c=!i||0===Object.keys(i).length,p=r.error?e._getComponentErrors(i,s):null;return f.createElement("div",{key:t.key},f.createElement("div",{className:"cdi-handle"}),f.createElement(T,Object.assign({ref:function(t){t&&e._chapterDetailsRefs.push(t)},label:"Task ".concat(n+1),chapter:t,errors:p,valid:c,onChange:function(t){return e.onChapterChange(t,n)},onFocus:function(t,r){return e.onFocus(t,r,n)},onBlur:function(t,r){return e.onBlur(t,r,n)},onDeleteChapter:function(){return e.deleteChapter(n)},onRecord:function(){return e.onRecordOrPreview(N.Record,n)},onPreview:function(){return e.onRecordOrPreview(N.Preview,n)},onExpand:function(t,n){return e.onChapterItemExpand([t],n)}},o)))}))),f.createElement("div",{className:"row"},f.createElement(x.a,{className:"empty purple-empty-hover small add-button",onClick:this.onAddChapter,type:"button"},"Add Task ",i.count()+1),f.createElement("p",{className:"field-info"},"Recommended duration 5-7 mins")))}},{key:"_updateComponentActiveFields",value:function(e,t,n){var r=this.state.componentsFieldsState.get(e),o=n,a=!(r[t].dirty||!r[t].active||n),c=this.state.componentsFieldsState.set(e,Object(s.a)({},r,Object(i.a)({},t,{active:o,dirty:a})));this.setState({componentsFieldsState:c})}},{key:"_getComponentErrors",value:function(e,t){var n=!t.name.active&&t.name.dirty&&!!e.name,r=!t.description.active&&t.description.dirty&&!!e.description;return n||r?{name:n?e.name:void 0,description:r?e.description:void 0}:null}},{key:"_deleteChapter",value:function(e){var t=this.chapters.delete(e);this.props.input.onChange(t);var n=this.state.componentsFieldsState.delete(e);this.setState({componentsFieldsState:n})}},{key:"_validateAction",value:function(e,t){var n;if((e===N.Add||e===N.Delete||e===N.Record)&&(Object(R.c)(this.props.course,this.props.rooms)?n="already running":Object(R.b)(this.props.course,this.props.rooms)&&(n="about to start"),n))return this.props.actionDispatch(new O.i(new C.I({type:C.J.Error,title:"Running session",text:"You cannot ".concat(e," a task because this recording is used in a session that is ").concat(n)}))),!1;return!0}},{key:"_preserveChapterBeforeRecord",value:function(e){if(e.id){var t=this._initialValue.find((function(t){return t.id===e.id}));return t&&(e=e.set("order",t.order)),this.props.actionDispatch(this.props.asyncActions.updateChapter(this.props.course,e.id,e))}return this.props.actionDispatch(this.props.asyncActions.createChapter(this.props.course,e))}},{key:"_isChapterExpanded",value:function(e){return this.state.expandedItems.get(e.key.toString())}},{key:"chapters",get:function(){return this.props.input.value}},{key:"template",get:function(){return this.props.templates.get(this.props.course.templateId)}}]),t}(f.Component),Object(m.a)(a.prototype,"onChapterChange",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterChange"),a.prototype),Object(m.a)(a.prototype,"onFocus",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onFocus"),a.prototype),Object(m.a)(a.prototype,"onBlur",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onBlur"),a.prototype),Object(m.a)(a.prototype,"onAddChapter",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onAddChapter"),a.prototype),Object(m.a)(a.prototype,"deleteChapter",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"deleteChapter"),a.prototype),Object(m.a)(a.prototype,"onRecordOrPreview",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onRecordOrPreview"),a.prototype),Object(m.a)(a.prototype,"onChapterItemDragStart",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemDragStart"),a.prototype),Object(m.a)(a.prototype,"onChapterItemDragStop",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemDragStop"),a.prototype),Object(m.a)(a.prototype,"onChapterItemExpand",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemExpand"),a.prototype),Object(m.a)(a.prototype,"onGridLayoutChange",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onGridLayoutChange"),a.prototype),a)},1130:function(e,t,n){"use strict";var r,o=n(20),a=n.n(o),i=n(45),s=n(5),c=n(11),p=n(30),l=n(28),u=n(29),d=n(87),h=n(88),m=n.n(h),f=n(208),y=n.n(f),v=n(4),b=n(2),g=n(48),O=n(1120),C=n(120),k=function(){function e(t,n,r,o,a,i){Object(s.a)(this,e),this._guac=t,this._tunnelUUID=n,this._authToken=r,this._protocol=o,this._host=a,this._file=i,this._emitter=new g.EventEmitter,this._stream=void 0,this._xhr=void 0}return Object(c.a)(e,[{key:"start",value:function(){var e=this;this._stream=this._guac.createFileStream("application/zip",this._file.name),this._stream.onack=function(){e._uploadFile(),e._stream.onack=void 0}}},{key:"onProgress",value:function(e){this._emitter.on(C.a.Progress,e)}},{key:"onCompleted",value:function(e){this._emitter.on(C.a.Completed,e)}},{key:"onError",value:function(e){this._emitter.on(C.a.Error,e)}},{key:"destroy",value:function(){this._emitter.off(C.a.Error),this._emitter.off(C.a.Completed),this._emitter.off(C.a.Progress),this._cancel()}},{key:"_uploadFile",value:function(){var e=this,t=this._protocol+"://"+this._host+"/api/session/tunnels/"+this._tunnelUUID+"/streams/"+encodeURIComponent(this._stream.index)+"/"+encodeURIComponent(Object(C.d)(this._file.name))+"?token="+encodeURIComponent(this._authToken),n=new XMLHttpRequest;n.withCredentials=!0,this._xhr=n,n.upload&&n.upload.addEventListener("progress",(function(t){e._emitter.emit(C.a.Progress,{current:t.loaded,total:e._file.size})})),n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?(e._guac.endStream(e._stream.index),e._emitter.emit(C.a.Completed)):"application/json"===n.getResponseHeader("Content-Type")?e._emitter.emit(C.a.Error,n.responseText):n.status>=400&&n.status<500?e._emitter.emit(C.a.Error,"Stream error"):e._emitter.emit(C.a.Error,"HTTP "+n.status))},n.open("POST",t,!0),n.setRequestHeader("content-type","application/zip"),n.send(this._file)}},{key:"_cancel",value:function(){this._xhr&&this._xhr.abort()}}]),e}(),j=function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var o,i,s,c,p,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.a)(t);case 2:return o=e.sent,i=o.client,s=o.tunnel,c=o.token,(p=new k(i,s.uuid,c,t.protocol,t.host,n)).onProgress(r||y.a),p.start(),l=new Promise((function(e,t){p.onCompleted((function(){i.disconnect(),e()})),p.onError((function(e){i.disconnect(),t(new Error(e))}))})),e.abrupt("return",{promise:l,abort:function(){return p.destroy()}});case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),w=n(0),E=n(1137);n.d(t,"a",(function(){return _}));var _=(r=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(p.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={files:[],currentFile:0,currentProgress:0,inProgress:!1,done:!1,abortUpload:y.a},n._fileUploader=void 0,n._onUploadError=function(){n.props.dispatch(new b.i(new w.I({type:w.J.Error,ttl:1e4,title:"Error",text:'Something went wrong while uploading your files. Please, try again. If the issue persists, you can try [ufile.io](https://ufile.io){target="_blank"}'}))),n.props.onError&&n.props.onError()},n._trackUploadProgress=function(e){var t=new Array(e).fill(0);return function(e){return function(r){t[e]=r.current/r.total;var o=t.reduce((function(e,t){return e+t}))/t.length;n.setState({currentProgress:o}),n.props.onProgress&&n.props.onProgress(r)}}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return v.createElement(E.a,{ref:function(t){return e._fileUploader=t},currentFile:this.state.currentFile,currentProgress:this.state.currentProgress,uploadIcon:this.props.uploadIcon,done:this.state.done,files:this.state.files,label:this.props.label,disabled:this.props.disabled,dispatch:this.props.dispatch,filters:{maxSize:104857600,minSize:1},onCancel:this._cancel,onFiles:this._onFiles})}},{key:"_onFiles",value:function(e){var t=this;this.props.onUploadStart&&this.props.onUploadStart(),this.setState({files:this.state.files.concat(e)},(function(){t.state.inProgress||t._nextFile()})),console.log("Uploading %d files",e.length)}},{key:"_nextFile",value:function(){var e=this,t=this.state.currentFile;if(t<this.state.files.length){var n=function(){return e._uploadFile(e.state.files[t]).then((function(){setTimeout((function(){return e._nextFile()}),1e3)}))};this.state.done?this.setState({done:!1},n):n()}else this.setState({done:!0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted(),this.props.dispatch(new b.i(new w.I({type:w.J.General,title:"Files uploaded",text:"Your files were successfully uploaded"})))}},{key:"_uploadFile",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,o,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({currentProgress:0,inProgress:!0,currentFile:this.state.currentFile+1}),e.prev=1,e.next=4,"function"===typeof this.props.vms?this.props.vms():this.props.vms;case 4:return n=e.sent,r=this._trackUploadProgress(n.length),e.next=8,Promise.all(n.map((function(e,n){return j(e.connection,t,r(n))})));case 8:return o=e.sent,i=o.reduce((function(e,t){var n=t.promise;return e.then((function(){return n}))}),Promise.resolve()),s=function(){return o.forEach((function(e){return e.abort()}))},this.setState({inProgress:!1,abortUpload:s}),e.next=14,i;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this._onUploadError();case 19:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_cancel",value:function(){this.state.abortUpload(),this.setState({files:[],inProgress:!1,currentFile:0,currentProgress:0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted()}}]),t}(v.PureComponent),Object(d.a)(r.prototype,"_onFiles",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"_onFiles"),r.prototype),Object(d.a)(r.prototype,"_cancel",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"_cancel"),r.prototype),r)},1131:function(e,t,n){"use strict";var r,o,a,i=n(40),s=n(5),c=n(11),p=n(30),l=n(28),u=n(29),d=n(87),h=n(3),m=n(4),f=(n(1210),n(88)),y=n.n(f),v=n(2),b=n(15),g=n(0),O=n(130),C=n(1045),k=n(1065),j={incomplete_number:"Your card number is incomplete.",incomplete_expiry:"Your card's expiration date is incomplete.",invalid_number:"The card number is not a valid credit card number.",invalid_expiry_month:"The card's expiration month is invalid.",invalid_expiry_year:"The card's expiration year is invalid.",invalid_cvc:"The card's security code is invalid.",invalid_swipe_data:"The card's swipe data is invalid.",incorrect_number:"The card number is incorrect.",expired_card:"The card has expired.",incorrect_cvc:"The card's security code is incorrect.",incorrect_zip:"The card's zip code failed validation.",card_declined:"The card was declined.",missing:"There is no card on a customer that is being charged.",processing_error:"An error occurred while processing the card."};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return S})),function(e){e[e.CreditCard=0]="CreditCard",e[e.RhymeCard=1]="RhymeCard"}(a||(a={}));var w=function(e){return"99"===e.substr(0,2)?a.RhymeCard:a.CreditCard},E=" ".concat("/"," "),_=(r={},Object(h.a)(r,g.m.Visa,m.createElement("div",{className:"card-icon cc-visa"})),Object(h.a)(r,g.m.MasterCard,m.createElement("div",{className:"card-icon cc-mastercard"})),Object(h.a)(r,g.m.Amex,m.createElement("div",{className:"card-icon cc-amex"})),Object(h.a)(r,g.m.DinersClub,m.createElement("div",{className:"card-icon cc-diners"})),Object(h.a)(r,g.m.Discover,m.createElement("div",{className:"card-icon cc-discover"})),Object(h.a)(r,g.m.JCB,m.createElement("div",{className:"card-icon cc-jcb"})),Object(h.a)(r,g.m.Rhyme,m.createElement("div",{className:"card-icon rhyme-card"})),Object(h.a)(r,g.m.Unknown,null),r),S=(o=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(l.a)(t).call(this,e)))._cardType=a.CreditCard,n._cardMonth=void 0,n._cardYear=void 0,n._startCaretPosCache=0,n._initialCardNumber=void 0,n._initialCardExpiry=void 0,n._removableLeadZero=void 0,n.state={brand:g.m.Unknown,loading:!1,cardNumber:"",cardExpiry:"",cardType:a.CreditCard,validNumber:!1,validExpiry:!1,numberFocus:!1,expiryFocus:!1,numberDirty:!1,expiryDirty:!1},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){Stripe.setPublishableKey(b.a.StripeKey),this.props.onRef&&this.props.onRef(this),this.props.card&&this._setCardFromProps(this.props.card)}},{key:"componentWillReceiveProps",value:function(e){var t=e.card;!t||this._initialCardNumber||this._initialCardExpiry||this._setCardFromProps(t)}},{key:"onCardNumberChange",value:function(e){var t=this._clearIfFromProps(e.target.value),n=this._formatCardNumber(t);this.setState({cardNumber:n});var r=e.target,o=r.selectionStart,s=r.selectionEnd;e.target.value=n,this._updateCaret(4," ".length,e.target,o,s);var c,p=w(n);this.props.onCardTypeChange&&p!==this._cardType&&(this.props.onCardTypeChange(p),this._cardType=p);var l=this.state.cardExpiry.split(E),u=Object(i.a)(l,2),d=u[0],h=u[1],m=Stripe.card.validateExpiry(d,h);switch(m||(c=!0),p){case a.CreditCard:default:this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:Stripe.card.validateCardNumber(n),validExpiry:m,brand:Stripe.card.cardType(n)},this._onUpdate);break;case a.RhymeCard:var f=!Object(k.o)({card:n}).card;this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:f,validExpiry:m,brand:g.m.Rhyme},this._onUpdate)}}},{key:"onCardExpiryChange",value:function(e){var t=e.target.value,n=this._leadingZeroExpiry(t,this._removableLeadZero);if(n){t=n.value,this._removableLeadZero=n.removable;var r=this._formatCardExpiry(t),o=e.target;this.setState({cardExpiry:r});var s=o.selectionStart,c=o.selectionEnd;o.value=r,this._updateCaret(2,E.length+1,o,s,c);var p=r.split(E),l=Object(i.a)(p,2),u=l[0],d=l[1];this._cardMonth=u,this._cardYear=d;var h=this.state.cardNumber,m=w(h)===a.CreditCard?Stripe.card.validateCardNumber(h):Object(k.o)(h);this.setState({expiryDirty:!0,numberDirty:!0,validExpiry:Stripe.card.validateExpiry(this._cardMonth,this._cardYear),validNumber:m},this._onUpdate)}}},{key:"submitInfo",value:function(e){e.preventDefault(),this.submit()}},{key:"submit",value:function(e){switch(w(this.state.cardNumber)){case a.CreditCard:default:this._submitCreditCard(e);break;case a.RhymeCard:this._submitRhymeCard(e)}}},{key:"clear",value:function(){this.setState({brand:g.m.Unknown,cardNumber:"",cardExpiry:""})}},{key:"reset",value:function(){this.props.card?this._setCardFromProps(this.props.card):this.clear()}},{key:"renderCCBrand",value:function(){var e=_[this.state.brand],t=this.props.card,n=this.state.brand===g.m.Rhyme&&this.state.cardNumber.startsWith("**")&&!this.isExpired;return m.createElement(m.Fragment,null,e,t&&t.id&&n?m.createElement("div",{className:"card-amount"},"Balance: $",Object(O.b)(t.amount)):null)}},{key:"numberError",value:function(){var e="";return this.isNumberInvalid?e="Invalid number":this.isExpired&&(e=" "),e}},{key:"expiryError",value:function(){var e="";return this.isExpiryInvalid?e="Invalid expiry":this.isExpired&&(e="Card expired"),e}},{key:"focusNumber",value:function(){this.setState({numberFocus:!0})}},{key:"blurNumber",value:function(){this.setState({numberFocus:!1})}},{key:"focusExpiry",value:function(){this.setState({expiryFocus:!0})}},{key:"blurExpiry",value:function(){this.setState({expiryFocus:!1})}},{key:"render",value:function(){return m.createElement("div",{className:"universal-card-form"},m.createElement("form",{onSubmit:this.submitInfo},m.createElement("div",null,m.createElement(C.k,{type:"text",label:"Card Number",name:"card",autoComplete:"off",onChange:this.onCardNumberChange,onFocus:this.focusNumber,onBlur:this.blurNumber,value:this.state.cardNumber,placeholder:"1234 1234 1234 1234",maxLength:19,ignoreLastPass:!0,error:this.numberError()}),m.createElement(C.k,{type:"text",label:"Card Expiry",name:"expiry",autoComplete:"off",onChange:this.onCardExpiryChange,onFocus:this.focusExpiry,onBlur:this.blurExpiry,value:this.state.cardExpiry,placeholder:"MM / YY",ignoreLastPass:!0,error:this.expiryError()})),!this.props.hideSaveButton&&m.createElement(C.a,{loading:this.state.loading,disabled:!this.isFormValid},"Save")),this.renderCCBrand())}},{key:"_formatCardNumber",value:function(e){return e=e.replace(/[^0-9]/g,""),Object(O.e)(e,4," ")}},{key:"_formatCardExpiry",value:function(e){return 3===(e=e.replace(/[^0-9/]/g,"")).length&&"/"===e[2]?e.substr(0,2)+E:(e=e.replace(/[^0-9]/g,""),Object(O.e)(e,2,E))}},{key:"_submitCreditCard",value:function(e){var t=this;this.setState({loading:!0});var n=this.state.cardNumber.replace(/\s/g,"");Stripe.card.createToken({number:n,exp_month:this._cardMonth,exp_year:this._cardYear},(function(n,r){if(r.error)t.props.dispatch(new v.i(new g.I({type:g.J.Error,text:j[r.error.code]||r.error.message}))),t.props.onStripeError&&t.props.onStripeError(),t.setState({loading:!1});else{var o=t._createCard(r);t.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}}))}},{key:"_submitRhymeCard",value:function(e){var t=this,n=this.state.cardNumber.replace(/\s/g,""),r={last4:n.substring(n.length-4,n.length),exp_month:parseInt(this._cardMonth,10),exp_year:parseInt("20"+this._cardYear,10),brand:g.m.Rhyme},o=this._createCard({id:n,card:r});this.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}},{key:"_updateCaret",value:function(e,t,n,r,o){for(var a=0,i=e+=1;i<r+e;i+=e)r<this._startCaretPosCache&&r===i+t-1?a=-1*t:r===i&&(a=t);this._startCaretPosCache=r,n.setSelectionRange(r+a,o+a)}},{key:"_onUpdate",value:function(e,t){this.props.onUpdate&&this.props.onUpdate({card:this.state.cardNumber,expiry:this.state.cardExpiry,valid:e||this.isFormValid,pristine:t||this.pristine,brand:this.state.brand})}},{key:"_createCard",value:function(e){var t=e.id,n=e.card;return new g.l({customer:t,lastFour:n.last4,brand:n.brand,expiryMonth:n.exp_month,expiryYear:n.exp_year})}},{key:"_setCardFromProps",value:function(e){this._initialCardNumber="**** **** **** ".concat(e.lastFour),this._initialCardExpiry=function(e,t){var n=e.toString();return 1===n.length&&(n="0"+n),n+" / "+t.toString().substr(2,2)}(e.expiryMonth,e.expiryYear),this._cardMonth=e.expiryMonth.toString(),this._cardYear=e.expiryYear.toString().substr(2,2),this.setState({cardNumber:this._initialCardNumber,cardExpiry:this._initialCardExpiry,brand:e.brand,validNumber:!0,validExpiry:!0,numberDirty:!1,expiryDirty:!1})}},{key:"_clearIfFromProps",value:function(e){return-1!==e.indexOf("*")?"":e}},{key:"_leadingZeroExpiry",value:function(e,t){if(e.length>7){if("0"!==e[0]||!t)return null;var n=e.split("");n.shift(),e=n.join("")}else 3===e.length&&"0"!==e[0]&&"/"!==e[2]?(e="0"+e,t=!0):2===e.length&&"/"===e[1]?e="0"+e:e||(t=!1);return{value:e,removable:t}}},{key:"isFormValid",get:function(){return this.state.validNumber&&this.state.validExpiry}},{key:"isNumberInvalid",get:function(){var e=this.state;return e.numberDirty&&!e.numberFocus&&!e.validNumber}},{key:"isExpiryInvalid",get:function(){var e=this.state;return e.expiryDirty&&!e.expiryFocus&&!e.validExpiry}},{key:"isExpired",get:function(){var e=this.props.card;if(e&&this.pristine){var t=new Date(e.expiryYear,e.expiryMonth).getTime();return Date.now()>t}return!1}},{key:"pristine",get:function(){var e=this.state.cardNumber!==this._initialCardNumber,t=this.state.cardExpiry!==this._initialCardExpiry;return!(e||e&&t)}}]),t}(m.Component),Object(d.a)(o.prototype,"onCardNumberChange",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardNumberChange"),o.prototype),Object(d.a)(o.prototype,"onCardExpiryChange",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardExpiryChange"),o.prototype),Object(d.a)(o.prototype,"submitInfo",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"submitInfo"),o.prototype),Object(d.a)(o.prototype,"focusNumber",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"focusNumber"),o.prototype),Object(d.a)(o.prototype,"blurNumber",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"blurNumber"),o.prototype),Object(d.a)(o.prototype,"focusExpiry",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"focusExpiry"),o.prototype),Object(d.a)(o.prototype,"blurExpiry",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"blurExpiry"),o.prototype),o)},1132:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r,o,a=n(3);!function(e){e[e.NA=0]="NA",e[e.Weak=1]="Weak",e[e.Safe=2]="Safe",e[e.Good=3]="Good",e[e.Great=4]="Great"}(o||(o={}));var i=function(e){var t=o.NA;return e.length>20?t=o.Great:e.length>15?t=o.Good:e.length>10?t=o.Safe:6<=e.length&&e.length<=10&&(t=o.Weak),t},s=(r={},Object(a.a)(r,o.NA,""),Object(a.a)(r,o.Weak,"Your password is weak."),Object(a.a)(r,o.Safe,"Your password is safe."),Object(a.a)(r,o.Good,"Your password is good."),Object(a.a)(r,o.Great,"Your password is great."),r)},1133:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(49),a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=(n(1178),n(88)),h=n.n(d),m=(r=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e)))._mouseStart=0,n.state={pulled:!0,pulling:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._onDocumentMouseMove),document.addEventListener("mouseup",this._onDocumentMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._onDocumentMouseMove),document.removeEventListener("mouseup",this._onDocumentMouseUp)}},{key:"onPullerMouseDown",value:function(e){this._mouseStart=e.clientY,this.setState({pulling:!0})}},{key:"render",value:function(){return u.createElement("div",{className:"bottom-bar"+(this.state.pulled?" pulled":"")+(this.props.width&&this.props.width<250?" hidden":""),onMouseDown:function(e){return e.stopPropagation()}},u.createElement("div",{className:"frame"}),u.createElement("div",{className:"container",style:Object(o.a)({},this.props.width?{width:this.props.width+2}:{})},u.createElement("div",{className:"puller"+(this.state.pulling?" pulling":""),onMouseDown:this.onPullerMouseDown}),u.createElement("div",{className:"content"},u.createElement("div",{className:"logo"}),u.createElement("div",{className:"children"+(this.state.pulled?" visible":"")},this.props.children))))}},{key:"_onDocumentMouseMove",value:function(e){if(this.state.pulling){var t=e.clientY-this._mouseStart;t>=30?this.setState({pulled:!1}):t<=-30&&this.setState({pulled:!0})}}},{key:"_onDocumentMouseUp",value:function(e){var t=e.clientY-this._mouseStart===0;this.setState({pulling:!1,pulled:t?!this.state.pulled:this.state.pulled})}}]),t}(u.PureComponent),Object(l.a)(r.prototype,"onPullerMouseDown",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onPullerMouseDown"),r.prototype),Object(l.a)(r.prototype,"_onDocumentMouseMove",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onDocumentMouseMove"),r.prototype),Object(l.a)(r.prototype,"_onDocumentMouseUp",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onDocumentMouseUp"),r.prototype),r)},1134:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=n(94),l=(n(1179),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={keys:[],down:{}},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"onKey",value:function(e){if(e){var t=p.a.fromKeySym(e.keyCode);if(t)if(e.down){var n=this.state,r=n.keys,o=n.down;r.push(t),r.length>50&&r.shift(),o[e.keyCode]=[t,Date.now()],this.setState({keys:r,down:o})}else{var a=this.state.down;a[e.keyCode]&&(delete a[e.keyCode],this.setState({down:a}))}}}},{key:"reset",value:function(){this.setState({keys:[],down:{}})}},{key:"render",value:function(){return c.createElement("div",{className:"caption-player"},c.createElement("div",{className:"caption-wrapper"},this.caption),this.keysDown.length?c.createElement("div",{className:"pinned"},this.keysDown):null,c.createElement("div",{className:"keyboard tooltip rel l","data-tooltip":this.props.tooltip||"The keys being pressed in the task video"}))}},{key:"keysDown",get:function(){var e=Date.now(),t=this.state.down;return Object.keys(t).map((function(e){return t[e]})).filter((function(t){return t[1]<e-500})).map((function(e,t){return c.createElement("span",{key:"pk-"+t},e[0].label)}))}},{key:"caption",get:function(){return this.state.keys.map((function(e,t){return c.createElement("span",{key:"ck-"+t},e.label)}))}}]),t}(c.Component))},1135:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1184),function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={width:100*this.progress+"%",backgroundColor:this.props.color};return c.createElement("div",{className:"progress-bar-wrapper  "+this.props.type+(this.props.className||"")},c.createElement("div",{style:e,className:"progress-bar-progress"}))}},{key:"progress",get:function(){return this.props.progress<1?this.props.progress:1}}]),t}(c.Component));p.defaultProps={type:"regular"}},1136:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1189),n(88)),d=n.n(u),h=n(15),m=n(1091),f=n(1113),y=n(1119),v=n(1088),b=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._overlayCont=void 0,n.state={width:400,height:400,scaleX:1,scaleY:1,detailsInitialSize:370,overlayContHasChildren:!1},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.vm,r=t.controls,o=e.vm,a=e.controls;if((n&&(n&&!o||o&&n.width!==o.width||o&&n.height!==o.height)||r&&!a)&&this.adjustLayout(),this._overlayCont){var i=this._overlayCont.childNodes.length>0;this.setState({overlayContHasChildren:i})}}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.props.onResize&&this.props.onResize(e,t)}},{key:"render",value:function(){var e=this;return l.createElement(v.c,{ref:function(t){return e._splitter=t},onResize:this.onResize,onResizeStart:this.props.onResizeStart,onResizeEnd:this.props.onResizeEnd,onPanelsRefs:this.props.onPanelsRefs,rightPanelInitialSize:this.rightPanelSize,className:"split-screen"+(this.props.className?" "+this.props.className:"")},this.props.vm?l.createElement(l.Fragment,null,l.createElement("div",{className:"balance"}),l.createElement("div",{className:"left-container",ref:this.onLeftContRef},this.props.overlay&&l.createElement("div",{ref:function(t){return e._overlayCont=t},className:"overlay-cont"+(this.state.overlayContHasChildren?" has-children":""),style:{width:this.state.width,height:this.state.height}},this.props.overlay),l.createElement(m.a,{originalWidth:this.props.vm.width,originalHeight:this.props.vm.height,scaledWidth:this.state.width-8},l.createElement(f.a,{onKeyDown:this.props.onEvent,onKeyUp:this.props.onEvent,onMouseEvent:this.props.onEvent,vm:this.props.vm,template:this.props.template,isViewExpanded:this.props.isViewExpanded,showViewbox:this.props.showViewbox,viewboxSize:this.props.viewboxSize,width:this.props.vm.width,height:this.props.vm.height,cursorPosition:this.props.cursorPosition,emitCursor:this.props.emitCursor,scaleRatio:{scaleX:this.state.scaleX,scaleY:this.state.scaleY},onReadWriteInit:this.props.onReadWriteInit,onConnect:this.props.onConnect,onDisconnect:this.props.onDisconnect,readOnly:this.props.readOnly,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,controls:this.props.controls,cameraStream:this.props.cameraStream,vmAccessLimitReached:this.props.vmAccessLimitReached}))),this.props.leftPanelChildren?this.props.leftPanelChildren:l.createElement("div",{className:"balance"})):null,l.createElement(l.Fragment,null,this.props.children))}},{key:"_screenWidth",get:function(){return this.props.vm?this.props.vm.width:h.a.DefaultScreenWidth}},{key:"_screenHeight",get:function(){return this.props.vm?this.props.vm.height:h.a.DefaultScreenHeight}},{key:"_verticalPadding",get:function(){return 75}}]),t}(y.a),Object(p.a)(r.prototype,"onResize",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onResize"),r.prototype),r)},1137:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1190),n(88)),d=n.n(u),h=n(2),m=n(0),f=n(1135),y=n(1138),v={minSize:{msg:function(e){return"the minimal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size<t}},maxSize:{msg:function(e){return"the maximal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size>t}},types:{msg:function(e){return"the allowed file type".concat(1!==e.length?"s":""," ").concat(1!==e.length?"are":"is"," ")+"".concat(e.map((function(e){return e.split("/").pop()})).join(", "))},filter:function(e,t){return-1===t.indexOf(e.type)}}},b=(r=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._uploadArea=void 0,n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"resetUploadArea",value:function(){this._uploadArea&&this._uploadArea.reset()}},{key:"onFiles",value:function(e){if(!this.props.disabled&&e&&e.length){var t,n=[].slice.call(e),r=(t=this.props.dispatch,function(e,n){t(new h.i(new m.I({type:m.J.Error,ttl:1e4,title:e,text:n})))}),o=this.props.fileLimit;if(void 0!==o&&n.length>o)r("File number limit reached","You cannot upload more than ".concat(o," file").concat(1!==o?"s":""));else{var a=this.props.filters;if(a){var i=[];Object.keys(a).forEach((function(e){var t=a[e];if(void 0!==t){var n=v[e],r={filter:function(e){return n.filter(e,t)},msg:n.msg(t)};i.push(r)}}));var s=function(e){return function(t){return e.map((function(e){return e(t)})).reduce((function(e,t){return e||t}))}}(i.map((function(e){return e.filter}))),c=n.filter(s).map((function(e){return i.map((function(t){return t.filter(e)?t.msg:void 0})).filter((function(e){return!!e}))})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t}));if(c.length)return void r("Cannot upload file".concat(1!==n.length?"s":""),"Because "+c.join("; "))}this.props.onFiles(n)}}}},{key:"render",value:function(){var e=this;return l.createElement("div",{className:"file-uploader"+(this.props.disabled?" disabled":"")},l.createElement(y.a,{ref:function(t){return e._uploadArea=t},allowSameFileSelection:!0,uploadIcon:this.props.uploadIcon,onFiles:this.onFiles},this.props.files.length&&!this.props.done?l.createElement("div",null,"File ",this.props.currentFile,"/",this.props.files.length,l.createElement(f.a,{className:this.props.onCancel?"":" full-width",progress:this.props.currentProgress}),this.props.onCancel&&l.createElement("i",{className:"fa fa-times cancel",onClick:this.props.onCancel})):l.createElement("div",null,this.props.done?this.props.filesUploadedLabel||"All files uploaded":this.props.label||"Upload files here")))}}]),t}(l.PureComponent),Object(p.a)(r.prototype,"onFiles",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onFiles"),r.prototype),r)},1138:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1191),n(88)),d=n.n(u),h=function(){},m=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._input=void 0,n.state={dragOver:!1},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"onFilesFromDrop",value:function(e){this.onDragLeave(e),this.props.onFiles(e.dataTransfer.files)}},{key:"onDragOver",value:function(e){e.preventDefault(),this.setState({dragOver:!0})}},{key:"onDragLeave",value:function(e){e.preventDefault(),this.setState({dragOver:!1})}},{key:"onFilesFromInput",value:function(e){this.props.onFiles(e.target.files)}},{key:"reset",value:function(){this._input&&(this._input.value="")}},{key:"render",value:function(){var e=this;return l.createElement("div",{className:"drop-upload-area"+(this.state.dragOver?" active":""),onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onFilesFromDrop},l.createElement("input",{ref:function(t){return e._input=t},className:"area",type:"file",onChange:this.onFilesFromInput,onClick:this.props.allowSameFileSelection?this.reset:h}),this.props.uploadIcon?this.props.uploadIcon:l.createElement("div",{className:"upload-icon"}),l.createElement("span",{className:"ua-content"},this.props.children))}}]),t}(l.Component),Object(p.a)(r.prototype,"onFilesFromDrop",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onFilesFromDrop"),r.prototype),Object(p.a)(r.prototype,"onDragOver",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onDragOver"),r.prototype),Object(p.a)(r.prototype,"onDragLeave",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onDragLeave"),r.prototype),Object(p.a)(r.prototype,"onFilesFromInput",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onFilesFromInput"),r.prototype),Object(p.a)(r.prototype,"reset",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"reset"),r.prototype),r)},1139:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1192),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(a.a)(this,Object(i.a)(t).call(this,e)))._docClickCb=void 0,n._clickFlag=void 0,n._onMouseEnter=function(){n.props.showOnMouseEnter&&n.show()},n._onMouseLeave=function(){n.props.showOnMouseEnter&&n.hide()},n.state={visible:!1},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag||e.hide(),e._clickFlag=!1})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb)}},{key:"show",value:function(){this._clickFlag=!0,this.setState({visible:!0})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){return c.createElement("span",{className:"rhyme-tooltip "+(this.props.className||""),onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},this.state.visible&&c.createElement("span",{className:"rt-content"},this.props.children[0]),this.props.children[1])}}]),t}(c.Component))},1140:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=n(88),d=n.n(u),h=n(1347),m=(n(1195),r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._clipboard=void 0,n._button=void 0,n.state={showTooltip:!1},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._clipboard||(this._clipboard=new h(this._button,{text:function(){return e.props.value}}),this._clipboard.on("success",(function(t){e.setState({showTooltip:!0}),t.clearSelection()})))}},{key:"componentWillUnmount",value:function(){this._clipboard&&(this._clipboard.destroy(),this._clipboard=null)}},{key:"render",value:function(){return l.createElement("div",{ref:this._onButtonRef,className:this.className,onMouseLeave:this._onMouseLeave,"aria-label":"Copied!","data-tooltip":"Copied!"},this.props.children)}},{key:"_onButtonRef",value:function(e){this._button=e}},{key:"_onMouseLeave",value:function(){this.setState({showTooltip:!1})}},{key:"className",get:function(){var e="clipboard";return this.props.className&&(e+=" ".concat(this.props.className)),this.state.showTooltip&&(e+=" tooltip rel r"),this.props.disabled&&(e+=" disabled"),e}}]),t}(l.PureComponent),Object(p.a)(r.prototype,"_onButtonRef",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onButtonRef"),r.prototype),Object(p.a)(r.prototype,"_onMouseLeave",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onMouseLeave"),r.prototype),r)},1151:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),o=n(60),a=n(2),i=(n(1255),function(){var e=Object(o.e)((function(e){return e.backendState.connectivityState})),t=Object(o.d)(),n=r.useCallback((function(){return t(new a.sb("unknown"))}),[t]),i=Object(o.e)((function(e){return e.backendState.offlineModeViews>0}));return"offline"!==e?null:r.createElement("div",{className:"backend-failure"},r.createElement("div",{className:"box"},i&&r.createElement("div",{className:"modal-close"},r.createElement("div",{onClick:n})),r.createElement("h3",null,r.createElement("i",{className:"fa fa-meh-o"})," Oops!"),"There is an issue with our services."," ",i?"Please, retry your last action in a minute.":"Please, visit us later."))})},1152:function(e,t,n){"use strict";function r(e,t,n,r){var o=1;if(n>r&&(o=-1),!t||e[r]===t)return e[n];for(var a=n;o>0?a<r:a>r;a+=o)if(e[a]===t&&e[a+o])return e[a+o];return null}n.d(t,"a",(function(){return r}))},1154:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1315),n(88)),d=n.n(u),h=(r=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"toggle",value:function(){this.props.onToggle(!this.props.expanded)}},{key:"render",value:function(){return l.createElement("div",{className:this.className,"data-error-msg":this.props.errorMessage},l.createElement("div",{className:"header",onClick:this.toggle},l.createElement("div",{className:"expanded"},l.createElement("div",{className:"header-content"},this.props.expandHeader),l.createElement("div",{className:"collapse-icon"})),l.createElement("div",{className:"collapsed"},l.createElement("div",{className:"header-content"},this.props.collapseHeader),l.createElement("div",{className:"expand-icon"}))),l.createElement("div",{className:"cont-content"},this.props.children))}},{key:"className",get:function(){var e="expandable-container";return this.props.expanded&&(e+=" expanded"),this.props.errored&&(e+=" errored"),e}}]),t}(l.Component),Object(p.a)(r.prototype,"toggle",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"toggle"),r.prototype),r)},1155:function(e,t,n){},1156:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=n(88),d=n.n(u),h=n(1078),m=(n(1157),n(1158)),f=n(1159),y=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={backgroundWrapper:void 0},n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return l.createElement(l.Fragment,null,l.createElement("div",{className:"unsupported-recording",ref:this._onWrapperRef},l.createElement("div",{className:"content"},l.createElement("div",{className:"header"},l.createElement("div",{className:"logo"}),this.props.onBack&&l.createElement("h2",null,l.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.props.onBack}))),l.createElement("div",{className:"view"},l.createElement("h1",null,this.props.title),l.createElement("p",{className:"sub-title"},this.props.description),l.createElement("div",{className:"browsers"},l.createElement("a",{href:"https://www.google.com/chrome/browser/desktop/index.html",target:"_blank"},l.createElement("span",{className:"title"},"Chrome"),l.createElement("img",{src:m}),l.createElement("span",{className:"ver"},"59+")),l.createElement("a",{href:"https://www.mozilla.org/en-US/firefox/",target:"_blank"},l.createElement("span",{className:"title"},"Firefox"),l.createElement("img",{src:f}),l.createElement("span",{className:"ver"},"54+"))),this.props.onBack&&l.createElement("a",{href:"javascript:void(0);",className:"go-back",onClick:this.props.onBack},"Go Back"))),l.createElement("div",{className:"header-separator"})),this.state.backgroundWrapper?l.createElement(h.a,{overflow:"hidden",wrapper:this.state.backgroundWrapper}):null)}},{key:"_onWrapperRef",value:function(e){!this.state.backgroundWrapper&&e&&this.setState({backgroundWrapper:e})}}]),t}(l.Component),Object(p.a)(r.prototype,"_onWrapperRef",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onWrapperRef"),r.prototype),r)},1157:function(e,t,n){},1158:function(e,t,n){e.exports=n.p+"static/media/Chrome.f3b6c54c.svg"},1159:function(e,t,n){e.exports=n.p+"static/media/Firefox.e037fac5.svg"},1164:function(e,t,n){},1165:function(e,t,n){},1166:function(e,t,n){},1167:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return y}));var r,o,a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=(n(1168),n(88)),h=n.n(d),m=n(1045),f=n(1051);!function(e){e[e.DisabledCamera=0]="DisabledCamera",e[e.EnabledCamera=1]="EnabledCamera",e[e.BroadcastedCamera=2]="BroadcastedCamera"}(o||(o={}));var y=(r=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e)))._video=void 0,n.state={isLoadingCamera:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.cameraStream!==e.cameraStream&&this._video&&(this._video.srcObject=this.props.cameraStream)}},{key:"onDisabledCameraAction",value:function(){this.setState({isLoadingCamera:!0}),this.props.onDisabledCameraAction()}},{key:"onVideoRef",value:function(e){this._video=e}},{key:"render",value:function(){return u.createElement("div",{className:"webcam-thumb"},u.createElement("div",{className:"thumb"},this.renderThumb()),this.thumbLabel&&u.createElement("div",{className:"label"},this.thumbLabel))}},{key:"renderThumb",value:function(){switch(this.props.view){case o.DisabledCamera:return this.renderDisabledCamera();case o.EnabledCamera:return this.renderCamera();case o.BroadcastedCamera:return this.renderBroadcastedCamera();default:return null}}},{key:"renderDisabledCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty enable-webcam-btn",disabled:this.props.disabled,onClick:this.onDisabledCameraAction},this.props.labels.disabledCameraButton),this.props.error?u.createElement("span",{className:"webcam-error"},this.props.error):u.createElement(u.Fragment,null,u.createElement("span",{className:"description"+(this.props.disabled?" disabled":"")},this.props.labels.disabledCameraDescription),this.props.disabled?u.createElement("span",{className:"disabled-label"},this.props.labels.disabledLabel):null))}},{key:"renderCamera",value:function(){return this.props.cameraStream?u.createElement(u.Fragment,null,u.createElement(f.a,null),u.createElement("video",{ref:this.onVideoRef,autoPlay:!0,onLoadedMetadata:this._onLoadedMetadata}),this.state.isLoadingCamera?null:u.createElement("div",{className:"camera-options"},u.createElement(m.b,{className:"empty broadcast-webcam-btn",disabled:this.props.disabled,onClick:this.props.onEnabledCameraAction},this.props.labels.enabledCameraButton),u.createElement("span",{className:"description"},this.props.labels.enabledCameraDescription))):null}},{key:"renderBroadcastedCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty broadcast-vm-btn",disabled:this.props.disabled,onClick:this.props.onBroadcastedCameraAction},this.props.labels.broadcastedCameraButton),u.createElement("span",{className:"description"},this.props.labels.broadcastedCameraDescription))}},{key:"_onLoadedMetadata",value:function(){this.setState({isLoadingCamera:!1})}},{key:"thumbLabel",get:function(){switch(this.props.view){case o.DisabledCamera:return this.props.labels.disabledCameraLabel;case o.EnabledCamera:return this.props.labels.enabledCameraLabel;case o.BroadcastedCamera:return this.props.labels.broadcastedCameraLabel;default:return""}}}]),t}(u.PureComponent),Object(l.a)(r.prototype,"onDisabledCameraAction",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onDisabledCameraAction"),r.prototype),Object(l.a)(r.prototype,"onVideoRef",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onVideoRef"),r.prototype),Object(l.a)(r.prototype,"_onLoadedMetadata",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onLoadedMetadata"),r.prototype),r)},1168:function(e,t,n){},1169:function(e,t,n){},1170:function(e,t,n){},1171:function(e,t,n){},1172:function(e,t,n){},1173:function(e,t,n){},1174:function(e,t,n){},1175:function(e,t,n){},1176:function(e,t,n){},1177:function(e,t,n){},1178:function(e,t,n){},1179:function(e,t,n){},1180:function(e,t,n){},1181:function(e,t,n){},1182:function(e,t,n){},1183:function(e,t,n){},1184:function(e,t,n){},1185:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=n(1064),l=(n(1186),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(a.a)(this,Object(i.a)(t).call(this,e)))._player=void 0,n.state={input:void 0,expandModeData:void 0,loading:!1},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.chapter,t=e.inputUrl,n=e.expandModeUrl;this._loadData(t,n)}},{key:"componentDidUpdate",value:function(e){this.props.chapter.inputUrl===e.chapter.inputUrl||this.props.chapter.expandModeUrl===e.chapter.expandModeUrl&&this.props.chapter.expandModeUrl||this._loadData(this.props.chapter.inputUrl,this.props.chapter.expandModeUrl)}},{key:"play",value:function(){return this._player?this._player.play():Promise.reject()}},{key:"pause",value:function(){this._player&&this._player.pause()}},{key:"changePlaybackRate",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"toggleViewbox",value:function(){if(this._player)return this._player.toggleViewbox()}},{key:"setCurrentTime",value:function(e){this._player&&this._player.setCurrentTime(e)}},{key:"learnerChangedSidebarMode",value:function(){this._player&&this._player.learnerChangedSidebarMode()}},{key:"takeScreenshot",value:function(){return this._player?this._player.takeScreenshot():null}},{key:"render",value:function(){var e=this;return c.createElement("div",{className:"chapter-player"},this.state.loading?this.renderLoading():null,c.createElement(p.b,{ref:function(t){return e._player=t},mp4:this.props.chapter.cdnMp4Url,webm:this.props.chapter.cdnWebmUrl,src:this.props.chapter.videoUrl,dispatch:this.props.dispatch,onKeyboardFrame:this.props.onKeyboardFrame,onMouseFrame:this.props.onMouseFrame,captionPlayer:this.props.captionPlayer,mouse:this.props.mouse,autoPlay:this.props.autoPlay||!1,input:this.state.input,expandModeData:this.state.expandModeData,controls:this.props.controls,viewboxSize:this.props.viewboxSize,showViewbox:this.props.showViewbox,isViewExpanded:this.props.isViewExpanded,onViewboxToggle:this.props.onViewboxToggle,onCanPlay:this.props.onCanPlay,onReadyMetadata:this.props.onReadyMetadata,className:this.state.loading?"hidden":void 0,annotations:this.props.chapter.annotations,subtitles:this.props.chapter.subtitles,onVideoDimmensions:this.props.onVideoDimmensions,onExpandModeChange:this.props.onExpandModeChange,onCueChange:this.props.onCueChange,errorContainer:this.props.errorContainer}))}},{key:"renderLoading",value:function(){return"Buffering..."}},{key:"_loadData",value:function(e,t){var n=this;this.setState({loading:!0}),Promise.all([this._fetchResource(e),this._fetchResource(t)]).then((function(e){var t=e[0],r=e[1];n.setState({input:t,expandModeData:r,loading:!1})})).catch((function(){return n.setState({loading:!1})}))}},{key:"_fetchResource",value:function(e){return e?new Promise((function(t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=function(e){4===r.readyState&&(200===r.status?t(r.response):n())},r.open("get",e,!0),r.send()})):Promise.resolve(void 0)}},{key:"playing",get:function(){return!!this._player&&this._player.playing}},{key:"playbackRate",get:function(){return this._player?this._player.playbackRate:p.a.x100}},{key:"canPlay",get:function(){return!!this._player&&this._player.canPlay}},{key:"currentTime",get:function(){return this._player?this._player.currentTime:0}},{key:"duration",get:function(){return this._player?this._player.duration:0}}]),t}(c.PureComponent))},1186:function(e,t,n){},1187:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1188),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).props=void 0,n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=["cc-container",this.props.hidden&&"hidden",this.props.className||""].filter(Boolean).join(" ");return c.createElement("div",{className:e},this.props.children,"string"===typeof this.props.text?this.props.text&&c.createElement("span",{className:"cc-text"},this.props.text):this.props.text)}}]),t}(c.PureComponent))},1188:function(e,t,n){},1189:function(e,t,n){},1190:function(e,t,n){},1191:function(e,t,n){},1192:function(e,t,n){},1193:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return y}));var r,o,a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=(n(1047),n(1194),n(88)),h=n.n(d),m=n(1045),f=n(288);!function(e){e.End="End",e.Delete="Delete"}(o||(o={}));var y=(r=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return u.createElement(f.a,{visible:this.props.visible,onToggle:this.props.onToggle,title:"Long Running Session",size:"small"},u.createElement("div",{className:"form-styles lrs-end-modal"},u.createElement("p",{className:"text"},this._firstSentence," ",this._secondSentence),u.createElement("div",{className:"button-sequence"},u.createElement(m.b,{className:"short-btn",onClick:this._close},"OK"))))}},{key:"_close",value:function(){this.props.onToggle(!1)}},{key:"_firstSentence",get:function(){return this.props.type===o.Delete?"You cannot delete a long running session.":"You cannot end a long running session."}},{key:"_secondSentence",get:function(){return this.props.type===o.Delete?u.createElement(u.Fragment,null,"To delete such a session,",u.createElement("br",null),"please contact the administrator."):u.createElement(u.Fragment,null,"To end such a session,",u.createElement("br",null),"please contact the administrator.")}}]),t}(u.PureComponent),Object(l.a)(r.prototype,"_close",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_close"),r.prototype),r)},1194:function(e,t,n){},1195:function(e,t,n){},1210:function(e,t,n){},1216:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=[n(1258),n(1259),n(1260),n(1261),n(1262),n(1263),n(1264),n(1265),n(1266),n(1267),n(1268),n(1269),n(1270),n(1271),n(1272),n(1273),n(1274),n(1275),n(1276),n(1277),n(1278),n(1279),n(1280),n(1281),n(1282),n(1283),n(1284),n(1285),n(1286),n(1287),n(1288),n(1289),n(1290),n(1291),n(1292),n(1293),n(1294),n(1295),n(1296)]},1218:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=0,n=0,r=0,o=e.split(":").map((function(e){return parseInt(e,10)})).filter((function(e){return!Number.isNaN(e)}));return 3===o.length?(t=o[0],n=o[1],r=o[2]):2===o.length&&(n=o[0],r=o[1]),60*t*60*1e3+60*n*1e3+1e3*r}},1221:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1336),function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"scrollable-container "+(this.props.className?this.props.className:"")},c.createElement("div",{className:"content"},this.props.children))}}]),t}(c.Component))},1222:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=(n(1339),n(1556)),l=n(0),u=n(1045),d=function(e){function t(){return Object(r.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=c.createElement(c.Fragment,null,c.createElement("legend",null,"Estimates"),c.createElement("div",{className:"field-info"},"These estimates help us give your learners a better experience"),c.createElement("div",{className:"row learners-number-row"},c.createElement(p.a,Object.assign({name:this.props.customersNumName,component:u.u,disabled:this.props.disabled},{label:"Number of Learners"}),c.createElement(u.n,{value:l.A.One},"1 (collaborate on same cloud desktop)"),c.createElement(u.n,{value:l.A.OneToFour},"1-4"),c.createElement(u.n,{value:l.A.FiveToNine},"5-9"),c.createElement(u.n,{value:l.A.TenToNineteen},"10-19"),c.createElement(u.n,{value:l.A.TwentyPlus,disabled:!0},"20-2000 (contact us: help@rhyme.com)"))),c.createElement("div",{className:"row learners-location-row"},c.createElement(p.a,Object.assign({name:this.props.regionName,component:u.u,disabled:this.props.disabled},{label:"Learners' Locations"}),c.createElement(u.n,{value:l.O.USAOnly},"North America Only"),c.createElement(u.n,{value:l.O.EuropeOnly},"Europe Only"),c.createElement(u.n,{value:l.O.AsiaOnly},"Asia Only"),c.createElement(u.n,{value:l.O.Global,disabled:!0},"Global (contact us: help@rhyme.com)"))));return this.props.fieldset?c.cloneElement(this.props.fieldset,{className:"estimates"},e):c.createElement("fieldset",{className:"estimates"},e)}}]),t}(c.PureComponent);d.defaultProps={customersNumName:"customersNum",regionName:"region"}},1223:function(e,t,n){},1255:function(e,t,n){},1256:function(e,t,n){},1257:function(e,t,n){},1258:function(e,t,n){e.exports=n.p+"static/media/Avatar00001.f9e88744.jpg"},1259:function(e,t,n){e.exports=n.p+"static/media/Avatar00002.2b79a56a.jpg"},1260:function(e,t,n){e.exports=n.p+"static/media/Avatar00003.0a263350.jpg"},1261:function(e,t,n){e.exports=n.p+"static/media/Avatar00004.1fa579be.jpg"},1262:function(e,t,n){e.exports=n.p+"static/media/Avatar00005.fab97250.jpg"},1263:function(e,t,n){e.exports=n.p+"static/media/Avatar00006.f9d2eaeb.jpg"},1264:function(e,t,n){e.exports=n.p+"static/media/Avatar00007.2d26ba8f.jpg"},1265:function(e,t,n){e.exports=n.p+"static/media/Avatar00008.d9426af2.jpg"},1266:function(e,t,n){e.exports=n.p+"static/media/Avatar00009.aa0b6701.jpg"},1267:function(e,t,n){e.exports=n.p+"static/media/Avatar00010.d07f5608.jpg"},1268:function(e,t,n){e.exports=n.p+"static/media/Avatar00012.230ad4fb.jpg"},1269:function(e,t,n){e.exports=n.p+"static/media/Avatar00013.3cfad125.jpg"},1270:function(e,t,n){e.exports=n.p+"static/media/Avatar00014.cea5fcdd.jpg"},1271:function(e,t,n){e.exports=n.p+"static/media/Avatar00015.bd6ea4d2.jpg"},1272:function(e,t,n){e.exports=n.p+"static/media/Avatar00016.433ebe2d.jpg"},1273:function(e,t,n){e.exports=n.p+"static/media/Avatar00017.5aadb091.jpg"},1274:function(e,t,n){e.exports=n.p+"static/media/Avatar00018.70eba844.jpg"},1275:function(e,t,n){e.exports=n.p+"static/media/Avatar00019.6a960cce.jpg"},1276:function(e,t,n){e.exports=n.p+"static/media/Avatar00020.215d799b.jpg"},1277:function(e,t,n){e.exports=n.p+"static/media/Avatar00021.0ce3a9ca.jpg"},1278:function(e,t,n){e.exports=n.p+"static/media/Avatar00022.292d7b6f.jpg"},1279:function(e,t,n){e.exports=n.p+"static/media/Avatar00023.68610b3b.jpg"},1280:function(e,t,n){e.exports=n.p+"static/media/Avatar00024.c6a20455.jpg"},1281:function(e,t,n){e.exports=n.p+"static/media/Avatar00025.1a91f5fe.jpg"},1282:function(e,t,n){e.exports=n.p+"static/media/Avatar00026.684e5ad9.jpg"},1283:function(e,t,n){e.exports=n.p+"static/media/Avatar00027.5ce90830.jpg"},1284:function(e,t,n){e.exports=n.p+"static/media/Avatar00028.57e8897c.jpg"},1285:function(e,t,n){e.exports=n.p+"static/media/Avatar00029.bd1c70de.jpg"},1286:function(e,t,n){e.exports=n.p+"static/media/Avatar00030.a0ff2d3f.jpg"},1287:function(e,t,n){e.exports=n.p+"static/media/Avatar00031.fd748b3b.jpg"},1288:function(e,t,n){e.exports=n.p+"static/media/Avatar00032.eccc9dc5.jpg"},1289:function(e,t,n){e.exports=n.p+"static/media/Avatar00033.e9562fc5.jpg"},1290:function(e,t,n){e.exports=n.p+"static/media/Avatar00034.eb1b7360.jpg"},1291:function(e,t,n){e.exports=n.p+"static/media/Avatar00035.f3c575f6.jpg"},1292:function(e,t,n){e.exports=n.p+"static/media/Avatar00036.321728ae.jpg"},1293:function(e,t,n){e.exports=n.p+"static/media/Avatar00037.f9f98e2f.jpg"},1294:function(e,t,n){e.exports=n.p+"static/media/Avatar00038.3bb3b97b.jpg"},1295:function(e,t,n){e.exports=n.p+"static/media/Avatar00039.2cdb0016.jpg"},1296:function(e,t,n){e.exports=n.p+"static/media/Avatar00040.fc382775.jpg"},1297:function(e,t,n){},1298:function(e,t,n){},1299:function(e,t,n){},1300:function(e,t,n){},1301:function(e){e.exports=JSON.parse('["gmail.com","hotmail.com","outlook.com","yahoo.com","icloud.com","live.com","me.com","msn.com","aol.com","att.net","alice.it","aol.it","arnet.com.ar","bellsouth.net","blueyonder.co.uk","bol.com.br","bt.com","btinternet.com","comcast.net","charter.net","cox.net","daum.net","email.com","email.it","earthlink.net","facebook.com","fastmail.fm","free.fr","fibertel.com.ar","freeserve.co.uk","gmx.com","gmx.de","gmx.fr","gmx.net","games.com","globo.com","globomail.com","google.com","hotmail.co.uk","hotmail.com.br","hotmail.com.mx","hotmail.de","hotmail.es","hotmail.fr","hotmail.it","hanmail.net","hush.com","hushmail.com","inbox.com","ig.com.br","iname.com","itelefonica.com.br","juno.com","live.co.uk","live.com.ar","live.com.mx","live.de","live.fr","live.it","laposte.net","lavabit.com","libero.it","list.ru","live.be","love.com","mac.com","mail.com","mail.ru","nate.com","naver.com","neuf.fr","ntlworld.com","outlook.com.br","o2.co.uk","orange.fr","orange.net","oi.com.br","online.de","pobox.com","poste.it","prodigy.net.mx","protonmail.com","qq.com","rocketmail.com","r7.com","rambler.ru","rhyme.com","sbcglobal.net","sky.com","safe-mail.net","sfr.fr","sina.com","skynet.be","speedy.com.ar","t-online.de","talktalk.co.uk","telenet.be","teletu.it","terra.com.br","tin.it","tiscali.co.uk","tiscali.it","tvcablenet.be","uol.com.br","verizon.net","virgin.net","virginmedia.com","virgilio.it","voo.be","wanadoo.co.uk","wanadoo.fr","web.de","wow.com","yahoo.co.in","yahoo.co.jp","yahoo.co.kr","yahoo.co.uk","yahoo.com.ar","yahoo.com.br","yahoo.com.mx","yahoo.de","yahoo.fr","yahoo.it","yandex.com","yandex.ru","ya.ru","ygm.com","ymail.com","zipmail.com.br","zoho.com"]')},1302:function(e,t,n){},1303:function(e,t,n){},1304:function(e,t,n){},1305:function(e,t,n){},1306:function(e,t,n){},1307:function(e,t,n){},1308:function(e,t,n){},1309:function(e,t,n){},1310:function(e,t,n){},1311:function(e,t,n){},1312:function(e,t,n){},1313:function(e,t,n){},1315:function(e,t,n){},1316:function(e,t,n){},1317:function(e,t,n){},1318:function(e,t,n){},1319:function(e,t,n){},1320:function(e,t,n){},1321:function(e,t,n){},1322:function(e,t,n){},1323:function(e,t,n){},1324:function(e,t,n){},1333:function(e,t,n){},1334:function(e,t,n){},1335:function(e,t,n){},1336:function(e,t,n){},1337:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1047),n(1338),n(88)),d=n.n(u),h=n(52),m=n(60),f=n(1556),y=n(1557),v=n(1558),b=n(0),g=n(1045),O=n(1065),C=n(1222),k="liveSessionDetails",j=(r=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"saveDetails",value:function(e){var t=new b.x({name:this.props.courseName,description:this.props.description,type:this.props.customersNum===b.A.One?b.y.Collaboration:b.y.Live}),n=new b.P({region:this.props.region,expectedAttendees:this.props.customersNum});this.props.onSessionDetailsSubmit(t,n),e.preventDefault()}},{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"render",value:function(){return l.createElement("div",{className:"live-session-details form-styles"},l.createElement("h2",null,l.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Session Details"),l.createElement("p",{className:"text"},"Please give your learners (and us) more details about the session"),l.createElement("form",{name:k,onSubmit:this.saveDetails},l.createElement("fieldset",null,l.createElement("legend",null,"Basics"),l.createElement(f.a,Object.assign({name:"courseName",component:g.s,autoComplete:"off",type:"text"},{label:"Session Name"})),l.createElement(f.a,Object.assign({name:"description",component:g.v,rows:5},{label:"Session Description"}))),l.createElement(C.a,null),l.createElement(g.a,{disabled:!this.props.valid},"Save")))}}]),t}(l.Component),Object(p.a)(r.prototype,"saveDetails",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"saveDetails"),r.prototype),Object(p.a)(r.prototype,"back",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"back"),r.prototype),r),w=Object(y.a)({form:k,validate:O.r})(j),E=Object(v.a)(k),_=Object(m.c)((function(e,t){return{courseName:E(e,"courseName"),description:E(e,"description"),customersNum:E(e,"customersNum"),region:E(e,"region"),initialValues:{courseName:t.data.course?t.data.course.name:"",description:t.data.course?t.data.course.description:"",customersNum:t.data.room?t.data.room.expectedAttendees:b.A.OneToFour,region:t.data.room?t.data.room.region:b.O.USAOnly}}}))(w)},1338:function(e,t,n){},1339:function(e,t,n){},1340:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r,o=n(49),a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(4),d=(n(1047),n(1341),n(88)),h=n.n(d),m=n(52),f=n(9),y=n(60),v=n(1556),b=n(1557),g=n(1558),O=n(0),C=n(1045),k=n(1065),j="recordedSessionDetails",w=(r=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"saveDetails",value:function(e){e.preventDefault();var t=this.props.course?this.props.course.chapters:Object(f.List)([]),n=new O.x(Object(o.a)({},this.props.course?this.props.course.toJS():{},{type:O.y.Recorded,name:this.props.courseName,description:this.props.description,chapters:t}));this.props.onSessionDetailsSubmit(n)}},{key:"back",value:function(){this.props.dispatch(Object(m.d)())}},{key:"render",value:function(){return u.createElement("div",{className:"recorded-session-details form-styles"},u.createElement("h2",null,this.props.hideBack?null:u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"New Recording"),u.createElement("p",{className:"text"},"Help learners understand what the recording is about"),u.createElement("form",{name:j,onSubmit:this.saveDetails},u.createElement("div",{className:"row"},u.createElement(v.a,Object.assign({name:"courseName",component:C.s,autoComplete:"off",type:"text"},{label:"Recording Name"})),u.createElement("p",{className:"field-info"},"All sessions of this recording will use this recording name and description")),u.createElement(v.a,Object.assign({name:"description",component:C.v,rows:5},{label:"Recording Description"})),u.createElement(C.a,{disabled:!this.props.valid},"Save")),u.createElement("i",{className:"fa fa-video-camera","aria-hidden":"true"}))}}]),t}(u.Component),Object(l.a)(r.prototype,"saveDetails",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"saveDetails"),r.prototype),Object(l.a)(r.prototype,"back",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"back"),r.prototype),r),E=Object(b.a)({form:j,validate:k.r})(w),_=Object(g.a)(j),S=Object(y.c)((function(e,t){return{courseName:_(e,"courseName"),description:_(e,"description"),initialValues:{courseName:t.course?t.course.name:"",description:t.course?t.course.description:""}}}))(E)},1341:function(e,t,n){},1342:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),a=n(30),i=n(28),s=n(29),c=n(4),p=n(52),l=function(e){function t(e){var n;if(Object(r.a)(this,t),n=Object(a.a)(this,Object(i.a)(t).call(this,e)),e.condition){var o=e.redirectPath,s=o?Object(p.g)(o):Object(p.d)();e.dispatch(s)}return n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.condition?null:this.props.children}}]),t}(c.Component)},1343:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(5),a=n(11),i=n(30),s=n(28),c=n(29),p=n(87),l=n(4),u=(n(1223),n(1344),n(88)),d=n.n(u),h=n(52),m=n(12),f=n(0),y=n(13),v=n(1045),b=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._queryParams=void 0,n._queryParams=new m.db(e.location),Object(y.c)(y.a.SessionCreationRoom),n}return Object(c.a)(t,e),Object(a.a)(t,[{key:"live",value:function(){var e=m.ib;this.props.tryFlow&&(e=m.y),this.props.dispatch(Object(m.Hb)(e))}},{key:"recorded",value:function(){var e;e=this.props.tryFlow?m.z:this.props.courses.find((function(e){return e.type===f.y.Recorded}))?"true"===this._queryParams.params.schedule?m.K:Object(m.Ib)(!0):"true"===this._queryParams.params.schedule?m.S:Object(m.Nb)(!0),this.props.dispatch(Object(m.Hb)(e))}},{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"render",value:function(){return l.createElement("div",{className:"session-type split-screen-layout"},l.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),l.createElement("div",{className:"cont live"},l.createElement("h2",null,"Live session"),l.createElement("div",{className:"illustration"}),l.createElement("p",{className:"sub-title"},"If you will ..."),l.createElement("p",null,"live broadcast your cloud desktop",l.createElement("br",null),"that learners can watch & follow in real-time"),l.createElement(v.a,{className:"ssl-button",onClick:this.live},"Start")),l.createElement("div",{className:"cont recorded"},l.createElement("h2",null,"Recorded session"),l.createElement("div",{className:"illustration"}),l.createElement("p",{className:"sub-title"},"If you will ..."),l.createElement("p",null,"create a recording of using your cloud desktop",l.createElement("br",null),"that learners can watch & follow later"),l.createElement(v.a,{className:"ssl-button",onClick:this.recorded},"Start")))}},{key:"tryFlow",get:function(){return this.props.tryFlow&&!this.props.courses}}]),t}(l.PureComponent),Object(p.a)(r.prototype,"live",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"live"),r.prototype),Object(p.a)(r.prototype,"recorded",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"recorded"),r.prototype),Object(p.a)(r.prototype,"back",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"back"),r.prototype),r)},1344:function(e,t,n){},1469:function(e,t,n){"use strict";var r,o,a=n(5),i=n(11),s=n(30),c=n(28),p=n(29),l=n(87),u=n(88),d=n.n(u),h=n(4),m=(n(1047),n(1333),n(60)),f=n(1556),y=n(1557),v=n(1558),b=n(2),g=n(0),O=n(1045),C=n(288),k=(n(1334),n(52)),j=n(1559),w=n(1560),E=n(12),_=n(17),S=n(1132),D=(r=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={loading:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onToggle",value:function(){this.props.onToggle(!this.props.visible),this.props.reset()}},{key:"resendCode",value:function(){var e=this.props,t=e.asyncActions,n=e.dispatch;n(t.sendForgottenPasswordCode(this.props.email)).then((function(){n(new b.i(new g.I({type:g.J.General,text:"We have emailed you a security code"})))}))}},{key:"changePassword",value:function(e){var t=this;this.setState({loading:!0});var n=this.props,r=n.asyncActions,o=n.dispatch,a=new g.cb({email:this.props.email,password:this.props.newPassword});o(r.updateForgottenPassword(a,this.props.securityCode)).then((function(){Object(_.b)().login(a).then((function(){return o(Object(k.g)(E.ob))}))}),(function(){return t.setState({loading:!1})})),e.preventDefault()}},{key:"render",value:function(){return h.createElement(C.a,{size:"small",title:"New Password",visible:this.props.visible,hideClose:this.state.loading,closeWithEsc:!this.state.loading,onToggle:this.onToggle},h.createElement("div",{className:"change-pass-modal form-styles"},h.createElement("form",{name:"changePass",onSubmit:this.changePassword},h.createElement("p",{className:"text"},"Please check your email at ",h.createElement("strong",null,this.props.email)," to find the security code"),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"securityCode",className:"security-code",maxLength:O.l.securityCode.max,component:O.s,type:"text",autoFocus:!0},{label:"Security code"}))),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"newPassword",component:O.s,type:"password"},{label:"New password"})),this.isPasswordValid&&h.createElement("p",{className:"description"},"Long passwords are safer. ",S.a[Object(S.b)(this.props.newPassword||"")])),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"repeatPassword",component:O.s,type:"password"},{label:"Repeat password"}))),h.createElement(O.b,{loading:this.state.loading,disabled:!this.props.valid},"Save"),h.createElement("div",{className:"row resend"},h.createElement("a",{href:"javascript:void(0);",onClick:this.resendCode},"Resend Code")))))}},{key:"isPasswordValid",get:function(){if(this.props.formMeta&&this.props.errors){var e=this.props.formMeta.newPassword,t=this.props.errors.newPassword;if(e)return!(e.touched&&this.props.newPassword&&t&&!e.active)}return!0}}]),t}(h.Component),Object(l.a)(r.prototype,"onToggle",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onToggle"),r.prototype),Object(l.a)(r.prototype,"resendCode",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"resendCode"),r.prototype),Object(l.a)(r.prototype,"changePassword",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"changePassword"),r.prototype),r),P=Object(y.a)({form:"changePass",validate:O.C})(D),T=Object(v.a)("changePass"),R=Object(m.c)((function(e){return{securityCode:T(e,"securityCode"),newPassword:T(e,"newPassword"),repeatPassword:T(e,"repeatPassword"),errors:Object(j.a)("changePass")(e),formMeta:Object(w.a)("changePass")(e)}}))(P);n.d(t,"a",(function(){return V}));var x=(o=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={loading:!1,changePassVisible:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onToggle",value:function(){this.props.onToggle(!this.props.visible),this.props.reset()}},{key:"updateChangePassVisibility",value:function(e){var t=this;this.setState({changePassVisible:e},(function(){e&&t.props.onToggle(!1)}))}},{key:"sendSecurityCode",value:function(e){var t=this,n=this.props,r=n.asyncActions,o=n.dispatch;this.setState({loading:!0}),o(r.sendForgottenPasswordCode(this.props.email)).then((function(){o(new b.i(new g.I({type:g.J.General,text:"We have emailed you a security code"}))),t.updateChangePassVisibility(!0),t.setState({loading:!1})}),(function(){return t.setState({loading:!1})})),e.preventDefault()}},{key:"render",value:function(){return h.createElement("div",{className:"forgot-pass-modal form-styles"},h.createElement(C.a,{size:"small",title:"Forgot Password?",visible:this.props.visible,hideClose:this.state.loading,closeWithEsc:!this.state.loading,onToggle:this.onToggle},h.createElement("form",{name:"forgotPass",onSubmit:this.sendSecurityCode},h.createElement("p",{className:"text"},"We will email you a security code which will allow you to set a new password"),h.createElement("div",{className:"row"},h.createElement(f.a,{name:"email",component:O.f,autoFocus:!0})),h.createElement(O.b,{disabled:!this.valid,loading:this.state.loading},"Send Code"))),h.createElement(R,{email:this.props.email||"",visible:this.state.changePassVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.updateChangePassVisibility}))}},{key:"valid",get:function(){return this.props.valid&&this.props.email}}]),t}(h.Component),Object(l.a)(o.prototype,"onToggle",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"onToggle"),o.prototype),Object(l.a)(o.prototype,"updateChangePassVisibility",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"updateChangePassVisibility"),o.prototype),Object(l.a)(o.prototype,"sendSecurityCode",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"sendSecurityCode"),o.prototype),o),M=Object(y.a)({form:"forgotPass",validate:function(e){return Object(O.E)(e,"email")}})(x),N=Object(v.a)("forgotPass"),V=Object(m.c)((function(e){return{email:N(e,"email")}}))(M)},1673:function(e,t,n){},1674:function(e,t,n){},1675:function(e,t,n){},1676:function(e,t,n){},1677:function(e,t,n){},1678:function(e,t,n){},1679:function(e,t,n){},1680:function(e,t,n){},1681:function(e,t,n){e.exports=n.p+"static/media/Pause.af51b8fe.svg"},1682:function(e,t,n){},1683:function(e,t,n){},1684:function(e,t,n){},1685:function(e,t,n){},1686:function(e,t,n){},1687:function(e,t,n){},1688:function(e,t,n){},1689:function(e,t,n){},1690:function(e,t,n){},1691:function(e,t,n){},1692:function(e,t,n){e.exports=n.p+"static/media/Screenshot.a3a0ae80.svg"},1693:function(e,t,n){},1694:function(e,t,n){},1695:function(e,t,n){},1696:function(e,t,n){},1697:function(e,t,n){},1698:function(e,t,n){},1699:function(e,t,n){e.exports=n.p+"static/media/UploadFiles.bfe08601.svg"},1700:function(e,t,n){},1701:function(e,t,n){e.exports=n.p+"static/media/Configure.3e19da79.svg"},1702:function(e,t,n){e.exports=n.p+"static/media/ApplyLicenses.bec2a03f.svg"},1703:function(e,t,n){e.exports=n.p+"static/media/InstallSoftware.1f112818.svg"},1704:function(e,t,n){},1705:function(e,t,n){},1706:function(e,t,n){},1707:function(e,t,n){},1708:function(e,t,n){},1709:function(e,t,n){},1710:function(e,t,n){},1711:function(e,t,n){},1715:function(e,t,n){},1716:function(e,t,n){},1717:function(e,t,n){},1718:function(e,t,n){},1719:function(e,t,n){},1720:function(e,t,n){},1721:function(e,t,n){},1722:function(e,t,n){},1730:function(e,t,n){},1731:function(e,t,n){},1732:function(e,t,n){},1733:function(e,t,n){},1734:function(e,t,n){},1916:function(e,t,n){},1962:function(e,t,n){},1963:function(e,t,n){},1964:function(e,t,n){},1966:function(e,t,n){},1967:function(e,t,n){},1968:function(e,t,n){},1969:function(e,t,n){},1970:function(e,t,n){},1971:function(e,t,n){},1972:function(e,t,n){},1973:function(e,t,n){},1974:function(e,t,n){},1975:function(e,t,n){},1976:function(e,t,n){},1977:function(e,t,n){},1978:function(e,t,n){},1979:function(e,t,n){},1980:function(e,t,n){},1981:function(e,t,n){},1982:function(e,t,n){},1983:function(e,t,n){},1984:function(e,t,n){},1985:function(e,t,n){},1986:function(e,t,n){},1987:function(e,t,n){},1988:function(e,t,n){},1989:function(e,t,n){},1990:function(e,t,n){},1991:function(e,t,n){},1992:function(e,t,n){},1999:function(e,t,n){"use strict";n.r(t);var r,o,a,i=n(5),s=n(11),c=n(30),p=n(28),l=n(29),u=n(4),d=n.n(u),h=(n(1672),n(52)),m=n(164),f=n.n(m),y=n(69),v=n(2),b=n(17),g=n(1053),O=n(13),C=n(87),k=n(88),j=n.n(k),w=n(60),E=n(1037),_=n(1556),S=n(1557),D=n(1558),P=n(0),T=n(1045),R=n(288),x=(n(1673),n(130)),M=function(e){function t(e){var n;Object(i.a)(this,t);var r=(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._groupCosts(e.cost);return n.state={leftColSize:n._determineColSizes(r.length),groupedCosts:r},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.cost.costs!==e.cost.costs){var t=this._groupCosts(this.props.cost),n=this._determineColSizes(t.length);this.setState({groupedCosts:t,leftColSize:n})}}},{key:"render",value:function(){return u.createElement("div",{className:"cost-table"},this.renderTable(0,Math.min(this.state.leftColSize,this.state.groupedCosts.length)),this.renderTable(this.state.leftColSize,this.state.groupedCosts.length,!0))}},{key:"renderTable",value:function(e,t,n){for(var r=[],o=e;o<t;o+=1){var a=this.state.groupedCosts[o];r.push(u.createElement("tr",{key:"tr-"+o+e},u.createElement("td",null,a.attendeesCount," ",a.isGuide&&"(host)"),u.createElement("td",null,a.duration.toFixed(2)),u.createElement("td",null,this.currency,Object(x.b)(this.props.cost.rate,!0)," x ",a.attendeesCount," x ",a.duration.toFixed(2)," ="," ",this.currency,Object(x.b)(a.amount))))}return n&&r.push([u.createElement("tr",{key:"tr-empty"},u.createElement("td",null,"Credit card processing"),u.createElement("td",null),u.createElement("td",null,this.currency,Object(x.b)(this.props.cost.processingFee))),u.createElement("tr",{key:"tr-total"},u.createElement("td",null),u.createElement("td",null,u.createElement("strong",null,"Total Cost")),u.createElement("td",null,u.createElement("strong",null,this.currency,Object(x.b)(this.props.cost.total))))]),u.createElement("table",null,u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",null,"Learners"),u.createElement("th",null,"Hours"),u.createElement("th",null,"Cost"))),u.createElement("tbody",null,r))}},{key:"_determineColSizes",value:function(e){var t=e+2;return Math.ceil(t/2)}},{key:"_groupCosts",value:function(e){var t=this,n=[];return e.costs.groupBy((function(e){return t._calculateDuration(e.seconds)})).forEach((function(t,r){var o=t.filter((function(t){return!e.guides.has(t.id)})),a=o.map((function(e){return e.amount})).reduce((function(e,t){return e+t}));void 0!==a&&n.push({isGuide:!1,duration:r,attendeesCount:o.size,amount:a}),n=n.concat(t.filter((function(t){return e.guides.has(t.id)})).map((function(e){return{isGuide:!0,duration:r,attendeesCount:1,amount:e.amount}})).toArray())})),n.sort((function(e,t){return e.isGuide&&!t.isGuide?-1:!e.isGuide&&t.isGuide?1:t.duration-e.duration}))}},{key:"_calculateDuration",value:function(e){var t=0;if(e>this.props.cost.freeTimeSecs){t=Math.ceil(e/this.props.cost.unitDurationSecs)*(this.props.cost.unitDurationSecs*(1/.6/60)/100)}return t}},{key:"currency",get:function(){return x.a[this.props.cost.currency]}}]),t}(u.Component),N=(n(1047),n(1674),r=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={visible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.cost;t.costs.size&&!this.state.visible?this.toggle(!0):!t.costs.size&&this.state.visible&&this.toggle(!1)}},{key:"toggle",value:function(e){var t=this;this.setState({visible:e},(function(){e||t.props.dispatch(new v.kb)}))}},{key:"onFeedbackSend",value:function(e){var t=this;e.preventDefault(),this.props.feedbackText&&this.props.dispatch(this.props.asyncActions.sendFeedback(this.props.user,new P.B({type:P.C.CostDetails,text:this.props.feedbackText,roomId:this.props.cost.roomId,vmId:this.props.cost.vmId}))).then((function(){t.props.dispatch(Object(E.b)("feedbackText"));var e=new P.I({type:P.J.General,text:"Thank you for your feedback!"});t.props.dispatch(new v.i(e))}))}},{key:"close",value:function(){this.props.dispatch(new v.kb)}},{key:"render",value:function(){return u.createElement("div",{className:"cost-details-modal"},u.createElement(R.a,{title:this.title,visible:this.state.visible,onToggle:this.toggle},u.createElement("div",{className:"form-styles"},u.createElement("section",{className:"text-content"},u.createElement("div",{className:"cost-content"},this.props.cost.estimated?u.createElement("div",{className:"cost-estimate"},"Cost values are estimates"):null,u.createElement(M,{cost:this.props.cost})),u.createElement("form",{className:"feedback",name:"feedbackText",onSubmit:this.onFeedbackSend},u.createElement("p",null,"Send feedback to us"),u.createElement("span",null,u.createElement("i",{className:"fa fa-comment-o"}),u.createElement(_.a,{name:"feedbackText",component:T.s,placeholder:"Type feedback",alwaysShowPlaceholder:!0}),u.createElement(T.a,{disabled:!this.props.valid,className:"btn small"},"Send")))),u.createElement("section",{className:"controls"},u.createElement(T.a,{className:"short-btn",onClick:this.close},"Done")))))}},{key:"costLoaded",get:function(){return!!this.props.cost.costs.size}},{key:"costCurrency",get:function(){return this.props.cost.currency}},{key:"attendeesNumber",get:function(){return this.props.cost.costs.size}},{key:"title",get:function(){return"Session Cost"}}]),t}(u.Component),Object(C.a)(r.prototype,"toggle",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"toggle"),r.prototype),Object(C.a)(r.prototype,"onFeedbackSend",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"onFeedbackSend"),r.prototype),Object(C.a)(r.prototype,"close",[j.a],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),r),V=Object(S.a)({form:"feedbackText",validate:T.H})(N),A=Object(D.a)("feedbackText"),I=Object(w.c)((function(e){return{feedbackText:A(e,"feedbackText")}}))(V),U=n(1151),L=n(1094),F=n(163),z=(n(1675),["purple","red","blue","green"]),B=["big","big","medium","medium","medium","small","small","small","small","small"],W=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._lastShape=void 0,n.state={shapes:[]},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.predefined||this._createShapes()}},{key:"render",value:function(){var e=this.state.shapes;return u.createElement("div",{className:"rhyme-bg"},this.props.predefined?u.createElement(u.Fragment,null,u.createElement("div",{className:"s oval purple medium",style:{right:"-3%",top:"30%"}}),u.createElement("div",{className:"s oval purple big",style:{left:"40%",bottom:"-5%"}}),u.createElement("div",{className:"s oval green small",style:{left:"25%",top:"-1%"}}),u.createElement("div",{className:"s rect blue big",style:{left:"-3%",top:"40%",transform:"rotate(35deg)"}}),u.createElement("div",{className:" rect green medium",style:{right:"20%",bottom:"-5%",transform:"rotate(45deg)"}})):e.map((function(e,t){return u.createElement("div",{className:["s",e.shape,e.color,e.size].join(" "),style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg) translate(-50%, -50%)")},key:"rbs-"+t})})),u.createElement("div",{className:"last-rel-element",style:{marginTop:e.length?e[e.length-1].y:0}}))}},{key:"_createShapes",value:function(){for(var e=[],t=Math.round(document.body.scrollHeight/this._yPixelFreq),n=0;n<t;n+=1)e.push(this._createShape(n));this.setState({shapes:e})}},{key:"_createShape",value:function(e){var t,n=this._rand(0,360),r=300*e,o=this._lastShape&&this._lastShape.x>50?this._rand(0,this._xPercOffset+1):this._rand(100-this._xPercOffset,101);do{t={shape:this._lastShape&&"oval"===this._lastShape.shape?"rect":"oval",color:z[this._rand(0,z.length)],size:B[this._rand(0,B.length)],rotation:n,x:o,y:r}}while(this._lastShape&&this._areShapesSimilar(this._lastShape,t));return this._lastShape=t,t}},{key:"_rand",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"_areShapesSimilar",value:function(e,t){return[e.size===t.size,e.color===t.color,e.shape===t.shape].map((function(e){return e?1:0})).reduce((function(e,t){return e+t}))>=2}},{key:"_xPercOffset",get:function(){return this.props.percentFromSideEdges||15}},{key:"_yPixelFreq",get:function(){return this.props.yFrequency||300}}]),t}(u.Component),H=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._bgContainer=void 0,n._appendBackground(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){(this.props.wrapper?this.props.wrapper:document.body).removeChild(this._bgContainer)}},{key:"_appendBackground",value:function(){this._bgContainer=document.createElement("div"),(this.props.wrapper?this.props.wrapper:document.body).appendChild(this._bgContainer),F.render(u.createElement(W,this.props),this._bgContainer)}}]),t}(u.Component),K=n(1343),Y=(n(1223),n(1676),n(12)),G=n(1068),J=(n(1677),2*T.l.inviteCode.max-1),Z=(o=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={active:!1,code:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"updateCode",value:function(e){var t=e.target.value.replace(/\s/g,"").split("").join(" ");this.setState({code:t})}},{key:"buttonAction",value:function(){this.state.active?this._joinSession():this.setState({active:!0})}},{key:"render",value:function(){return u.createElement("div",{className:"join-button"+(this.state.active?" active":"")+(this.disabled?" disabled":"")},u.createElement(T.a,{onClick:this.buttonAction,disabled:this.disabled},"Join"),u.createElement("input",{type:"text",maxLength:J,placeholder:"C O D E",value:this.state.code,onChange:this.updateCode}))}},{key:"_joinSession",value:function(){var e=Object(Y.Pb)(this.trimmedCode);this.props.dispatch(Object(h.g)(e))}},{key:"disabled",get:function(){var e=this.trimmedCode.length;return this.state.active&&e!==T.l.inviteCode.max&&e!==T.l.inviteCode.min}},{key:"trimmedCode",get:function(){return this.state.code.replace(/\s/g,"")}}]),t}(u.Component),Object(C.a)(o.prototype,"updateCode",[j.a],Object.getOwnPropertyDescriptor(o.prototype,"updateCode"),o.prototype),Object(C.a)(o.prototype,"buttonAction",[j.a],Object.getOwnPropertyDescriptor(o.prototype,"buttonAction"),o.prototype),o),q=(a=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"createSession",value:function(){this.props.dispatch(Object(h.g)(Y.nb))}},{key:"render",value:function(){return u.createElement("div",{className:"create-or-join split-screen-layout"},u.createElement("div",{className:"cont join"},u.createElement("h2",null,"Join a session"),u.createElement("div",{className:"illustration"}),u.createElement("p",{className:"sub-title"},"If you got an invite code to ..."),u.createElement("p",null,"see a demo or learn about a software"),u.createElement("div",{className:"join-button-wrapper"},u.createElement(Z,{dispatch:this.props.dispatch}),u.createElement(G.a,null,"If someone gave you an invite code to see a software demo or ",u.createElement("br",null),"to learn how to use a software, please enter the code here."))),u.createElement("div",{className:"cont create"},u.createElement("h2",null,"Create a session"),u.createElement("div",{className:"illustration"}),u.createElement("p",{className:"sub-title"},"If you want to ..."),u.createElement("p",null,"demo or teach your software"),u.createElement(T.a,{className:"ssl-button",onClick:this.createSession},"Create")))}}]),t}(u.Component),Object(C.a)(a.prototype,"createSession",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"createSession"),a.prototype),a),X=n(289),$=n(3),Q=n(1156),ee=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement(Q.a,{title:"Unsupported Browser for Recording",description:"This browser is not supported for creating recordings. Please use one of these browsers:",onBack:this.props.onBack})}}]),t}(u.PureComponent),te=n(20),ne=n.n(te),re=n(45),oe=n(1064),ae=n(1069),ie=n(158);n(1678);function se(e){return d.a.createElement("div",{className:"slide-in "+(e.open?"opened":"closed")},d.a.createElement("h2",{className:"title"},e.title),d.a.createElement("div",{className:"content"},e.children))}var ce=n(15),pe=n(1050),le=n.n(pe);n(1679);function ue(e){var t=e.disabled||!e.onSplitClicked,n=e.recordings,r=e.insertIndex;e.currentRec&&(n=n.splice(e.insertIndex,0,{id:"recording in progress",duration:e.currentRec.duration}).toList(),r++);var o=n.reduce((function(e,t){return e+t.duration}),0),a=Math.max(o,42e4),i=[0];n.forEach((function(e){return i.push(i[i.length-1]+e.duration)}));var s={left:"".concat(3e5/a*100,"%")},c={left:"".concat(42e4/a*100,"%")};return d.a.createElement("span",{className:"tl-root ".concat(e.disabled?"disabled":"")},d.a.createElement("span",{className:"track",key:"timeline-track"}),d.a.createElement("span",{className:"suggested-min tl-tooltip","data-tooltip":"Ideal length: 5-7 mins",key:"suggested-min-marker",style:s},d.a.createElement("div",{className:"dash-line"})),d.a.createElement("span",{className:"suggested-max tl-tooltip","data-tooltip":"Ideal length: 5-7 mins",key:"suggested-max-marker",style:c},d.a.createElement("div",{className:"dash-line"})),n.map((function(t,n){var r={left:"".concat(i[n]/a*100,"%"),width:"".concat(t.duration/a*100,"%")},o=le()("chunk",{"chunk-selected":e.selectAll||t===e.selectedRecording,"tl-tooltip":e.segmentTooltip});return d.a.createElement("span",{key:t.id,"data-index":n,"data-tooltip":e.segmentTooltip,onClick:function(){return!e.disabled&&e.onRecordingClicked(t)},className:o,style:r})})),i.map((function(o,i){var s={left:"".concat(o/a*100,"%")},c=n.get(i),p=i===n.size?"last-rec":c.id,l=le()({"insert-split":i===r,split:i!==r,"tl-tooltip":e.splitTooltip,"split-active":!t}),u=i===n.size||i===r,h=i===r&&e.currentRec;return d.a.createElement(d.a.Fragment,{key:"split-frag-".concat(p)},d.a.createElement("span",{key:"split-".concat(p),"data-tooltip":e.splitTooltip,onClick:function(){return!t&&e.onSplitClicked&&e.onSplitClicked(i)},className:l,style:s}),u&&d.a.createElement("span",{key:"split-lbl-".concat(p),className:le()("split-label",{rec:h}),style:s},function(e){var t=f.a.duration(e,"ms");return f.a.utc(t.asMilliseconds()).format("mm:ss")}(o)))})))}var de,he,me,fe,ye,ve,be,ge,Oe,Ce=n(298),ke=n(290),je=(n(1680),n(1681)),we=(de=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._recorder=null,n._keydownCallback=void 0,n._keyupCallback=void 0,n._shiftPressed=!1,n._altPressed=!1,n._audio=void 0,n._onDataInterval=void 0,n.state={recording:"not-initialized"},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._keydownCallback),document.removeEventListener("keyup",this._keyupCallback),this._resetRecorder(),this._audio&&this._audio.getAudioTracks().forEach((function(e){return e.stop()}))}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._keydownCallback=function(t){t.keyCode===ke.k&&(e._shiftPressed=!0),t.keyCode===ke.a&&(e._altPressed=!0),t.keyCode===ke.j&&e._altPressed&&e._shiftPressed&&!e.disabled&&e.toggleRecording()}),document.addEventListener("keyup",this._keyupCallback=function(t){16===t.keyCode&&(e._shiftPressed=!1),18===t.keyCode&&(e._altPressed=!1)})}},{key:"componentDidUpdate",value:function(e){this.props.webcamStream!==e.webcamStream&&this._recorder&&this._recorder.updateStream(this.props.webcamStream||null),!e.disabled&&this.props.disabled&&"recording"===this.state.recording&&(this._showNotificationError("Recording stopped"),this._processRecording())}},{key:"toggleRecording",value:function(){var e=this;if(!this.disabled)switch(this.state.recording){case"not-initialized":this._initializeRecorder();break;case"stopped":this.setState({recording:"recording"}),this.props.onStartRecording().then((function(){e._recorder&&(e._recorder.start(),e._resetCaptionPlayer(),e._startOnDataPolling())}));break;case"recording":this._processRecording();break;case"processing":case"initializing":default:return}}},{key:"onKeyboardEventRecorded",value:function(e){this.props.captionPlayer&&this.props.captionPlayer.onKey(e)}},{key:"render",value:function(){var e=le()("recording-button",{disabled:this.disabled||"processing"===this.state.recording,active:"recording"===this.state.recording||"processing"===this.state.recording});return u.createElement("div",{className:"video-recorder"},u.createElement("div",{onClick:this.toggleRecording,className:e},this._renderButtonContent()))}},{key:"_processRecording",value:function(){var e=Object(re.a)(ne.a.mark((function e(){var t,n;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._stopOnDataPolling(),this._recorder){e.next=4;break}return this.setState({recording:"not-initialized"}),e.abrupt("return");case 4:return this.setState({recording:"processing"}),e.prev=5,e.next=8,this._recorder.stop();case 8:t=e.sent,this.props.onRecordingAvailable(new P.M(t)),this.setState({recording:"stopped"}),e.next=20;break;case 13:e.prev=13,e.t0=e.catch(5),console.warn("Error processing recording: ".concat(e.t0)),n=e.t0.notificationText||"Could not process recording",this._showNotificationError(n),this._resetRecorder(),this.props.onRecordingProcessingError();case 20:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_renderButtonContent",value:function(){switch(this.state.recording){case"processing":case"initializing":return u.createElement("i",{className:"fa fa-circle-o-notch fa-spin fa-fw"});case"recording":return u.createElement("img",{src:je,width:26,height:30});case"not-initialized":case"stopped":default:return u.createElement(u.Fragment,null,"REC")}}},{key:"_resetRecorder",value:function(){this.setState({recording:"not-initialized"}),this._recorder&&this._recorder.isRecording&&this._recorder.stop(),this._recorder=null,this._stopOnDataPolling()}},{key:"_initializeRecorder",value:function(){var e=this;this.setState({recording:"initializing"}),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e._audio=t;var n=Object(Ce.a)().getRemoteClient(e.props.vm.id);if(!n)throw new Error("Invalid remote client");e._recorder=e._createScreenRecorder(n,t),e.props.onStartRecording().then((function(){e._recorder&&(e.props.webcamStream&&e._recorder.updateStream(e.props.webcamStream),e._recorder.start(),e.setState({recording:"recording"}),e._startOnDataPolling())}))}),(function(){e.setState({recording:"not-initialized"}),e._showNotificationError("Refused microphone access or not found audio device during recording")})).catch((function(t){console.error(t),e._resetRecorder(),e._showNotificationError("An error occurred while setting up the video recorder")}))}},{key:"_createScreenRecorder",value:function(e,t){var n={width:this.props.vm.width||ce.a.DefaultScreenWidth,height:this.props.vm.height||ce.a.DefaultScreenHeight};return new ae.j(new ae.i(e,t,n),new ae.g(e,this.onKeyboardEventRecorded),new ae.c(this.props.expandModeSource))}},{key:"_startOnDataPolling",value:function(){var e=this;this.props.onData({size:0,duration:0}),this._onDataInterval=setInterval((function(){e._recorder&&e.props.onData&&e.props.onData({size:e._recorder.size,duration:e._recorder.duration})}),300)}},{key:"_stopOnDataPolling",value:function(){this._onDataInterval&&(clearInterval(this._onDataInterval),this._onDataInterval=null)}},{key:"_resetCaptionPlayer",value:function(){this.props.captionPlayer&&this.props.captionPlayer.reset()}},{key:"_showNotificationError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.J.Error;this.props.dispatch(new v.i(new P.I({type:t,text:e})))}},{key:"disabled",get:function(){return this.props.disabled}}]),t}(u.Component),Object(C.a)(de.prototype,"toggleRecording",[j.a],Object.getOwnPropertyDescriptor(de.prototype,"toggleRecording"),de.prototype),Object(C.a)(de.prototype,"onKeyboardEventRecorded",[j.a],Object.getOwnPropertyDescriptor(de.prototype,"onKeyboardEventRecorded"),de.prototype),de),Ee=(n(1682),{First:.8*ce.a.FileSizeLimitVideo,Second:.96*ce.a.FileSizeLimitVideo,Third:ce.a.FileSizeLimitVideo}),_e=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._videoRecorder=void 0,n._expandModeSource=new ae.d,n.onRecordingAvailable=function(e){n.props.onRecording(e,n.state.recordingInsertIndex),n.props.onStopRecording(),n.setState({currentRecInfo:null,recordingInsertIndex:n.state.recordingInsertIndex+1})},n.onRecordingProcessingError=function(){n.props.onStopRecording(),n.setState({currentRecInfo:null})},n.onStartRecording=function(){return n.props.onStartRecording().then((function(){return n.setState({currentRecInfo:{duration:0,size:0}})}))},n.onData=function(e){var t=n.recordingsSize,r=t+e.size,o=t+(n.state.currentRecInfo?n.state.currentRecInfo.size:0),a=function(e){return o<e&&e<=r},i="";a(Ee.First)?i="The recording video file is too big and will soon exceed file size limit. Please stop and save the recording soon":a(Ee.Second)?i="The recording video file is about to exceed file size limit. Please stop and save recording immediately!":e.size>=Ee.Third&&n._videoRecorder&&n.isRecording&&n._videoRecorder.toggleRecording(),i&&n.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Video too big",text:i,ttl:1e4}))),n.setState({currentRecInfo:e})},n.toggleExpand=function(){n.state.isViewExpanded?(n._expandModeSource.didCollapse(),n.props.onExpandModeChange(ae.e.Collapse)):(n._expandModeSource.didExpand(),n.props.onExpandModeChange(ae.e.Expand)),n.setState({isViewExpanded:!n.state.isViewExpanded})},n.onSplitClicked=function(e){n.setState({recordingInsertIndex:e})},n.state={recordingInsertIndex:0,isViewExpanded:!1,currentRecInfo:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.recordings!==e.recordings&&this.setState({recordingInsertIndex:Math.min(this.state.recordingInsertIndex,this.props.recordings.count())})}},{key:"render",value:function(){var e=this,t=this.props.recordings.size>0||this.state.currentRecInfo;return u.createElement("div",{className:"video-record-controls"},u.createElement("div",{className:"timeline-wrapper"},t?u.createElement(ue,{recordings:this.props.recordings,insertIndex:this.state.recordingInsertIndex,currentRec:this.state.currentRecInfo,onRecordingClicked:this.props.onSelectRecording,onSplitClicked:this.onSplitClicked,disabled:this.isRecording,segmentTooltip:"Edit",splitTooltip:"Record here"}):u.createElement(u.Fragment,null,u.createElement("div",{className:"ideal-length"},"Ideal task length: 5-7 mins"),u.createElement("div",{className:"rec-shortcut"},"Press Alt-Shift-R"))),u.createElement("div",{className:"main-controls"},this._renderLeftControls(),u.createElement(we,{ref:function(t){return e._videoRecorder=t},onRecordingAvailable:this.onRecordingAvailable,onRecordingProcessingError:this.onRecordingProcessingError,onStartRecording:this.onStartRecording,onData:this.onData,dispatch:this.props.dispatch,vm:this.props.vm,webcamStream:this.props.webcamStream,expandModeSource:this._expandModeSource,captionPlayer:this.props.captionPlayer,disabled:!this.props.isVmConnected||this.recordingsSize>=Ee.Third}),this._renderRightControls()))}},{key:"_renderLeftControls",value:function(){return u.createElement("div",{className:"left-controls"},this.props.canExpandView&&u.createElement("button",{className:"expand-btn",onClick:this.toggleExpand},this.state.isViewExpanded?"Collapse View":"Expand View"))}},{key:"_renderRightControls",value:function(){return u.createElement("div",{className:"right-controls"},this.props.recordings.size>0&&u.createElement("button",{className:"preview-btn",onClick:this.props.onEdit,disabled:this.isRecording},"Edit & Preview"))}},{key:"isRecording",get:function(){return!!this.state.currentRecInfo}},{key:"recordingsSize",get:function(){return this.props.recordings.reduce((function(e,t){return e+t.dataSize}),0)}}]),t}(u.PureComponent),Se=n(1167),De={disabledCameraLabel:"",disabledCameraButton:"Enable Webcam",disabledCameraDescription:"Build a personal connection with your learners",enabledCameraLabel:"",enabledCameraButton:"Broadcast Your Webcam",enabledCameraDescription:"Build a personal connection with your learners",broadcastedCameraLabel:"",broadcastedCameraButton:"Broadcast Your Cloud Desktop",broadcastedCameraDescription:"Currently, learners cannot see your cloud desktop",disabledLabel:"Webcam can be enabled once your cloud desktop is ready"},Pe=(he=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={view:Se.b.DisabledCamera,cameraStream:null,error:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this._stopRecording()}},{key:"enableCamera",value:function(){var e=this;this.setState({view:Se.b.EnabledCamera}),navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){e.setState({cameraStream:t,error:null})})).catch((function(t){var n="An error occurred while enabling the webcam.";t&&t.name&&"NotAllowedError"===t.name&&(n="The webcam is blocked. Please, allow this page to access your webcam."),console.log(n),e.setState({view:Se.b.DisabledCamera,error:n})}))}},{key:"broadcastCamera",value:function(){this.state.cameraStream&&(this.props.onBroadcastCamera(this.state.cameraStream),this.setState({view:Se.b.BroadcastedCamera}))}},{key:"broadcastVM",value:function(){this.props.onStopBroadcastCamera(),this.setState({view:Se.b.DisabledCamera}),this._stopRecording()}},{key:"render",value:function(){return u.createElement(Se.a,{view:this.state.view,labels:De,disabled:this.props.disabled,error:this.state.error,cameraStream:this.state.cameraStream,onDisabledCameraAction:this.enableCamera,onEnabledCameraAction:this.broadcastCamera,onBroadcastedCameraAction:this.broadcastVM})}},{key:"_stopRecording",value:function(){this.state.cameraStream&&(this.state.cameraStream.getVideoTracks().forEach((function(e){return e.stop()})),this.setState({cameraStream:null}))}}]),t}(u.Component),Object(C.a)(he.prototype,"enableCamera",[j.a],Object.getOwnPropertyDescriptor(he.prototype,"enableCamera"),he.prototype),Object(C.a)(he.prototype,"broadcastCamera",[j.a],Object.getOwnPropertyDescriptor(he.prototype,"broadcastCamera"),he.prototype),Object(C.a)(he.prototype,"broadcastVM",[j.a],Object.getOwnPropertyDescriptor(he.prototype,"broadcastVM"),he.prototype),he),Te=(n(1683),n(22)),Re=n(1093),xe=n(1115),Me=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={deleteConfirmationModalVisible:!1,trimConfirmationModalVisible:!1,confirmTrimDuration:0,isMergingRecording:!1},n._recEditor=new ae.h,n.openDeleteConfirmationModal=function(){n.setState({deleteConfirmationModalVisible:!0})},n.closeDeleteConfirmationModal=function(){n.setState({deleteConfirmationModalVisible:!1})},n.onConfirmDeletion=function(){if(n.props.previewMergedRecording)n.props.onResetRecordings();else if(n.props.currentRecording){var e=n.props.recordings.findIndex((function(e){return e===n.props.currentRecording}));if(e>=0&&n.props.recordings.size>1){var t=0===e?1:e-1,r=n.props.recordings.get(t);n.props.onSetCurrentRecording(r),n.props.onSetVideoPlayerRecording(r)}n.props.onRemoveRecording(n.props.currentRecording)}return n.closeDeleteConfirmationModal(),Promise.resolve()},n.onPreviewAll=Object(re.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.mergedRecording){e.next=13;break}return n.setState({isMergingRecording:!0}),e.prev=3,e.t0=P.M,e.next=7,n._recEditor.merge(n.props.recordings);case 7:e.t1=e.sent,t=new e.t0(e.t1);case 9:return e.prev=9,n.setState({isMergingRecording:!1}),e.finish(9);case 12:n.props.onSetMergedRecording(t);case 13:n.props.onSetVideoPlayerRecording(t),n.props.onSetPreviewMergedRecording();case 15:case"end":return e.stop()}}),e,null,[[3,,9,12]])}))),n.onTrim=function(){var e=Object(re.a)(ne.a.mark((function e(t){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&n.props.currentRecording&&n.setState({confirmTrimDuration:t,trimConfirmationModalVisible:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onConfirmTrim=Object(re.a)(ne.a.mark((function e(){var t,r,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.closeTrimConfirmationModal(),!(t=n.state.confirmTrimDuration)||!n.props.currentRecording){e.next=12;break}return r=n.props.currentRecording,e.t0=P.M,e.next=7,n._recEditor.trim(n.props.currentRecording,t);case 7:e.t1=e.sent,o=new e.t0(e.t1),n.props.onReplaceRecording(r,o),n.props.onSetCurrentRecording(o),n.props.onSetVideoPlayerRecording(o);case 12:case"end":return e.stop()}}),e)}))),n.closeTrimConfirmationModal=function(){n.setState({trimConfirmationModalVisible:!1})},n.onSelectRecording=function(e){n.state.isMergingRecording&&n.setState({isMergingRecording:!1}),n.props.onSetCurrentRecording(e),n.props.onSetVideoPlayerRecording(e)},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){0===this.props.recordings.size&&this.props.onEndEdit(),this.props.currentRecording!==e.currentRecording&&this.setState({isMergingRecording:!1})}},{key:"render",value:function(){return u.createElement("div",{className:"recordings-editor"},u.createElement(ue,{selectedRecording:this.props.currentRecording,recordings:this.props.recordings,onRecordingClicked:this.onSelectRecording,selectAll:this.props.previewMergedRecording||this.state.isMergingRecording,insertIndex:-1,currentRec:null,disabled:!1,segmentTooltip:"Select"}),u.createElement(T.b,{className:"empty preview-all",loading:this.state.isMergingRecording,onClick:this.onPreviewAll,disabled:this.props.previewMergedRecording},"Preview All"),u.createElement(Re.a,{dispatch:this.props.dispatch,startOffsetTime:this.startOffsetTime,videoPlayer:this.props.videoPlayer,autoPlay:this.props.previewMergedRecording,canPlayVideo:this.props.canPlayVideo,trimDisabled:this.props.previewMergedRecording,onTrim:this.onTrim,onDelete:this.openDeleteConfirmationModal,frames:this.props.previewFrames}),u.createElement(T.b,{className:"end-edit",onClick:this.props.onEndEdit},"End Edit"),u.createElement(xe.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Recording",messages:["Are you sure you want to delete the selected recording?"],onClose:this.closeDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),u.createElement(xe.a,{visible:this.state.trimConfirmationModalVisible,title:"Trim Recording",messages:[this.confirmTrimMessage],onClose:this.closeTrimConfirmationModal,onDelete:this.onConfirmTrim}))}},{key:"recordingToPreview",get:function(){return this.props.previewMergedRecording?this.props.mergedRecording:this.props.currentRecording}},{key:"startOffsetTime",get:function(){var e=this;return this.props.previewMergedRecording||!this.props.currentRecording?0:this.props.recordings.takeUntil((function(t){return t===e.props.currentRecording})).reduce((function(e,t){return e+t.duration}),0)/1e3}},{key:"confirmTrimMessage",get:function(){if(this.state.confirmTrimDuration&&this.props.currentRecording){var e=(this.props.currentRecording.duration-this.state.confirmTrimDuration)/1e3;return"Are you sure you want to remove the last ".concat(e.toFixed(2)," seconds of the selected recording?")}return""}}]),t}(u.Component),Ne=Object(w.c)((function(e){return{recordings:e.recordingState.recordings,currentRecording:e.recordingState.currentRecording,mergedRecording:e.recordingState.mergedRecording,previewMergedRecording:e.recordingState.previewMergedRecording,previewFrames:Object(Te.h)(e)}}),(function(e){return{dispatch:e,onResetRecordings:function(){e(new v.ob)},onReplaceRecording:function(t,n){e(new v.fb(t,n))},onRemoveRecording:function(t){e(new v.db(t))},onSetCurrentRecording:function(t){e(new v.wb(t))},onSetMergedRecording:function(t){e(new v.Ab(t))},onSetPreviewMergedRecording:function(t){e(new v.Bb(!0))}}}))(Me),Ve=(n(1684),me=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={webcamStream:null,isRecording:!1},n._recEditor=new ae.h,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Object(ie.b)(),window.addEventListener("beforeunload",this.onBeforeUnload)}},{key:"componentDidUpdate",value:function(e){this.props.isPreviewing!==e.isPreviewing&&this.props.captionPlayer&&this.props.captionPlayer.reset()}},{key:"componentWillUnmount",value:function(){this.props.onResetRecordings(),window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"onBeforeUnload",value:function(e){this.props.recordings.size>0&&(e.preventDefault(),e.returnValue="Are you sure you want to leave this page? You recoding will be lost.")}},{key:"onBroadcastCamera",value:function(e){this.setState({webcamStream:e}),this.props.onBroadcastCamera&&this.props.onBroadcastCamera(e)}},{key:"onStopBroadcastCamera",value:function(){this.setState({webcamStream:null}),this.props.onStopBroadcastCamera&&this.props.onStopBroadcastCamera()}},{key:"onStartRecording",value:function(){return this.setState({isRecording:!0}),this.props.onStartRecording()}},{key:"onStopRecording",value:function(){this.setState({isRecording:!1})}},{key:"onSave",value:function(){var e=Object(re.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.mergedRecording){e.next=7;break}return e.t0=P.M,e.next=5,this._recEditor.merge(this.props.recordings);case 5:e.t1=e.sent,t=new e.t0(e.t1);case 7:this.props.onSaveMedia(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onEditLastRecording",value:function(){var e=this.props.currentRecording||this.props.recordings.last();e&&this.onEditRecording(e)}},{key:"onEditRecording",value:function(e){this.props.onSetCurrentRecording(e),this.props.onSetVideoPlayerRecording(e)}},{key:"onRecording",value:function(e,t){this.props.onAddRecording(e,t),this.props.onSetCurrentRecording(e)}},{key:"render",value:function(){return u.createElement("div",{className:"chapter-recorder-sidebar"},u.createElement("div",{className:"sidebar-content"},u.createElement("div",{className:"header"},u.createElement("h2",{className:"title"},"Record"),u.createElement("div",{className:"chapter-number"},this.chapterNumber,":"),u.createElement("div",{className:"chapter-name"},this.props.chapter.name),u.createElement("div",{className:"timer"},this.totalDurationFormatted)),u.createElement("div",{className:"camera"},u.createElement(Pe,{disabled:!this.props.isVmConnected,onBroadcastCamera:this.onBroadcastCamera,onStopBroadcastCamera:this.onStopBroadcastCamera})),u.createElement("div",{className:"recording-controls"},u.createElement(_e,{resourceLabel:"task",canExpandView:!0,vm:this.props.vm,isVmConnected:this.props.isVmConnected,dispatch:this.props.dispatch,webcamStream:this.state.webcamStream,captionPlayer:this.props.captionPlayer,recordings:this.props.recordings,onExpandModeChange:this.props.onExpandModeChange,onStartRecording:this.onStartRecording,onStopRecording:this.onStopRecording,onRecording:this.onRecording,onEdit:this.onEditLastRecording,onSelectRecording:this.onEditRecording}),u.createElement("div",{className:"actions"},u.createElement(T.b,{className:"empty",disabled:this.state.isRecording,onClick:this.props.onCancel},"Cancel"),u.createElement(T.b,{disabled:this.state.isRecording||0===this.props.recordings.size,onClick:this.onSave},"Save")))),u.createElement(se,{title:"Edit & Preview",open:this.props.isPreviewing},u.createElement(Ne,{canPlayVideo:this.props.canPlayVideo,videoPlayer:this.props.videoPlayer,onSetVideoPlayerRecording:this.props.onSetVideoPlayerRecording,onEndEdit:this.props.onPreviewDone})))}},{key:"chapterNumber",get:function(){return"Ch"+this.props.chapter.order}},{key:"totalDuration",get:function(){return this.props.recordings.reduce((function(e,t){return e+t.duration}),0)}},{key:"totalDurationFormatted",get:function(){return m.utc(this.totalDuration).format("mm:ss")}}]),t}(u.Component),Object(C.a)(me.prototype,"onBeforeUnload",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onBeforeUnload"),me.prototype),Object(C.a)(me.prototype,"onBroadcastCamera",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onBroadcastCamera"),me.prototype),Object(C.a)(me.prototype,"onStopBroadcastCamera",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onStopBroadcastCamera"),me.prototype),Object(C.a)(me.prototype,"onStartRecording",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onStartRecording"),me.prototype),Object(C.a)(me.prototype,"onStopRecording",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onStopRecording"),me.prototype),Object(C.a)(me.prototype,"onSave",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onSave"),me.prototype),Object(C.a)(me.prototype,"onEditLastRecording",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onEditLastRecording"),me.prototype),Object(C.a)(me.prototype,"onEditRecording",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onEditRecording"),me.prototype),Object(C.a)(me.prototype,"onRecording",[j.a],Object.getOwnPropertyDescriptor(me.prototype,"onRecording"),me.prototype),me),Ae=Object(w.c)((function(e){return{recordings:e.recordingState.recordings,currentRecording:e.recordingState.currentRecording,mergedRecording:e.recordingState.mergedRecording}}),(function(e){return{dispatch:e,onSetCurrentRecording:function(t){e(new v.wb(t))},onAddRecording:function(t,n){e(new v.j(n,t))},onResetRecordings:function(){e(new v.ob)}}}))(Ve),Ie=n(209),Ue=n(43),Le=n(1133),Fe=n(1118),ze=function(){var e=Object(w.d)();return u.useEffect((function(){return e(new v.bb),function(){e(new v.Ib)}}),[]),null},Be=n(1134),We=n(1091),He=n(1113),Ke=n(1119),Ye=n(1088),Ge=n(1085),Je=(n(1685),n(1135)),Ze=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"upload-progress"},u.createElement("span",{className:"label"},"Saving Progress:"),u.createElement(Je.a,{type:"thin",color:"#1B3262",progress:this.props.progress}),u.createElement("span",null,Math.round(100*this.props.progress),"%"))}}]),t}(u.PureComponent),qe=(n(1686),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement(R.a,{title:"Save as One Video",visible:this.props.visible,hideClose:!0,closeWithEsc:!1,size:"small"},u.createElement("div",{className:"confirm-save-modal form-styles"},u.createElement("p",{className:"text"},"Once this video is saved, you will be unable to edit individual recorded segments. Be sure to preview your video before saving."),u.createElement("div",{className:"confirm-save-row",style:{visibility:this.props.isSaving?"visible":"hidden"}},u.createElement(Ze,{progress:this.props.progress})),u.createElement("div",{className:"confirm-save-row actions"},u.createElement(Ge.a,{disabled:this.props.isSaving,onClick:this.props.onCancel,className:"empty"},"Cancel"),u.createElement(Ge.a,{disabled:this.props.isSaving,onClick:this.props.onConfirm},"Save"))))}}]),t}(u.Component)),Xe=(fe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){Object(O.h)(O.a.NotifiedAboutInputRecording,!0),this.props.onClose()}},{key:"render",value:function(){return u.createElement(R.a,{title:"Note",visible:this.props.visible,hideClose:!0,closeWithEsc:!1,size:"small"},u.createElement("div",{className:"input-recording-modal form-styles"},u.createElement("p",{className:"text"},"The learner will see all the keys you press in this recording. If you are entering sensitive information (e.g., passwords), please pause the recording"),u.createElement(Ge.a,{onClick:this.onClick,className:"short-btn"},"Okay")))}}]),t}(u.PureComponent),Object(C.a)(fe.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(fe.prototype,"onClick"),fe.prototype),fe),$e=(n(1687),ye=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._chapterScreenshot=null,n._gtmVmLaunchTime=null,n._captionPlayer=void 0,n._resolveInputRecordingNotify=void 0,n.state={connected:!1,canPlayVideo:!1,isPreviewViewExpanded:!1,isRecordingViewExpanded:!1,recording:void 0,videoPlayer:null,screen:null,previewViewboxVisible:!0,width:0,height:0,scaleX:0,scaleY:0,bottomBarWidth:0,videoDimm:{width:ce.a.DefaultScreenWidth,height:ce.a.DefaultScreenHeight},broadcastedCameraStream:null,isLeaveModalVisible:!1,isInputRecordingNotifyModalVisible:!1,isUploading:!1,uploadProgress:0,isConfirmSaveVisible:!1,recordingToUpload:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.adjustLayout()}},{key:"onSaveMedia",value:function(){var e=Object(re.a)(ne.a.mark((function e(t){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({recordingToUpload:t,isConfirmSaveVisible:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onSaveCancel",value:function(){this.setState({recordingToUpload:null,isConfirmSaveVisible:!1})}},{key:"onSaveConfirm",value:function(){var e=Object(re.a)(ne.a.mark((function e(){var t,n,r,o,a,i,s=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.recordingToUpload){e.next=4;break}return console.error("No recording to upload"),e.abrupt("return");case 4:return n=this.props.chapter,this.setState({isUploading:!0}),e.prev=6,o=(r=function(e,t){return function(n,r){var o=(e+r/n*(t-e))/100;s.setState({uploadProgress:o})}})(10,80),e.next=11,this._uploadVideo(n,t.videoTrack,o);case 11:return n=e.sent,o=r(80,85),a=new Blob([t.inputTrackBuffer]),e.next=16,this._uploadInput(n,a,o);case 16:return n=e.sent,o=r(85,90),i=new Blob([t.expandTrackBuffer]),e.next=21,this._uploadExpandModeData(n,i,o);case 21:return n=e.sent,o=r(90,95),e.next=25,this._updateScreenshot(n,this._chapterScreenshot,o);case 25:return n=e.sent,e.next=28,this._updateDuration(n,t.duration);case 28:n=e.sent,this.setState({isUploading:!1}),this.props.onExit(),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(6),this.setState({isUploading:!1}),console.error(e.t0);case 37:case"end":return e.stop()}}),e,this,[[6,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"onCancel",value:function(){this.onToggleLeaveModal(!0)}},{key:"onToggleLeaveModal",value:function(e){this.setState({isLeaveModalVisible:e})}},{key:"onVmInit",value:function(){var e=this.props,t=e.course,n=e.chapter,r=e.vm;this._gtmVmLaunchTime=Ue.a.recordingVmLaunchTime(t.id,n.id,r.id)}},{key:"onVmConnect",value:function(){this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this.setState({connected:!1})}},{key:"onPreviewRecording",value:function(e){this.setState({recording:e,isPreviewViewExpanded:!1})}},{key:"onVideoPlayerRef",value:function(e){this.setState({videoPlayer:e})}},{key:"onCaptionPlayerRef",value:function(e){this._captionPlayer=e}},{key:"onScreenRef",value:function(e){this.setState({screen:e})}},{key:"onPreviewViewboxToggle",value:function(e){this.setState({previewViewboxVisible:e})}},{key:"onVideoDimensions",value:function(e,t){this.setState({videoDimm:{width:e,height:t}})}},{key:"onStartRecording",value:function(){if(!this.props.chapter.screenshot&&!this._chapterScreenshot){var e=this.props.remoteClientManager.getRemoteClient(this.props.vm.id);if(e){var t=e.toDataURL("image/png",1,this.props.vm.width,this.props.vm.height,!1);this._chapterScreenshot=new Blob([Ie.a.toArrayBuffer(t)],{type:"image/png"})}}return this._notifyAboutInputRecordingIfNeeded()}},{key:"onResetRecording",value:function(){this._chapterScreenshot=null,this.setState({isRecordingViewExpanded:!1})}},{key:"onBroadcastCamera",value:function(e){this.setState({broadcastedCameraStream:e})}},{key:"onStopBroadcastCamera",value:function(){this.setState({broadcastedCameraStream:null})}},{key:"onPreviewDone",value:function(){this.setState({isPreviewViewExpanded:!1,canPlayVideo:!1,recording:void 0})}},{key:"toggleInputRecordingNotifyModal",value:function(e){this.setState({isInputRecordingNotifyModalVisible:e})}},{key:"onInputRecordingNotifyModalClose",value:function(){this.toggleInputRecordingNotifyModal(!1),this._resolveInputRecordingNotify()}},{key:"onCanPlay",value:function(e){this.setState({canPlayVideo:e})}},{key:"onPreviewExpandModeChange",value:function(e){this.setState({isPreviewViewExpanded:e===ae.e.Expand})}},{key:"onRecordingExpandModeChange",value:function(e){this.setState({isRecordingViewExpanded:e===ae.e.Expand})}},{key:"onExit",value:function(){return this.props.onExit(),Promise.resolve()}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.setState({bottomBarWidth:e+ce.a.SplitterWidth})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recorder"},u.createElement(ze,null),u.createElement(Ye.c,{rightPanelInitialSize:this.rightPanelSize,ref:function(t){return e._splitter=t},onResize:this.onResize,className:this.isCurrentViewExpanded?"expand-view-mode":""},u.createElement(u.Fragment,null,u.createElement("div",{className:"left-container",ref:this.onLeftContRef},u.createElement("div",{className:"screen-border"},this.isPreviewing&&this._renderPlayer(),this._renderScreen())),this._renderMessage(),u.createElement(Le.a,{width:this.state.bottomBarWidth},u.createElement(Be.a,{ref:this.onCaptionPlayerRef,tooltip:"The keys pressed in this recording will be shown to the learners"}))),u.createElement(Ae,{chapter:this.props.chapter,onSaveMedia:this.onSaveMedia,onSetVideoPlayerRecording:this.onPreviewRecording,onPreviewDone:this.onPreviewDone,onCancel:this.onCancel,vm:this.props.vm,isPreviewing:this.isPreviewing,course:this.props.course,videoPlayer:this.state.videoPlayer,captionPlayer:this._captionPlayer,screen:this.state.screen,canPlayVideo:this.state.canPlayVideo,isVmConnected:this.state.connected,onStartRecording:this.onStartRecording,onBroadcastCamera:this.onBroadcastCamera,onStopBroadcastCamera:this.onStopBroadcastCamera,onExpandModeChange:this.onRecordingExpandModeChange})),this._renderModals())}},{key:"_renderMessage",value:function(){var e=null;return this.state.connected&&(e=this.isCurrentViewExpanded?"Expand Mode: Learners see your full screen and can\u2019t follow along":"Collapse Mode: Learners can follow along by watching only the highlighted section of your cloud desktop"),u.createElement("div",{className:"upper-left-pane-message"},e)}},{key:"_renderScreen",value:function(){return u.createElement(We.a,{originalWidth:this.props.vm.width,originalHeight:this.props.vm.height,scaledWidth:this.state.width,style:{display:this.isPreviewing?"none":"block"}},u.createElement(He.a,{ref:this.onScreenRef,width:this.props.vm.width,height:this.props.vm.height,scaleRatio:{scaleX:this.state.scaleX,scaleY:this.state.scaleY},viewboxSize:this.viewboxSize,showViewbox:!0,isViewExpanded:this.state.isRecordingViewExpanded,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,vm:this.props.vm,cameraStream:this.state.broadcastedCameraStream,controls:!0,template:this.template,asyncActions:this.props.asyncActions}))}},{key:"_renderPlayer",value:function(){var e=this.state.recording;return u.createElement(u.Fragment,null,u.createElement(We.a,{originalWidth:this.state.videoDimm.width,originalHeight:this.state.videoDimm.height,scaledWidth:this.state.width},u.createElement(oe.b,{ref:this.onVideoPlayerRef,dispatch:this.props.dispatch,viewboxSize:this.viewboxSize,showViewbox:this.state.previewViewboxVisible,isViewExpanded:this.state.isPreviewViewExpanded,onViewboxToggle:this.onPreviewViewboxToggle,controls:!1,autoPlay:!1,captionPlayer:this._captionPlayer,src:e.mediaUrl,input:e.inputTrackBuffer,expandModeData:e.expandTrackBuffer,className:this.isPreviewing?void 0:"hidden",annotations:void 0,onVideoDimmensions:this.onVideoDimensions,onCanPlay:this.onCanPlay,onExpandModeChange:this.onPreviewExpandModeChange})))}},{key:"_renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(Fe.a,{visible:this.state.isLeaveModalVisible,onToggle:this.onToggleLeaveModal,onResolve:this.onExit}),u.createElement(Xe,{visible:this.state.isInputRecordingNotifyModalVisible,onClose:this.onInputRecordingNotifyModalClose}),u.createElement(qe,{visible:this.state.isConfirmSaveVisible,onConfirm:this.onSaveConfirm,onCancel:this.onSaveCancel,isSaving:this.state.isUploading,progress:this.state.uploadProgress}))}},{key:"_uploadVideo",value:function(e,t,n){return this.props.dispatch(this.props.asyncActions.saveChapterVideo(this.props.course.id,e,new Blob([t],{type:"video/webm"}),(function(e,t){n(e,t),console.log("Video upload progress",t,e)})))}},{key:"_uploadInput",value:function(e,t,n){return this.props.dispatch(this.props.asyncActions.saveChapterInputRecord(this.props.course.id,e.id,new Blob([t],{type:"application/octet-stream"}),(function(e,t){n(e,t),console.log("Input upload progress",t,e)})))}},{key:"_uploadExpandModeData",value:function(e,t,n){return this.props.dispatch(this.props.asyncActions.saveChapterExpandModeRecord(this.props.course.id,e.id,new Blob([t],{type:"application/octet-stream"}),(function(e,t){n(e,t),console.log("Expand mode data upload progress",t,e)})))}},{key:"_updateScreenshot",value:function(e,t,n){return e.screenshot?Promise.resolve(e):this.props.dispatch(this.props.asyncActions.saveChapterScreenshot(this.props.course.id,e.id,t,(function(e,t){n(e,t),console.log("Screenshot upload progress",t,e)}),!1))}},{key:"_updateDuration",value:function(e,t){t=Math.floor(t);var n=e.set("duration",t);return this.props.dispatch(this.props.asyncActions.updateChapter(this.props.course,n.id,n))}},{key:"_notifyAboutInputRecordingIfNeeded",value:function(){var e=this;return Object(O.d)(O.a.NotifiedAboutInputRecording)?Promise.resolve():(this.toggleInputRecordingNotifyModal(!0),new Promise((function(t){return e._resolveInputRecordingNotify=t})))}},{key:"_screenWidth",get:function(){return this.isPreviewing||this.isBroadcastingCamera?this.state.videoDimm.width:this.props.vm.width}},{key:"_screenHeight",get:function(){return this.isPreviewing||this.isBroadcastingCamera?this.state.videoDimm.height:this.props.vm.height}},{key:"template",get:function(){return this.props.templates.get(this.props.vm.templateId)}},{key:"isPreviewing",get:function(){return!!this.state.recording}},{key:"isBroadcastingCamera",get:function(){return!!this.state.broadcastedCameraStream}},{key:"viewboxSize",get:function(){return{width:ce.a.Zoom.VisibleSize.Width*(this._screenWidth/ce.a.Zoom.Sizes[60].Width),height:ce.a.Zoom.VisibleSize.Height*(this._screenHeight/ce.a.Zoom.Sizes[60].Height)}}},{key:"isCurrentViewExpanded",get:function(){return this.isPreviewing?this.state.isPreviewViewExpanded:this.state.isRecordingViewExpanded}},{key:"_verticalPadding",get:function(){return 75}}]),t}(Ke.a),Object(C.a)(ye.prototype,"onSaveMedia",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onSaveMedia"),ye.prototype),Object(C.a)(ye.prototype,"onSaveCancel",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onSaveCancel"),ye.prototype),Object(C.a)(ye.prototype,"onSaveConfirm",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onSaveConfirm"),ye.prototype),Object(C.a)(ye.prototype,"onCancel",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onCancel"),ye.prototype),Object(C.a)(ye.prototype,"onToggleLeaveModal",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onToggleLeaveModal"),ye.prototype),Object(C.a)(ye.prototype,"onVmInit",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onVmInit"),ye.prototype),Object(C.a)(ye.prototype,"onVmConnect",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onVmConnect"),ye.prototype),Object(C.a)(ye.prototype,"onVmDisconnect",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onVmDisconnect"),ye.prototype),Object(C.a)(ye.prototype,"onPreviewRecording",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onPreviewRecording"),ye.prototype),Object(C.a)(ye.prototype,"onVideoPlayerRef",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onVideoPlayerRef"),ye.prototype),Object(C.a)(ye.prototype,"onCaptionPlayerRef",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onCaptionPlayerRef"),ye.prototype),Object(C.a)(ye.prototype,"onScreenRef",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onScreenRef"),ye.prototype),Object(C.a)(ye.prototype,"onPreviewViewboxToggle",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onPreviewViewboxToggle"),ye.prototype),Object(C.a)(ye.prototype,"onVideoDimensions",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onVideoDimensions"),ye.prototype),Object(C.a)(ye.prototype,"onStartRecording",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onStartRecording"),ye.prototype),Object(C.a)(ye.prototype,"onResetRecording",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onResetRecording"),ye.prototype),Object(C.a)(ye.prototype,"onBroadcastCamera",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onBroadcastCamera"),ye.prototype),Object(C.a)(ye.prototype,"onStopBroadcastCamera",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onStopBroadcastCamera"),ye.prototype),Object(C.a)(ye.prototype,"onPreviewDone",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onPreviewDone"),ye.prototype),Object(C.a)(ye.prototype,"toggleInputRecordingNotifyModal",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"toggleInputRecordingNotifyModal"),ye.prototype),Object(C.a)(ye.prototype,"onInputRecordingNotifyModalClose",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onInputRecordingNotifyModalClose"),ye.prototype),Object(C.a)(ye.prototype,"onCanPlay",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onCanPlay"),ye.prototype),Object(C.a)(ye.prototype,"onPreviewExpandModeChange",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onPreviewExpandModeChange"),ye.prototype),Object(C.a)(ye.prototype,"onRecordingExpandModeChange",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onRecordingExpandModeChange"),ye.prototype),Object(C.a)(ye.prototype,"onExit",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onExit"),ye.prototype),Object(C.a)(ye.prototype,"onResize",[j.a],Object.getOwnPropertyDescriptor(ye.prototype,"onResize"),ye.prototype),ye),Qe=(n(1688),n(131)),et=n(1185),tt=n(9),nt=n(208),rt=n.n(nt),ot=n(1077),at=n(1103),it=(n(1689),n(1187));!function(e){e[e.InlineView=0]="InlineView",e[e.InlineEdit=1]="InlineEdit",e[e.AllEdit=2]="AllEdit"}(Oe||(Oe={}));var st,ct,pt,lt,ut,dt,ht,mt,ft,yt,vt,bt,gt,Ot,Ct,kt,jt,wt,Et=(ge=be=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={edits:Object(tt.Map)(),activeCue:void 0,mode:Oe.InlineView,invalidEditStartingTimes:Object(tt.Set)()},n._unsubscribeFromTrack=rt.a,n._focusInvalidInput=rt.a,n._entryIndex=n._entryIndicesByStartTime,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.subscribeToTrack!==this.props.subscribeToTrack&&(this._unsubscribeFromTrack(),this._subscribeToTrack()),e.subtitle!==this.props.subtitle&&(this._entryIndex=this._entryIndicesByStartTime)}},{key:"componentDidMount",value:function(){this._subscribeToTrack()}},{key:"componentWillUnmount",value:function(){this._unsubscribeFromTrack()}},{key:"renderTextarea",value:function(e){var t=e.content,n=e.startAt,r=e.id,o=void 0===r?"":r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.state,s=i.edits,c=i.invalidEditStartingTimes,p=s.get(n),l=p||t,d=c.has(n),h=d&&c.first()===n;return u.createElement("div",{className:"cc-input"},u.createElement("textarea",{key:"".concat(o).concat(l),ref:h?this._onInvalidInputRef:null,className:"cc-text","data-start":n,autoFocus:a,defaultValue:l,onBlur:this._applyEditToChunk}),d&&u.createElement("span",{className:"input-error-msg"},"Transcription cannot be empty or longer than 90 characters."))}},{key:"renderInlineEditor",value:function(e){return u.createElement(it.a,{className:"inline-editor",text:this.renderTextarea(e,!0)},u.createElement("div",{className:"controls"},u.createElement(Ge.a,{className:"empty",onClick:this._clearEditsAndViewInline},"Cancel"),u.createElement(Ge.a,{onClick:this._onSaveAll},"Save")))}},{key:"renderAllEditor",value:function(){var e=this;return u.createElement("div",{className:"all-editor"},u.createElement("ol",{className:"cc-editable-entries"},this.props.subtitle.entries.map((function(t){return u.createElement("li",{key:t.startAt,className:"editable-entry"},u.createElement("time",null,Object(ot.a)(t.startAt)),e.renderTextarea(t))}))),u.createElement("div",{className:"controls"},u.createElement(Ge.a,{className:"empty",onClick:this._clearEditsAndViewInline},"Cancel"),u.createElement(Ge.a,{onClick:this._onSaveAll},"Save")))}},{key:"renderViewer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null===e?u.createElement("span",{className:"cc-pending-message cc-placeholder-message"},"Your transcriptions will show here."):e;return u.createElement(it.a,{key:this.props.subtitle.id,className:"inline-viewer",text:t,hidden:this.props.hidden},u.createElement("div",{className:"controls"},u.createElement(Ge.a,{disabled:null===e,onClick:this._onInlineEdit},"Edit"),u.createElement(Ge.a,{onClick:this._onEditAll},"Edit all")))}},{key:"render",value:function(){if(Object(at.b)(this.props.subtitle))return u.createElement(it.a,{hidden:this.props.hidden,text:u.createElement("span",{className:"cc-pending-message"},"We're generating transcriptions for this video. They will be available shortly.")});if(this.state.mode===Oe.AllEdit)return this.renderAllEditor();if(!this.state.activeCue)return this.renderViewer();var e=Math.round(1e3*this.state.activeCue.startTime),t=this._entryContentAtStart(e,this.state.activeCue.text);switch(this.state.mode){case Oe.InlineView:return this.renderViewer(t);case Oe.InlineEdit:return this.renderInlineEditor({startAt:e,content:t});default:return null}}},{key:"_subscribeToTrack",value:function(){this._unsubscribeFromTrack=this.props.subscribeToTrack(this._onCueChange)}},{key:"_onInvalidInputRef",value:function(e){this._focusInvalidInput=function(){e.scrollIntoView(),e.focus(),e.setSelectionRange(0,e.value.length)}}},{key:"_applyEditToChunk",value:function(e){var n=e.target;if(n.defaultValue!==n.value){var r=Number(n.getAttribute("data-start")),o=this.state.invalidEditStartingTimes;this.setState({edits:this.state.edits.set(r,n.value),invalidEditStartingTimes:t._isEditValid(n.value)?o.remove(r):o.add(r)})}}},{key:"_onSaveAll",value:function(){var e=Object(re.a)(ne.a.mark((function e(){var t,n=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.invalidEditStartingTimes.size>0)){e.next=3;break}return this._focusInvalidInput(),e.abrupt("return");case 3:if(!this.state.edits.isEmpty()){e.next=5;break}return e.abrupt("return");case 5:return t=this.props.subtitle.entries.reduce((function(e,t){var r=n.state.edits.get(t.startAt);return r?e.push(t.set("content",r)):e}),Object(tt.List)()).toArray(),e.next=8,this.props.onCCEdit(t);case 8:this._clearEditsAndViewInline();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearEditsAndViewInline",value:function(){this._changeMode(Oe.InlineView),this.setState({edits:Object(tt.Map)()})}},{key:"_onInlineEdit",value:function(){this._changeMode(Oe.InlineEdit)}},{key:"_onEditAll",value:function(){this._changeMode(Oe.AllEdit)}},{key:"_onCueChange",value:function(e){var t=e.srcElement.track;this.setState({activeCue:t.activeCues[0]})}},{key:"_changeMode",value:function(e){var t=this;if(this.state.mode!==e){var n=this.state.mode;this.setState({mode:e},(function(){t.props.onModeChange&&t.props.onModeChange(e,n)}))}}},{key:"_entryContentAtStart",value:function(e,t){var n=this.state.edits.get(e);if(n)return n;var r=this._entryIndex.get(e),o=this.props.subtitle.entries.get(r);return void 0!==r&&o?o.content:(console.error("Couldn't lookup subtitle entry[".concat(r,"] for starting time ").concat(e)),t)}},{key:"_entryIndicesByStartTime",get:function(){return Object(tt.Map)(this.props.subtitle.entries.map((function(e,t){return[e.startAt,t]})))}}]),t}(u.PureComponent),be._isEditValid=function(e){return e.length>0&&e.length<90},ve=ge,Object(C.a)(ve.prototype,"_onInvalidInputRef",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_onInvalidInputRef"),ve.prototype),Object(C.a)(ve.prototype,"_applyEditToChunk",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_applyEditToChunk"),ve.prototype),Object(C.a)(ve.prototype,"_onSaveAll",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_onSaveAll"),ve.prototype),Object(C.a)(ve.prototype,"_clearEditsAndViewInline",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_clearEditsAndViewInline"),ve.prototype),Object(C.a)(ve.prototype,"_onInlineEdit",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_onInlineEdit"),ve.prototype),Object(C.a)(ve.prototype,"_onEditAll",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_onEditAll"),ve.prototype),Object(C.a)(ve.prototype,"_onCueChange",[j.a],Object.getOwnPropertyDescriptor(ve.prototype,"_onCueChange"),ve.prototype),ve),_t=n(1106),St=(n(1690),n(93)),Dt=n(1218),Pt=function(e){return Object(x.c)(e/1e3)},Tt=function(e){return new T.i({id:e.id,time:Pt(e.time),content:e.content})},Rt=function(e){return new P.b({id:e.id,time:Object(Dt.a)(e.time),content:e.content})},xt=(st=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._annotationsListRef=void 0,n._dirty=Object(tt.List)([]),n.state={loading:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&this.addNewAnnotation(),!this.props.visible&&e.visible&&this.props.reset()}},{key:"onAnnotationDelete",value:function(e){var t=this,n=Promise.resolve(),r=!0;if(e.id){var o=Rt(e);r=!1,n=this.props.deleteAnnotation(o)}return n.then((function(){return t.props.showGeneralNotification("Annotation successfully deleted"),r}))}},{key:"onDirtyAnnotations",value:function(e){this._dirty=e}},{key:"onRef",value:function(e){this._annotationsListRef=e}},{key:"addNewAnnotation",value:function(e){var t=this;e&&e.preventDefault();var n=new T.i({time:Pt(this.props.currentTimestamp),content:""}),r=this.props.annotations.push(n);this.props.change("annotations",r),setTimeout((function(){t._annotationsListRef&&t._annotationsListRef.openLastAnnotation()}))}},{key:"saveAnnotations",value:function(e){var t=this;if(e.preventDefault(),this.props.annotations){this.setState({loading:!0});var n=[];this.props.annotations.forEach((function(e,r){t._dirty.indexOf(r)>-1&&n.push(t._saveAnnotation(e))})),Promise.all(n).then((function(){t._annotationsListRef&&t._annotationsListRef.cleanse(),t.props.showGeneralNotification("Annotation".concat(n.length>1?"s":""," successfully saved"))})).finally((function(){return t.setState({loading:!1})}))}}},{key:"render",value:function(){return u.createElement("div",{className:"annotations-modal form-styles"},u.createElement(R.a,{title:"Annotate Task",visible:this.props.visible,onToggle:this.props.onToggle,scrollable:!0,autoScrollToBottom:!0,size:"medium"},u.createElement("p",{className:"text"},"Show your learners annotations at these moments in the task"),u.createElement("form",{className:"annotations"},u.createElement(_.a,Object.assign({name:"annotations",component:T.o},{chapterDuration:this.props.duration,onDelete:this.onAnnotationDelete,onDirty:this.onDirtyAnnotations,onRef:this.onRef})),u.createElement("div",{className:"add-button",onClick:this.addNewAnnotation},"Add Annotation"),u.createElement(T.b,{onClick:this.saveAnnotations,loading:this.state.loading,disabled:!this.props.valid||this.props.pristine},"Save"))))}},{key:"_saveAnnotation",value:function(e){var t=Rt(e);return e.id?this.props.updateAnnotation(t):this.props.createAnnotation(t)}}]),t}(u.PureComponent),Object(C.a)(st.prototype,"onAnnotationDelete",[j.a],Object.getOwnPropertyDescriptor(st.prototype,"onAnnotationDelete"),st.prototype),Object(C.a)(st.prototype,"onDirtyAnnotations",[j.a],Object.getOwnPropertyDescriptor(st.prototype,"onDirtyAnnotations"),st.prototype),Object(C.a)(st.prototype,"onRef",[j.a],Object.getOwnPropertyDescriptor(st.prototype,"onRef"),st.prototype),Object(C.a)(st.prototype,"addNewAnnotation",[j.a],Object.getOwnPropertyDescriptor(st.prototype,"addNewAnnotation"),st.prototype),Object(C.a)(st.prototype,"saveAnnotations",[j.a],Object.getOwnPropertyDescriptor(st.prototype,"saveAnnotations"),st.prototype),st),Mt=Object(S.a)({form:"annotationsForm",validate:T.G,enableReinitialize:!0})(xt),Nt=Object(D.a)("annotationsForm"),Vt=Object(w.c)((function(e,t){return{annotations:Nt(e,"annotations"),initialValues:{annotations:(n=t.chapter.annotations,n.sort((function(e,t){return e.time-t.time})).map(Tt).toList())}};var n}),(function(e,t){var n=t.course,r=t.chapter;return{createAnnotation:function(t){return e(St.a.createAnnotation(n,r,t))},updateAnnotation:function(t){return e(St.a.updateAnnotation(n,r,t))},deleteAnnotation:function(t){return e(St.a.deleteAnnotation(n,r,t))},showGeneralNotification:function(t){return e(new v.i(new P.I({type:P.J.General,text:t})))}}}))(Mt),At=(n(1691),n(1051)),It=n(1692),Ut=296,Lt=224,Ft={createLabel:"Take Screenshot",changeLabel:"Change Screenshot"},zt=(ct=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onTakeScreenshot",value:function(e){e.preventDefault(),this.props.onTakeScreenshot()}},{key:"render",value:function(){var e=this.props.labels||Ft;return u.createElement("div",{className:"screenshot-picker"+(this.props.className?" ".concat(this.props.className):"")},this.props.image?u.createElement("div",{className:"screenshot-wrapper"+(this.props.disabled?" disabled":""),style:this.styles},u.createElement("img",{src:this.props.image,className:"screenshot",onClick:this.props.onTakeScreenshot}),u.createElement("div",{className:"change-layer"},u.createElement(T.b,{loading:this.props.loading,onClick:this.onTakeScreenshot,type:"button"},e.changeLabel))):u.createElement("div",{className:"shot",onClick:this.props.onTakeScreenshot,style:this.styles},this.props.loading?u.createElement(At.a,null):u.createElement(u.Fragment,null,u.createElement("img",{src:It}),u.createElement(T.b,{className:"empty",onClick:function(e){return e.preventDefault()},type:"button"},e.createLabel))))}},{key:"styles",get:function(){var e=this.props,t=e.width,n=e.height;return{width:t||Ut,height:n||Lt}}}]),t}(u.PureComponent),Object(C.a)(ct.prototype,"onTakeScreenshot",[j.a],Object.getOwnPropertyDescriptor(ct.prototype,"onTakeScreenshot"),ct.prototype),ct),Bt=n(1111),Wt=(n(1693),pt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={playing:!1,currentTime:0,playerKeyhole:!0,playbackRate:n.props.videoPlayer?n.props.videoPlayer.playbackRate:oe.a.x100},n._controlsService=void 0,n._initControlsService(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.chapter,r=t.course,o=t.canPlayVideo;this.props.videoPlayer!==e.videoPlayer&&this._controlsService.setRefs(this.props.videoPlayer),n===e.chapter&&r===e.course||this._controlsService.updateProps({currentChapter:n,course:r}),o&&!e.canPlayVideo&&this._controlsService.onPlay()}},{key:"componentWillUnmount",value:function(){this._controlsService.destroy()}},{key:"onPreviewDone",value:function(){this.props.onPreviewDone(),this.setState({currentTime:0,playing:!1})}},{key:"onAnnotationsEdit",value:function(){this._controlsService.onPause(),this.props.onAnnotationsEdit()}},{key:"onPreviewViewboxToggle",value:function(){if(this.props.videoPlayer){var e=this.props.videoPlayer.toggleViewbox();this.setState({playerKeyhole:e})}}},{key:"onPlaybackRateChange",value:function(e){this.props.videoPlayer&&(this.props.videoPlayer.changePlaybackRate(e),this.setState({playbackRate:e}))}},{key:"render",value:function(){return this.props.videoPlayer?u.createElement("div",{className:"chapter-previewer"},u.createElement(Bt.a,{theme:"dark",controls:{viewbox:!0},playing:this.state.playing,duration:this.props.videoPlayer.duration||0,currentTime:this.state.currentTime,playerKeyhole:this.state.playerKeyhole,playbackRate:this.state.playbackRate,showCC:this.props.showCC,backwardDisabled:!this._controlsService.hasPrevChapter,forwardDisabled:!this._controlsService.hasNextChapter,onPlay:this._controlsService.onPlay,onPause:this._controlsService.onPause,onSeek:this._controlsService.onSeek,onForward:this._controlsService.onForward,onBackward:this._controlsService.onBackward,onPreviewViewboxToggle:this.onPreviewViewboxToggle,onPlaybackRateChange:this.onPlaybackRateChange,navigationHidden:!this.props.chapterNavigation,disableAll:!this.props.canPlayVideo,onCCToggle:this.props.onCCToggle}),u.createElement("div",{className:"actions"},u.createElement(T.b,{className:"small empty annotate",onClick:this.onAnnotationsEdit},"Annotate"),u.createElement(T.b,{className:"small end-preview",onClick:this.onPreviewDone},"End Preview"))):null}},{key:"_initControlsService",value:function(){var e=this,t=this.props,n=t.chapter,r=t.course;this._controlsService=new Bt.b(this.props.dispatch,{currentChapter:n,course:r}),this._controlsService.onPlayerPlaying((function(t){return e.setState({playing:t})})),this._controlsService.onPlayerTimeUpdated((function(t){return e.setState({currentTime:t})}))}}]),t}(u.Component),Object(C.a)(pt.prototype,"onPreviewDone",[j.a],Object.getOwnPropertyDescriptor(pt.prototype,"onPreviewDone"),pt.prototype),Object(C.a)(pt.prototype,"onAnnotationsEdit",[j.a],Object.getOwnPropertyDescriptor(pt.prototype,"onAnnotationsEdit"),pt.prototype),Object(C.a)(pt.prototype,"onPreviewViewboxToggle",[j.a],Object.getOwnPropertyDescriptor(pt.prototype,"onPreviewViewboxToggle"),pt.prototype),Object(C.a)(pt.prototype,"onPlaybackRateChange",[j.a],Object.getOwnPropertyDescriptor(pt.prototype,"onPlaybackRateChange"),pt.prototype),pt),Ht=(n(1694),function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={isSavingScreenshot:!1},n.onTakeScreenshot=function(){var e=null;n.props.videoPlayer&&(e=n.props.videoPlayer.takeScreenshot()),e&&(n.setState({isSavingScreenshot:!0}),n.props.dispatch(n.props.asyncActions.saveChapterScreenshot(n.props.course.id,n.props.chapter.id,e,(function(e,t){console.log("Screenshot upload progress",e,t)}))).finally((function(){return n.setState({isSavingScreenshot:!1})})))},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"chapter-preview-sidebar"},u.createElement("div",{className:"sidebar-content"},u.createElement("div",{className:"header"},u.createElement("h2",{className:"title"},"Preview"),u.createElement("div",{className:"chapter-number"},this.chapterNumber,":"),u.createElement("div",{className:"chapter-name"},this.props.chapter.name),u.createElement("div",{className:"timer"},this.totalDuration)),u.createElement("div",{className:"screenshot"},u.createElement("div",{className:"screenshot-title"},"Preview"),u.createElement(zt,{image:this.props.chapter.screenshot,onTakeScreenshot:this.onTakeScreenshot,loading:this.state.isSavingScreenshot}),u.createElement("div",{className:"screenshot-description"},"Take a relevant and interesting looking screenshot to make the task more attractive to learners")),u.createElement(Wt,{chapter:this.props.chapter,course:this.props.course,asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,chapterNavigation:!0,onPreviewDone:this.props.onPreviewDone,onAnnotationsEdit:this.props.onAnnotationsEdit,videoPlayer:this.props.videoPlayer,canPlayVideo:this.props.canPlayVideo,showCC:this.props.showCC,onCCToggle:this.props.onCCToggle})))}},{key:"chapterNumber",get:function(){return"Ch"+this.props.chapter.order}},{key:"totalDuration",get:function(){return f.a.utc(this.props.chapter.duration).format("mm:ss")}}]),t}(u.Component)),Kt=(dt=ut=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={minDetailsSize:0,bottomBarWidth:0,chapterPlayerRef:null,playerViewboxVisible:!0,annotationsModalVisible:!1,canPlayVideo:!1,isViewExpanded:!1,width:0,height:0,scaleX:0,scaleY:0,videoDimm:{width:ce.a.DefaultScreenWidth,height:ce.a.DefaultScreenHeight},showCC:!0},n._captionPlayer=void 0,n._videoTrackHub=Object(_t.b)(),n._keyboardActionHandlers={"video.toggleCC":n.onTranscriptionsToggle},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._loadSubtitleEntries()}},{key:"componentDidUpdate",value:function(e){this.adjustLayout();var t=this._getCurrentChapter(e);this._getCurrentChapter(this.props).id!==t.id&&this.setState({isViewExpanded:!1})}},{key:"onPlayerRef",value:function(e){this.setState({chapterPlayerRef:e})}},{key:"onCaptionPlayerRef",value:function(e){this._captionPlayer=e}},{key:"onViewboxToggle",value:function(e){this.setState({playerViewboxVisible:e})}},{key:"onVideoDimmensions",value:function(e,t){this.setState({videoDimm:{width:e,height:t}})}},{key:"onCanPlay",value:function(e){this.setState({canPlayVideo:e})}},{key:"onToggleAnnotationsModal",value:function(e){this.setState({annotationsModalVisible:e})}},{key:"onExpandModeChange",value:function(e){this.setState({isViewExpanded:e===ae.e.Expand})}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.setState({bottomBarWidth:e+ce.a.SplitterWidth})}},{key:"onTranscriptionsToggle",value:function(){this.setState({showCC:!this.state.showCC})}},{key:"onCCEdit",value:function(e){var t=this.props,n=t.dispatch,r=t.chapter,o=t.course,a=t.asyncActions,i=this.subtitle;if(i)return n(a.updateSubtitleEntries(o,r,i,e))}},{key:"onCCEditModeChanged",value:function(e){e!==Oe.InlineView&&this.state.chapterPlayerRef&&this.state.chapterPlayerRef.pause()}},{key:"renderCCEditor",value:function(){var e=this.subtitle;return e?u.createElement(Et,{subtitle:e,hidden:!this.state.showCC,subscribeToTrack:this._videoTrackHub.subscribeToTrack,onCCEdit:this.onCCEdit,onModeChange:this.onCCEditModeChanged}):null}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"chapter-preview"},u.createElement(ze,null),u.createElement(Qe.Hotkeys,{handlers:this._keyboardActionHandlers}),u.createElement(Ye.c,{ref:function(t){return e._splitter=t},rightPanelInitialSize:this.rightPanelSize,onResize:this.onResize,className:this.className},u.createElement(u.Fragment,null,u.createElement("div",{className:"left-container",ref:this.onLeftContRef},u.createElement("div",{className:"video-container"},u.createElement(We.a,{originalWidth:this.state.videoDimm.width,originalHeight:this.state.videoDimm.height,scaledWidth:this.state.width},u.createElement(et.a,{captionPlayer:this._captionPlayer||void 0,viewboxSize:{width:ce.a.Zoom.VisibleSize.Width*(this.state.videoDimm.width/ce.a.Zoom.Sizes[60].Width),height:ce.a.Zoom.VisibleSize.Height*(this.state.videoDimm.height/ce.a.Zoom.Sizes[60].Height)},showViewbox:this.state.playerViewboxVisible,isViewExpanded:this.state.isViewExpanded,onViewboxToggle:this.onViewboxToggle,controls:!1,chapter:this.chapter,ref:this.onPlayerRef,dispatch:this.props.dispatch,onVideoDimmensions:this.onVideoDimmensions,onCanPlay:this.onCanPlay,onExpandModeChange:this.onExpandModeChange,onCueChange:this._videoTrackHub.emitTrackEvent,mouse:!0})))),this.renderCCEditor(),this._renderMessage(),u.createElement(Le.a,{width:this.state.bottomBarWidth},u.createElement(Be.a,{ref:this.onCaptionPlayerRef,tooltip:"The keys pressed in this recording will be shown to the learners"}))),u.createElement("div",{className:"chapter-preview-side-panel"},u.createElement(Ht,{course:this.props.course,chapter:this.chapter,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,videoPlayer:this.state.chapterPlayerRef,onPreviewDone:this.props.onExit,onAnnotationsEdit:function(){return e.onToggleAnnotationsModal(!0)},canPlayVideo:this.state.canPlayVideo,onCCToggle:this.onTranscriptionsToggle,showCC:this.state.showCC}))),this.state.chapterPlayerRef&&u.createElement(Vt,{currentTimestamp:1e3*Math.round(this.state.chapterPlayerRef.currentTime),chapter:this.props.chapter,course:this.props.course,duration:this.state.chapterPlayerRef.duration,visible:this.state.annotationsModalVisible,onToggle:this.onToggleAnnotationsModal}))}},{key:"_loadSubtitleEntries",value:function(){var e=this.subtitle;if(e){var t=this.props,n=t.dispatch,r=t.chapter,o=t.course;n(t.asyncActions.loadChapterSubtitleEntries(o,r,e))}}},{key:"_renderMessage",value:function(){var e=null;return this.state.canPlayVideo&&(e=this.state.isViewExpanded?"Expand Mode: Learners see your full screen and can\u2019t follow along":"Collapse Mode: Learners can follow along by watching only the highlighted section of your cloud desktop"),u.createElement("div",{className:"upper-left-pane-message"},e)}},{key:"_getCurrentChapter",value:function(e){return e.course.chapters.find((function(t){return t.id===e.currentChapter}))||e.chapter}},{key:"className",get:function(){return"chapter-player-with-details"+(this.state.isViewExpanded?" expand-view-mode":"")}},{key:"chapter",get:function(){return this._getCurrentChapter(this.props)}},{key:"subtitle",get:function(){var e=this.props,t=e.chapter,n=e.subtitleLang;return t.subtitles.get(n)||t.subtitles.first()}},{key:"_screenWidth",get:function(){return this.state.videoDimm.width}},{key:"_screenHeight",get:function(){return this.state.videoDimm.height}},{key:"_verticalPadding",get:function(){return 75}}]),t}(Ke.a),ut.defaultProps={subtitleLang:P.X.enUS},lt=dt,Object(C.a)(lt.prototype,"onPlayerRef",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onPlayerRef"),lt.prototype),Object(C.a)(lt.prototype,"onCaptionPlayerRef",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onCaptionPlayerRef"),lt.prototype),Object(C.a)(lt.prototype,"onViewboxToggle",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onViewboxToggle"),lt.prototype),Object(C.a)(lt.prototype,"onVideoDimmensions",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onVideoDimmensions"),lt.prototype),Object(C.a)(lt.prototype,"onCanPlay",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onCanPlay"),lt.prototype),Object(C.a)(lt.prototype,"onToggleAnnotationsModal",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onToggleAnnotationsModal"),lt.prototype),Object(C.a)(lt.prototype,"onExpandModeChange",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onExpandModeChange"),lt.prototype),Object(C.a)(lt.prototype,"onResize",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onResize"),lt.prototype),Object(C.a)(lt.prototype,"onTranscriptionsToggle",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onTranscriptionsToggle"),lt.prototype),Object(C.a)(lt.prototype,"onCCEdit",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onCCEdit"),lt.prototype),Object(C.a)(lt.prototype,"onCCEditModeChanged",[j.a],Object.getOwnPropertyDescriptor(lt.prototype,"onCCEditModeChanged"),lt.prototype),lt),Yt=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"requestVm",value:function(){var e=this,t=this._instance,n=t.course,r=t.props;return n?r.dispatch(r.asyncActions.getCourseVMAndConnection(n,r.asyncActions)).then((function(t){var n;t instanceof P.kb?n=t:e._instance.course&&(n=e._instance.props.vms.get(e._instance.course.virtualMachineId)),n&&e._instance.setState({courseVmId:n.id})})):Promise.reject()}}]),e}(),Gt=(n(1695),n(1136)),Jt=(n(1696),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).diff=0,n.timerRef=void 0,n.state={timePassed:0},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.autoStart&&this.start(),this.props.onRef&&this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.stop(),this.props.onRef&&this.props.onRef(void 0)}},{key:"start",value:function(){var e=this,t=(new Date).getTime();!function n(){var r=(new Date).getTime()-t+e.diff;Math.round(t/1e3)!==Math.round(r/1e3)&&(e.setState({timePassed:r}),e.props.onTick&&e.props.onTick(r)),e.timerRef&&clearTimeout(e.timerRef),e.timerRef=setTimeout(n,100)}()}},{key:"stop",value:function(){this.diff=0,clearTimeout(this.timerRef)}},{key:"pause",value:function(){this.diff=this.state.timePassed,clearTimeout(this.timerRef)}},{key:"render",value:function(){var e=m.duration(this.state.timePassed),t=function(e){return 1===e.toString().length?"0"+e:e};return u.createElement("div",{className:"stopwatch tooltip rel b ra","data-tooltip":"Time spent using the cloud desktop"},u.createElement("div",{className:"clock"}),u.createElement("span",null,t(e.hours())+":"+t(e.minutes())+":"+t(e.seconds())))}}]),t}(u.Component)),Zt=(ht=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._stopwatch=void 0,n._gtmVmLaunchTime=null,n.state={connected:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onVmInit",value:function(){this._gtmVmLaunchTime=Ue.a.customizeVmLaunchTime(this.props.vm.id)}},{key:"onVmConnect",value:function(){this._stopwatch&&this._stopwatch.start(),this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this._stopwatch&&this._stopwatch.pause(),this.setState({connected:!1})}},{key:"render",value:function(){var e=this,t=u.Children.map(this.props.children,(function(t){return u.cloneElement(t,{connected:e.state.connected})}));return u.createElement("div",{className:"customize-dashboard-vm"},u.createElement(Gt.a,{vm:this.props.vm,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,controls:!0,asyncActions:this.props.asyncActions},u.createElement("div",{className:"cvm-wizard"},u.createElement("div",{className:"logo-container"},u.createElement("div",{className:"logo"}),u.createElement(Jt,{onRef:function(t){return e._stopwatch=t}})),u.createElement("h3",null,"Customize Cloud Desktop"),t)))}}]),t}(u.Component),Object(C.a)(ht.prototype,"onVmInit",[j.a],Object.getOwnPropertyDescriptor(ht.prototype,"onVmInit"),ht.prototype),Object(C.a)(ht.prototype,"onVmConnect",[j.a],Object.getOwnPropertyDescriptor(ht.prototype,"onVmConnect"),ht.prototype),Object(C.a)(ht.prototype,"onVmDisconnect",[j.a],Object.getOwnPropertyDescriptor(ht.prototype,"onVmDisconnect"),ht.prototype),ht),qt=(n(1697),mt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._keyUpCb=void 0,n.state={stepIndex:0,completionInProgress:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this._keyUpCb=function(t){t.keyCode===ke.f&&e.state.stepIndex===e.props.children.length-1&&e.next()})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this._keyUpCb)}},{key:"prev",value:function(){this.state.stepIndex>0?this._changeStep(-1):this.props.onExit&&this.props.onExit()}},{key:"next",value:function(){var e=this;this.state.stepIndex<this.children.length-1?this._changeStep(1):this.props.onComplete&&(this.setState({completionInProgress:!0}),this.props.onComplete().catch((function(){e.setState({completionInProgress:!1})})))}},{key:"render",value:function(){var e=this.children.length,t=this.state.stepIndex,n=this.children[t];return u.createElement("div",{className:"step-wizard "+this.props.className},u.createElement("p",{className:"step-title"},this.children.length>1?"".concat(t+1,"/").concat(this.children.length,":"):""," ",n.props.title),this.children.map((function(e,n){return u.createElement("div",{key:"step-"+n,style:{display:t===n?"block":"none"}},e)})),u.createElement("div",{className:"controls"},u.createElement(T.b,{className:"btn small empty prev",onClick:this.prev,disabled:n.props.disablePrev||this.state.completionInProgress},0===t?"Cancel":"Back"),u.createElement(T.b,{className:"btn small next",onClick:this.next,disabled:n.props.disableNext,loading:this.state.completionInProgress},t===e-1?"Save":"Next")))}},{key:"_changeStep",value:function(e){var t=this;this.setState({stepIndex:this.state.stepIndex+e},(function(){t.props.onStepChange&&t.props.onStepChange(t.state.stepIndex)}))}},{key:"children",get:function(){return this.props.children instanceof Array?this.props.children:[this.props.children]}}]),t}(u.Component),Object(C.a)(mt.prototype,"prev",[j.a],Object.getOwnPropertyDescriptor(mt.prototype,"prev"),mt.prototype),Object(C.a)(mt.prototype,"next",[j.a],Object.getOwnPropertyDescriptor(mt.prototype,"next"),mt.prototype),mt),Xt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.props.children}}]),t}(u.Component),$t=(n(1698),n(1130)),Qt=n(1699),en=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props;return u.createElement("div",{className:"custom-vm-file-uploader"},u.createElement($t.a,{dispatch:e.dispatch,disabled:e.disabled,vms:[e.vm],remoteClientManager:e.remoteClientManager,label:u.createElement("span",{className:"ua-label"},u.createElement(T.b,{className:"empty"},"Upload file here"),u.createElement("p",{className:"size"},"Max 200MB")),uploadIcon:u.createElement("img",{src:Qt}),onFileUploadStart:e.onUploadStart,onCompleted:e.onUploadEnd,onError:e.onUploadEnd}))}}]),t}(u.PureComponent),tn=function(e){return u.createElement("div",{className:"file-upload-step step"},u.createElement(en,{dispatch:e.dispatch,disabled:e.disabled,onUploadEnd:e.onUploadEnd,onUploadStart:e.onUploadStart,remoteClientManager:e.remoteClientManager,vm:e.vm}),u.createElement("ul",null,u.createElement("li",null,"Upload files you want learners to use during the session."),u.createElement("li",null,"You can also use any upload service like"," ",u.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io"),"."),u.createElement("li",null,"E.g., To teach Accounting, upload a sample statements file that you will ask learners to import to Excel.")))},nn=(n(1700),ft=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={image:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.templateName===e.templateName&&this.props.valid===e.valid||!this.props.onTemplateNameUpdate||this.props.onTemplateNameUpdate(this.props.templateName||"",this.props.valid||!1)}},{key:"takeScreenshot",value:function(){var e=this,t=this.props.remoteClientManager.getRemoteClient(this.props.vm.id);if(t){var n=t.toDataURL("image/png",1,800,600,!1);n&&this.setState({image:n},(function(){e.props.onScreenshotUpdate(n)}))}}},{key:"render",value:function(){return u.createElement("div",{className:"step screenshot-step"},u.createElement(zt,{image:this.state.image,onTakeScreenshot:this.takeScreenshot}),u.createElement("ul",null,u.createElement("li",null,"To make the cloud desktop easy to identify, set it in the right visual state and click \u201cTake Screenshot.\u201d"),u.createElement("li",null,"Finally, type a descriptive name and click \u201cSave.\u201d")),this.props.onTemplateNameUpdate&&u.createElement("h3",null,"Name This Cloud Desktop"),u.createElement("form",{name:"templateNameForm",style:{display:this.props.onTemplateNameUpdate?"block":"none"},onSubmit:function(e){return e.preventDefault()}},u.createElement(_.a,Object.assign({name:"templateName",type:"text",autoComplete:"off",component:T.s},{label:"Name"}))))}}]),t}(u.Component),Object(C.a)(ft.prototype,"takeScreenshot",[j.a],Object.getOwnPropertyDescriptor(ft.prototype,"takeScreenshot"),ft.prototype),ft),rn=Object(S.a)({form:"templateNameForm",validate:T.K})(nn),on=Object(D.a)("templateNameForm"),an=Object(w.c)((function(e){return{templateName:on(e,"templateName")}}))(rn),sn=n(1701),cn=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:sn})),u.createElement("ul",null,u.createElement("li",null,"Configure software (and Windows) so learners don\u2019t need to worry about it."),u.createElement("li",null,"E.g., Disable update prompts, set preferences, put files in Startup folder so they automatically open when session starts.")))},pn=n(1702),ln=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:pn})),u.createElement("ul",null,u.createElement("li",null,"Use licenses that allow software to run on multiple instances."),u.createElement("li",null,"E.g., Use software with no install limits, use site-wide license, use per-user license, etc.")))},un=n(1703),dn=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:un})),u.createElement("ul",null,u.createElement("li",null,"Install your software on the cloud desktop on the left."),u.createElement("li",null,"E.g., To teach Accounting, install Excel and Quickbooks."),u.createElement("li",null,"Click \u201cNext\u201d when done.")))},hn=(yt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={image:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onScreenshotUpdate",value:function(e){this.setState({image:e})}},{key:"updateScreenshotAndExit",value:function(){var e=this;if(!this.props.template)return Promise.reject("Missing template");var t=new Blob([Ie.a.toArrayBuffer(this.state.image)],{type:"image/png"}),n=this.props.asyncActions.saveTemplateScreenshot(this.props.template,t);return this.props.dispatch(n).then((function(){e.props.dispatch(new v.i(new P.I({type:P.J.General,text:"Screenshot successfully updated"}))),e.exit()}))}},{key:"exit",value:function(){this.props.onExit()}},{key:"render",value:function(){return u.createElement(u.Fragment,null,u.createElement(qt,{className:"customize-vm-wizard",onComplete:this.updateScreenshotAndExit,onExit:this.exit},u.createElement(Xt,{title:"Screenshot",disableNext:!this.state.image},u.createElement(an,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onScreenshotUpdate:this.onScreenshotUpdate}))))}}]),t}(u.Component),Object(C.a)(yt.prototype,"onScreenshotUpdate",[j.a],Object.getOwnPropertyDescriptor(yt.prototype,"onScreenshotUpdate"),yt.prototype),Object(C.a)(yt.prototype,"updateScreenshotAndExit",[j.a],Object.getOwnPropertyDescriptor(yt.prototype,"updateScreenshotAndExit"),yt.prototype),Object(C.a)(yt.prototype,"exit",[j.a],Object.getOwnPropertyDescriptor(yt.prototype,"exit"),yt.prototype),yt),mn=function(e){return u.createElement("div",{className:"step"},u.createElement(en,{dispatch:e.dispatch,disabled:e.disabled,vm:e.vm,remoteClientManager:e.remoteClientManager,onUploadStart:e.onUploadStart,onUploadEnd:e.onUploadEnd}),u.createElement("ul",null,u.createElement("li",null,"Install software, upload files, modify software licenses, configure software or operating system, etc."),u.createElement("li",null,"You can also use any upload service like"," ",u.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io"),"."),u.createElement("li",null,"When you are done, click \u201cSave\u201d")))},fn=(vt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={uploading:!1,isLeaveModalVisible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onUploadStart",value:function(){this.setState({uploading:!0})}},{key:"onUploadEnd",value:function(){this.setState({uploading:!1})}},{key:"updateAndExit",value:function(){var e=this;if(this.props.template){var t=this.props,n=t.dispatch,r=t.asyncActions;return n(r.updateTemplateImage(this.props.vm,this.props.template)).then((function(){n(new v.i(new P.I({type:P.J.General,text:"Cloud desktop successfully updated"}))),e.props.onExit()}))}}},{key:"exit",value:function(){this.onToggleLeaveModal(!0)}},{key:"onToggleLeaveModal",value:function(e){this.setState({isLeaveModalVisible:e})}},{key:"onExit",value:function(){return this.props.onExit(),Promise.resolve()}},{key:"render",value:function(){return u.createElement(u.Fragment,null,u.createElement(qt,{className:"customize-vm-wizard",onComplete:this.updateAndExit,onExit:this.exit},u.createElement(Xt,{title:this.props.template?this.props.template.name:"",disablePrev:this.state.uploading,disableNext:this.state.uploading||!this.props.connected},u.createElement(mn,{dispatch:this.props.dispatch,disabled:!this.props.connected,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd}))),u.createElement(Fe.a,{visible:this.state.isLeaveModalVisible,onToggle:this.onToggleLeaveModal,onResolve:this.onExit}))}}]),t}(u.Component),Object(C.a)(vt.prototype,"onUploadStart",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"onUploadStart"),vt.prototype),Object(C.a)(vt.prototype,"onUploadEnd",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"onUploadEnd"),vt.prototype),Object(C.a)(vt.prototype,"updateAndExit",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"updateAndExit"),vt.prototype),Object(C.a)(vt.prototype,"exit",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"exit"),vt.prototype),Object(C.a)(vt.prototype,"onToggleLeaveModal",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"onToggleLeaveModal"),vt.prototype),Object(C.a)(vt.prototype,"onExit",[j.a],Object.getOwnPropertyDescriptor(vt.prototype,"onExit"),vt.prototype),vt),yn=n(1065),vn=n(1129),bn=function(e,t){var n=[];if(e)for(var r=Cn(e,t.chapters),o=0;o<e.count();o++){var a=r.get(o),i=e.get(o),s=gn(a,i);if(!i.id||s.length){var c=void 0;c=i.id?"Task ".concat(o+1," has changed ").concat(s.join(", ")):"Task ".concat(o+1," is not saved"),n.push({title:c})}}return n},gn=function(e,t){var n=["type","name","description"],r=[];return e?e.id&&t.id&&e.id!==t.id?r.push("order"):n.forEach((function(n){e[n]!==t[n]&&r.push(n)})):r.push.apply(r,n),r},On=function(e,t){return e.find((function(e){return e.order===t}))},Cn=function(e,t){var n;if(t.count()!==e.count()){for(var r=[],o=1;o<=e.count();o++){var a=On(t,o);a||(a=e.get(o-1)),r.push(a)}n=Object(tt.List)(r)}else n=t;return n},kn=(n(1704),bt={},Object($.a)(bt,P.K.Linux,"Ubuntu 18.04 LTS"),Object($.a)(bt,P.K.Win,"Windows Server 2019"),bt),jn=(gt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"close",value:function(){this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"software-details-modal"},u.createElement(R.a,{title:"".concat(this.props.template.name," Cloud Desktop - Installed Software"),visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"software-list"},kn[this.props.template.os]," ",this.props.template.os===P.K.Win?u.createElement(u.Fragment,null,"Google Chrome, Firefox, Git, Github Desktop, Visual Studio Code, Sublime Text, Vim, Emacs, Python 3, Ruby, NodeJS, R, R Studio, JDK 8, Java, Go, .NET, LibreOffice, VLC"):u.createElement(u.Fragment,null,"Google Chrome, Firefox, Chromium, Git, Visual Studio Code, Sublime Text, Vim, Emacs, Python 3, Ruby, NodeJS, R, R Studio, JDK 8, Java, Go, .NET, LibreOffice, VLC")),u.createElement(T.a,{onClick:this.close},"Okay")))}}]),t}(u.Component),Object(C.a)(gt.prototype,"close",[j.a],Object.getOwnPropertyDescriptor(gt.prototype,"close"),gt.prototype),gt),wn=(n(1705),Ot=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={isSaving:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onPrimaryAction",value:function(){var e=this;this.props.saveable?(this.setState({isSaving:!0}),this.props.onSave().then((function(){return e.props.onToggle(!1)})).finally((function(){return e.setState({isSaving:!1})}))):this.props.onToggle(!1)}},{key:"onDiscard",value:function(){this.props.onDiscard(),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"unsaved-changes-modal form-styles"},u.createElement(R.a,{title:"Unsaved Changes",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},this.props.saveable?u.createElement(u.Fragment,null,'Your "',this.props.title,'" has unsaved changes. Do you want to save them before leaving?'):u.createElement(u.Fragment,null,'Your "',this.props.title,'" has incomplete changes. Do you want to go back and complete them before leaving?')),!!this.props.changes.length&&u.createElement("ul",null,this.props.changes.map((function(e,t){return u.createElement("li",{key:"ucm-c-"+t},"Change ",e.title," ",e.content&&u.createElement(u.Fragment,null,"to ",u.createElement("strong",null,e.content)))})).slice(0,5)),u.createElement("div",{className:"row"},u.createElement(T.a,{onClick:this.onPrimaryAction,loading:this.state.isSaving},this.props.saveable?"Yes, Save":"Yes, Go Back"),u.createElement(T.a,{className:"empty",onClick:this.onDiscard,disabled:this.state.isSaving},"No, Discard")),u.createElement("div",{className:"trash-icon"})))}}]),t}(u.Component),Object(C.a)(Ot.prototype,"onPrimaryAction",[j.a],Object.getOwnPropertyDescriptor(Ot.prototype,"onPrimaryAction"),Ot.prototype),Object(C.a)(Ot.prototype,"onDiscard",[j.a],Object.getOwnPropertyDescriptor(Ot.prototype,"onDiscard"),Ot.prototype),Ot),En=(n(1706),n(1086)),_n=(n(1707),n(1469)),Sn=(Ct=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={forgotPassVisible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"submit",value:function(e){this.props.onConfirm(this.props.confirmPassword||""),this.props.onToggle(!1),this.props.dispatch(Object(E.b)("confirmChanges")),e.preventDefault()}},{key:"forgotPassword",value:function(){this.toggleForgotPass(!0)}},{key:"toggleForgotPass",value:function(e){this.setState({forgotPassVisible:e})}},{key:"render",value:function(){return u.createElement("div",{className:"confirm-size-change-modal form-styles"},u.createElement(R.a,{title:"Confirm Changes",transparent:this.state.forgotPassVisible,visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},"Your cloud desktop's hourly cost will change from $TODO to $TODO. Please confirm these changes"),u.createElement("form",{name:"confirmChanges",onSubmit:this.submit},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"confirmPassword",type:"password",autoFocus:!0,component:T.s},{label:"Current Password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid||!this.props.confirmPassword},"Save"))),u.createElement("a",{href:"javascript:void(0);",onClick:this.forgotPassword},"Forgot password?"),u.createElement("div",{className:"description"},"How will I be charged?",u.createElement("br",null),"You will be charged $TODO /hour for each cloud desktop you or your learners use. Time is measured in 15 mins multiples",u.createElement("br",null),u.createElement("br",null),"Example:",u.createElement("br",null),"For a 27 mins session with 2 learners, you pay: $TODO x 0.5 hours x ( 2 learners + 1 host ) +"," ",g.a," (credit card processing) = $TODO")),u.createElement(_n.a,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.forgotPassVisible,onToggle:this.toggleForgotPass}))}}]),t}(u.Component),Object(C.a)(Ct.prototype,"submit",[j.a],Object.getOwnPropertyDescriptor(Ct.prototype,"submit"),Ct.prototype),Object(C.a)(Ct.prototype,"forgotPassword",[j.a],Object.getOwnPropertyDescriptor(Ct.prototype,"forgotPassword"),Ct.prototype),Object(C.a)(Ct.prototype,"toggleForgotPass",[j.a],Object.getOwnPropertyDescriptor(Ct.prototype,"toggleForgotPass"),Ct.prototype),Ct),Dn=Object(S.a)({form:"confirmChanges",validate:T.D})(Sn),Pn=Object(D.a)("confirmChanges"),Tn=Object(w.c)((function(e){return{confirmPassword:Pn(e,"confirmPassword")}}))(Dn),Rn=(n(1708),n(1709),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"changeView",value:function(e){this.props.onViewChange(e)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"views-toolbar"},u.createElement("div",{className:"views"},this.props.views.map((function(t){return u.createElement("div",{key:t,className:e.props.view===t?"active":"",onClick:function(){return e.changeView(t)}},e.props.messages[t])}))))}}]),t}(u.Component)),xn=(kt={},Object($.a)(kt,P.A.One,"1"),Object($.a)(kt,P.A.OneToFour,"1-4"),Object($.a)(kt,P.A.FiveToNine,"5-9"),Object($.a)(kt,P.A.TenToNineteen,"10-19"),Object($.a)(kt,P.A.TwentyPlus,"20+"),kt),Mn=function(e,t){return e.startTime.getTime()-t.startTime.getTime()};!function(e){e.Upcoming="Upcoming",e.Past="Past"}(wt||(wt={}));var Nn,Vn,An,In,Un=(jt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={view:wt.Upcoming},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"changeView",value:function(e){this.setState({view:e})}},{key:"formatRoomTime",value:function(e){var t=e.startTime,n=e.endTime?e.endTime:e.expirationTime;return"".concat(m(t).format("h:mma")," - ").concat(m(n).format("h:mma"))}},{key:"formatRoomDay",value:function(e){return m(e.startTime).format("ddd MMM D")}},{key:"getTemplate",value:function(e){var t=this.props.courses.get(e.courseId);return this.props.templates.get(t.templateId)}},{key:"render",value:function(){var e=this;if(!this.props.rooms.size)return null;var t=this.upcomingRooms;return this.state.view===wt.Past&&(t=this.passedRooms),u.createElement("div",{className:"related-sessions"},u.createElement("div",{className:"sep-line","data-text":"Related Sessions"}),u.createElement("div",null,u.createElement(Rn,{messages:wt,views:[wt.Upcoming,wt.Past],view:this.state.view,onViewChange:this.changeView})),u.createElement("table",null,u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",{colSpan:2},"Date & Time"),u.createElement("th",null,"Name"),u.createElement("th",null,"Learners"),u.createElement("th",null,"Rate"),u.createElement("th",null,"Cost"))),u.createElement("tbody",null,t.size?t.map((function(t,n){var r=Object(g.d)(e.props.templates,e.getTemplate(t));return u.createElement("tr",{key:"rd-"+n},u.createElement("td",null,e.formatRoomDay(t)),u.createElement("td",null,e.formatRoomTime(t)),u.createElement("td",null,e.props.courses.get(t.courseId).name),u.createElement("td",null,e._renderAttendees(t)),u.createElement("td",null,x.a[r.currency]," ",Object(x.b)(r.price)),u.createElement("td",null,t.cost&&t.cost.total?"".concat(x.a[t.cost.currency]," ").concat(Object(x.b)(t.cost.total)):"-"))})):u.createElement("tr",null,u.createElement("td",{style:{textAlign:"center"},colSpan:6},"No sessions")))))}},{key:"_renderAttendees",value:function(e){return this.state.view===wt.Upcoming?xn[e.expectedAttendees]+" (expected)":e.cost?e.cost.costs.size:"Processing"}},{key:"upcomingRooms",get:function(){var e=new Date;return this.props.rooms.filter((function(t){return t.startTime>e})).sort(Mn)}},{key:"passedRooms",get:function(){return this.props.rooms.filter((function(e){return Object(En.g)(e)})).sort(Mn)}}]),t}(u.Component),Object(C.a)(jt.prototype,"changeView",[j.a],Object.getOwnPropertyDescriptor(jt.prototype,"changeView"),jt.prototype),jt),Ln=(Nn={},Object($.a)(Nn,P.K.Win,u.createElement("i",{className:"fa fa-windows"})),Object($.a)(Nn,P.K.Linux,u.createElement("div",{className:"ubuntu"})),Nn),Fn=(Vn={},Object($.a)(Vn,P.bb.ThreeMonths,"3 months of no usage"),Object($.a)(Vn,P.bb.SixMonths,"6 months of no usage"),Object($.a)(Vn,P.bb.OneYear,"12 months of no usage"),Vn);!function(e){e.Customize="Customize",e.ChangeScreenshot="Change Screenshot"}(In||(In={}));var zn,Bn,Wn,Hn,Kn,Yn,Gn,Jn=(An=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._unsavedChangesAction=void 0,n._formRef=void 0,n.state={confirmChangesVisible:!1,confirmDeleteVisible:!1,unsavedChangesVisible:!1,loading:!1,isDuplicatedVM:!1,isPreparingToCustomize:!1,isPreparingToUpdateScreenshot:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.template.state!==P.ab.Ready&&e.visible&&this.props.onToggle(!1)}},{key:"submit",value:function(e){var t=this;return e&&(e.preventDefault(),e.persist()),this.props.template.templateSize!==this.props.size?(this.toggleConfirmChanges(!0),Promise.reject("Needs confirmation")):this.saveChanges().then((function(){e&&e.target===t._formRef&&t.props.onToggle(!1)}))}},{key:"saveChanges",value:function(e){var t=this,n=this.props.template.withMutations((function(e){return e.set("name",t.props.templateName).set("templateSize",t.props.size).set("terminateAfter",t.props.terminate)}));return this.state.isDuplicatedVM?this._duplicate(this.props.template.id,n):this._update(n,e)}},{key:"attemptDelete",value:function(){this.toggleConfirmDelete()}},{key:"deleteVm",value:function(){var e=this;return this.props.dispatch(this.props.asyncActions.deleteTemplate(this.props.template)).then((function(){e.props.dispatch(new v.i(new P.I({type:P.J.General,text:"Cloud desktop successfully deleted"}))),e.props.onToggle(!1)}))}},{key:"customize",value:function(){var e=this;this._validateAction(In.Customize)&&(this._unsavedChangesAction=function(){return e.setState({isPreparingToCustomize:!0}),e.props.onCustomize(e.props.template).catch((function(){return e.setState({isPreparingToCustomize:!1})}))},this.props.pristine?this._unsavedChangesAction():this.toggleUnsavedChanges(!0))}},{key:"duplicate",value:function(){this.setState({isDuplicatedVM:!0}),this.props.dispatch(Object(E.a)("vmDetails","templateName",this.props.templateName+" - Duplicate"))}},{key:"screenshotUpdate",value:function(){var e=this;this._validateAction(In.ChangeScreenshot)&&(this._unsavedChangesAction=function(){return e.setState({isPreparingToUpdateScreenshot:!0}),e.props.onScreenshotUpdate(e.props.template).catch((function(){return e.setState({isPreparingToUpdateScreenshot:!1})}))},this.props.pristine?this._unsavedChangesAction():this.toggleUnsavedChanges(!0))}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("vmDetails")),this.props.onToggle(!1)}},{key:"toggleConfirmChanges",value:function(e){this.setState({confirmChangesVisible:e})}},{key:"toggleConfirmDelete",value:function(){this.setState({confirmDeleteVisible:!this.state.confirmDeleteVisible})}},{key:"toggleUnsavedChanges",value:function(e){this.setState({unsavedChangesVisible:e})}},{key:"unsavedChangesSave",value:function(){var e=this,t=this.submit();return t.then((function(){return e._unsavedChangesAction?e._unsavedChangesAction():Promise.resolve()})),t}},{key:"unsavedChangesDiscard",value:function(){this.props.reset(),this._unsavedChangesAction&&this._unsavedChangesAction()}},{key:"formChanges",value:function(){var e=[],t=this.props.initialValues;return t.templateName!==this.props.templateName&&e.push({title:"Name",content:this.props.templateName}),t.size!==this.props.size&&e.push({title:"Size",content:this.props.size}),t.terminate!==this.props.terminate&&e.push({title:"Terminate After",content:this.props.terminate?Fn[this.props.terminate]:""}),e}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"vm-details-modal form-styles"},u.createElement(R.a,{visible:this.props.visible,transparent:this.transparent,scrollable:!0,title:this.state.isDuplicatedVM?"Duplicate Cloud Desktop":"Cloud Desktop Details",onToggle:this.props.onToggle},u.createElement("div",{className:"vm-actions"},u.createElement(T.a,{className:"empty small purple",onClick:this.customize,disabled:this.state.isDuplicatedVM||this.state.isPreparingToUpdateScreenshot,loading:this.state.isPreparingToCustomize},"Customize"),u.createElement(T.a,{className:"empty small purple",onClick:this.duplicate,disabled:this.isDuplicateDisabled},"Duplicate")),u.createElement("div",{className:"os-logo"+(this.state.isDuplicatedVM?" duplicated":"")},Ln[this.props.template.os]),u.createElement("div",{className:"modal-content"},this.state.isDuplicatedVM?u.createElement("div",{className:"duplicate-message"},'Note: This duplicate virtual machine is not saved yet. Please make any changes and click "Save"'):null,u.createElement("form",{name:"vmDetails",onSubmit:this.submit,ref:function(t){return e._formRef=t}},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"templateName",component:T.s,autoComplete:"off"},{label:"Name"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"size",component:T.u},{label:"Size"},{disabled:!0}),u.createElement(T.n,{value:P.Z.Micro},Object(g.k)(P.Z.Micro,"???")),u.createElement(T.n,{value:P.Z.Small},Object(g.k)(P.Z.Small,"???")),u.createElement(T.n,{value:P.Z.Medium},Object(g.k)(P.Z.Medium,"???")),u.createElement(T.n,{value:P.Z.Large},Object(g.k)(P.Z.Large,"???")),u.createElement(T.n,{value:P.Z.XLarge},Object(g.k)(P.Z.XLarge,"???")),u.createElement(T.n,{value:P.Z.XXLarge},Object(g.k)(P.Z.XXLarge,"???")),u.createElement(T.n,{value:P.Z.GPUMicro},Object(g.k)(P.Z.GPUMicro,"???")),u.createElement(T.n,{value:P.Z.GPUSmall},Object(g.k)(P.Z.GPUSmall,"???")),u.createElement(T.n,{value:P.Z.GPUMedium},Object(g.k)(P.Z.GPUMedium,"???")),u.createElement(T.n,{value:P.Z.GPULarge},Object(g.k)(P.Z.GPULarge,"???")),u.createElement(T.n,{value:P.Z.MemMicro},Object(g.k)(P.Z.MemMicro,"???")),u.createElement(T.n,{value:P.Z.MemSmall},Object(g.k)(P.Z.MemSmall,"???")))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"terminate",component:T.u},{label:"Terminate After"}),u.createElement(T.n,{value:P.bb.ThreeMonths},Fn[P.bb.ThreeMonths]),u.createElement(T.n,{value:P.bb.SixMonths},Fn[P.bb.SixMonths]),u.createElement(T.n,{value:P.bb.OneYear},Fn[P.bb.OneYear])),u.createElement("p",{className:"field-info"},"Cloud desktop will be permanently terminated after no usage for this period")),u.createElement("div",{className:"row"},u.createElement(zt,{image:this.props.template.screenshotUrl,onTakeScreenshot:this.screenshotUpdate,width:320,height:240,disabled:this.state.isDuplicatedVM||this.state.isPreparingToCustomize,loading:this.state.isPreparingToUpdateScreenshot})),u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel},"Cancel"),u.createElement(T.a,{disabled:this.formSaveable,loading:this.state.loading},"Save")),this.state.isDuplicatedVM?null:u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.attemptDelete},"Delete Cloud Desktop")))),this.state.isDuplicatedVM?null:u.createElement(Un,{rooms:this.templateRooms,courses:this.props.courses,templates:this.props.templates}))),u.createElement(Tn,{tempplate:this.props.template,newSize:this.props.size,visible:this.state.confirmChangesVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.toggleConfirmChanges,onConfirm:this.saveChanges}),u.createElement(xe.a,{visible:this.state.confirmDeleteVisible,title:"Delete Cloud Desktop",messages:['Are you sure you want to delete cloud desktop "'.concat(this.props.template.name,'"?')],onClose:this.toggleConfirmDelete,onDelete:this.deleteVm}),u.createElement(wn,{title:"Cloud Desktop Details",visible:this.state.unsavedChangesVisible,onToggle:this.toggleUnsavedChanges,changes:this.formChanges(),saveable:!this.formSaveable,onSave:this.unsavedChangesSave,onDiscard:this.unsavedChangesDiscard}))}},{key:"_update",value:function(e,t){var n=this;return this.setState({loading:!0}),this.props.dispatch(this.props.asyncActions.updateTemplate(e,t)).catch((function(){return n.setState({loading:!1})}))}},{key:"_duplicate",value:function(e,t){var n=this;return this.setState({loading:!0}),this.props.dispatch(this.props.asyncActions.duplicateTemplate(e,t)).then((function(){n.props.dispatch(new v.i(new P.I({type:P.J.General,text:"Cloud desktop successfully duplicated"})))})).finally((function(){return n.setState({loading:!1})}))}},{key:"_validateAction",value:function(e){var t;if(this.isTemplateUsedInAboutToStartSession?t="about to start":this.isTemplateUsedInRunningSession&&(t="already running"),t){var n=e===In.Customize?"customize the cloud desktop":"change the cloud desktop's screenshot";return this.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Cannot ".concat(e),text:"Cannot ".concat(n,". It is used by a session that is ").concat(t)}))),!1}return!0}},{key:"transparent",get:function(){return this.state.confirmChangesVisible||this.state.confirmDeleteVisible||this.state.unsavedChangesVisible||this.props.transparent}},{key:"templateRooms",get:function(){return Object(En.a)(this.props.template,this.props.courses,this.props.rooms)}},{key:"formSaveable",get:function(){return!(this.props.valid&&!this.props.pristine)}},{key:"isTemplateUsedInAboutToStartSession",get:function(){return Object(En.i)(this.props.template,this.props.courses,this.props.rooms)}},{key:"isTemplateUsedInRunningSession",get:function(){return Object(En.j)(this.props.template,this.props.courses,this.props.rooms)}},{key:"isDuplicateDisabled",get:function(){return this.state.isDuplicatedVM||this.state.isPreparingToCustomize||this.state.isPreparingToUpdateScreenshot}}]),t}(u.Component),Object(C.a)(An.prototype,"submit",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"submit"),An.prototype),Object(C.a)(An.prototype,"saveChanges",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"saveChanges"),An.prototype),Object(C.a)(An.prototype,"attemptDelete",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"attemptDelete"),An.prototype),Object(C.a)(An.prototype,"deleteVm",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"deleteVm"),An.prototype),Object(C.a)(An.prototype,"customize",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"customize"),An.prototype),Object(C.a)(An.prototype,"duplicate",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"duplicate"),An.prototype),Object(C.a)(An.prototype,"screenshotUpdate",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"screenshotUpdate"),An.prototype),Object(C.a)(An.prototype,"cancel",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"cancel"),An.prototype),Object(C.a)(An.prototype,"toggleConfirmChanges",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"toggleConfirmChanges"),An.prototype),Object(C.a)(An.prototype,"toggleConfirmDelete",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"toggleConfirmDelete"),An.prototype),Object(C.a)(An.prototype,"toggleUnsavedChanges",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"toggleUnsavedChanges"),An.prototype),Object(C.a)(An.prototype,"unsavedChangesSave",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"unsavedChangesSave"),An.prototype),Object(C.a)(An.prototype,"unsavedChangesDiscard",[j.a],Object.getOwnPropertyDescriptor(An.prototype,"unsavedChangesDiscard"),An.prototype),An),Zn=Object(S.a)({form:"vmDetails",validate:T.K,enableReinitialize:!0})(Jn),qn=Object(D.a)("vmDetails"),Xn=Object(w.c)((function(e,t){return{templateName:qn(e,"templateName"),size:qn(e,"size"),terminate:qn(e,"terminate"),initialValues:{templateName:t.template.name,size:t.template.templateSize,terminate:t.template.terminateAfter}}}))(Zn),$n=n(40),Qn=(zn=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"onRecordChapter",value:function(e){var t=this;this._instance.setState({chapterToBeRecorded:e},(function(){t._instance.hasUnsavedChanges?t._instance.onToggleUnsavedChangesModal():t._instance.recordChapter()}))}},{key:"onPreviewChapter",value:function(e){var t=this;this._instance.setState({chapterToBePreviewed:e},(function(){t._instance.hasUnsavedChanges?t._instance.onToggleUnsavedChangesModal():t._instance.previewChapter()}))}},{key:"onSaveUnsavedChanges",value:function(){var e=this;if(!this._instance.props.valid&&this.chaptersListRenderedComponent)return this.chaptersListRenderedComponent.showValidation(),this._instance.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Invalid fields",text:"The changes cannot be saved. Please verify all required fields have values"}))),this._instance.onToggleUnsavedChangesModal(),Promise.reject("The form is not valid");this._instance.setState({isLoading:!0});var t=this._instance.saveUnsavedChanges().then((function(){return e.proceedAction()}));return t.finally((function(){return e._instance.setState({isLoading:!1})})),t}},{key:"saveUnsavedChapters",value:function(){var e=[],t=this._chaptersToBeCreated(),n=this._chaptersToBeUpdated(),r=this._instance.props,o=r.asyncActions,a=r.course,i=r.dispatch;return t.count()&&e.push(i(o.createBatchChapters(a,t.toList()))),n.count()&&e.push(i(o.updateBatchChapters(a,n.toList()))),Promise.all(e)}},{key:"discardUnsavedChanges",value:function(){var e=this._chaptersToBeCreated(),t=this._instance.props,n=t.asyncActions,r=t.course,o=t.dispatch,a=t.initialValues;if(e.size>0){var i=a.chapters.toMap().mapEntries((function(e){var t=Object($n.a)(e,2),n=(t[0],t[1]);return[n.id,n.order]})),s=this._chaptersToBeUpdated().sort((function(e,t){return e.order-t.order})).map((function(e,t){return e.set("order",t+1)})).filter((function(e){return e.order!==i.get(e.id)}));if(s.size)return o(n.updateBatchChapters(r,s))}else{var c=a.chapters.groupBy((function(e){return e.order})).find((function(e){return e.size>1}));if(c){var p=a.chapters.max((function(e,t){return e.order-t.order})).order,l=c.last().set("order",p+1);return o(n.updateBatchChapters(r,Object(tt.List)([l])))}}return Promise.resolve()}},{key:"proceedAction",value:function(){this._instance.state.chapterToBePreviewed?this._instance.previewChapter():this._instance.state.chapterToBeRecorded&&this._instance.recordChapter()}},{key:"_chaptersToBeCreated",value:function(){return this._instance.props.chapters.filter((function(e){return!e.id}))}},{key:"_chaptersToBeUpdated",value:function(){var e=this._instance.props.initialValues.chapters;return this._instance.props.chapters.filter((function(t,n){return t!==e.get(n)&&!!t.id}))}},{key:"chaptersListRenderedComponent",get:function(){return this._instance.chaptersListRef?this._instance.chaptersListRef.getRenderedComponent():null}}]),e}(),Object(C.a)(zn.prototype,"onRecordChapter",[j.a],Object.getOwnPropertyDescriptor(zn.prototype,"onRecordChapter"),zn.prototype),Object(C.a)(zn.prototype,"onPreviewChapter",[j.a],Object.getOwnPropertyDescriptor(zn.prototype,"onPreviewChapter"),zn.prototype),Object(C.a)(zn.prototype,"onSaveUnsavedChanges",[j.a],Object.getOwnPropertyDescriptor(zn.prototype,"onSaveUnsavedChanges"),zn.prototype),zn),er=n(1139),tr=(Bn=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._tooltipRef=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onConfirm",value:function(){this._tooltipRef.hide(),this.props.onConfirm()}},{key:"onDecline",value:function(){this._tooltipRef.hide()}},{key:"onLinkClick",value:function(){this.props.skip?this.props.onConfirm():this._tooltipRef.show()}},{key:"render",value:function(){var e=this;return u.createElement(er.a,{className:"change-context-tooltip",ref:function(t){return e._tooltipRef=t}},u.createElement(u.Fragment,null,"There are unsaved changes that will be lost.",u.createElement("br",null),"Would you like to continue?"," ",u.createElement("a",{href:"javascript:void(0);",onClick:this.onDecline},"No")," ","/"," ",u.createElement("a",{href:"javascript:void(0);",onClick:this.onConfirm},"Yes")),u.createElement("a",{href:"javascript:void(0);",onClick:this.onLinkClick},this.props.children))}}]),t}(u.Component),Object(C.a)(Bn.prototype,"onConfirm",[j.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onConfirm"),Bn.prototype),Object(C.a)(Bn.prototype,"onDecline",[j.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onDecline"),Bn.prototype),Object(C.a)(Bn.prototype,"onLinkClick",[j.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onLinkClick"),Bn.prototype),Bn),nr=(n(1710),Wn=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onCancel",value:function(){this.props.onCancel(),this.props.onToggle(!1)}},{key:"onSave",value:function(){this.props.onSave(),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"chapters-order-modal form-styles"},u.createElement(R.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},"If you change the order of tasks, then the state of your cloud desktop students see may not match with the state of their own cloud desktops. Are you sure you want to change the order?"),u.createElement("div",null,u.createElement(T.a,{onClick:this.onCancel,className:"short-btn"},"No, Cancel")),u.createElement("div",null,u.createElement(T.a,{onClick:this.onSave,className:"short-btn empty"},"Yes, Change")),u.createElement("i",{className:"fa fa-list-ol"})))}}]),t}(u.Component),Object(C.a)(Wn.prototype,"onCancel",[j.a],Object.getOwnPropertyDescriptor(Wn.prototype,"onCancel"),Wn.prototype),Object(C.a)(Wn.prototype,"onSave",[j.a],Object.getOwnPropertyDescriptor(Wn.prototype,"onSave"),Wn.prototype),Wn),rr=(n(1711),n(1137)),or=(Hn=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={done:!!n.props.course.resourcesUrl,progress:0,files:[]},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onFiles",value:function(e){var t=this;this.setState({files:e,done:!1});var n=e[0],r=n.name.split("."),o=r[r.length-1];this.props.dispatch(this.props.asyncActions.uploadCourseResources(this.props.course,n,o,(function(e,n){return t.setState({progress:n/e})}))).then((function(){t.props.dispatch(new v.i(new P.I({type:P.J.General,text:"File successfully uploaded"}))),t.setState({done:!0})}))}},{key:"render",value:function(){var e=this.props.course.resourcesUrl;return u.createElement("div",{className:"course-file-archive-uploader"},u.createElement(rr.a,{dispatch:this.props.dispatch,currentFile:1,currentProgress:this.state.progress,done:this.state.done,files:this.state.files,onFiles:this.onFiles,fileLimit:1,label:"Upload a resource file (e.g. zip) to email to learners",filesUploadedLabel:"Uploaded a resource file (e.g. zip) to email to learners. Re-upload?",filters:{maxSize:ce.a.FileSizeLimitCourseResource}}),u.createElement(G.a,{position:"left"},"On completion, auto-email learners with a resource file (e.g. zip)"),e&&u.createElement("p",{className:"file-link"},u.createElement("a",{href:e},"Download current resource file")))}}]),t}(u.Component),Object(C.a)(Hn.prototype,"onFiles",[j.a],Object.getOwnPropertyDescriptor(Hn.prototype,"onFiles"),Hn.prototype),Hn),ar=n(1712),ir=n.n(ar),sr=n(435),cr=n(1138),pr=(n(1714),n(1715),ce.a.FileSizeLimitImage/1048576),lr={width:200,height:200},ur=600,dr=350,hr=(Kn=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._cropper=void 0,n.state={tracking:!1,loading:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.image&&!e.image&&this.props.faceRecognition&&this._performFaceRecognition(this.props.image)}},{key:"onFiles",value:function(e){var t=this;if(e&&this._validateFileNumber(e)&&this._validateFileType(e)&&this._validateFileSize(e)){var n=new FileReader;n.onload=function(){var e=n.result,r=new Image;r.onload=function(){t._validateImageSize(r)&&t.props.onImageLoad(r)},r.onerror=t._handleCorruptedImage.bind(t),r.src=e},n.readAsDataURL(e[0])}}},{key:"cropAndSave",value:function(){var e=this;if(this.setState({loading:!0}),this._cropper){var t=this._cropper.getCroppedCanvas();this.props.downscaleImage&&(t=Object(sr.a)(t,this.downscaleSize));var n=this.props,r=n.mimeType,o=n.quality;t.toBlob((function(t){e.props.onImageSave(t).catch((function(){return e.setState({loading:!1})}))}),r||"image/png",o||1)}else console.error("Cropper not initialized")}},{key:"cropperSize",value:function(e){var t=e.width,n=e.height,r=dr,o=t/n*r;return o>ur&&(r=n/t*(o=ur)),{width:o,height:r}}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"image-uploader"},this.props.image?u.createElement("div",{className:"cropper"},this.state.tracking&&u.createElement("div",{className:"tracking",style:this.cropperSize(this.props.image)},"Loading"),u.createElement(ir.a,{ref:function(t){return e._cropper=t},src:this.props.image.src,style:this.cropperSize(this.props.image),zoomable:!1,aspectRatio:this.props.aspectRatio?this.props.aspectRatio:1}),u.createElement("div",{className:"cropper-actions"},u.createElement(T.a,{className:"empty",onClick:this.props.onCancel,disabled:this.state.loading||this.state.tracking},"Cancel"),u.createElement(T.a,{onClick:this.cropAndSave,loading:this.state.loading,disabled:this.state.tracking},"Save"))):u.createElement(cr.a,{onFiles:this.onFiles},u.createElement("span",null,this.props.message?this.props.message:"Upload your image")))}},{key:"_validateFileNumber",value:function(e){return!(e.length>1)||(this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"You can upload only 1 file at a time"}))),!1)}},{key:"_validateFileType",value:function(e){var t=e[0];return"image/png"===t.type||"image/jpeg"===t.type||(this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"You can upload only PNG and JPEG images"}))),!1)}},{key:"_validateFileSize",value:function(e){return!(e[0].size>1048576*this.sizeLimitInMb)||(this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"The image should be less than ".concat(this.sizeLimitInMb," MB").concat(1!==this.sizeLimitInMb?"s":"")}))),!1)}},{key:"_validateImageSize",value:function(e){return!(this.downscaleSize.width>e.width||this.downscaleSize.height>e.height)||(this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"The image should be at least ".concat(this.downscaleSize.width," x ").concat(this.downscaleSize.height," pixels")}))),!1)}},{key:"_handleCorruptedImage",value:function(){this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"Unable to open the image. Please, use another one"})))}},{key:"_performFaceRecognition",value:function(){var e=Object(re.a)(ne.a.mark((function e(t){var r,o=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(14).then(n.t.bind(null,1997,7));case 2:return e.next=4,n.e(13).then(n.t.bind(null,1998,7));case 4:this.setState({tracking:!0}),(r=new tracking.ObjectTracker("face")).setStepSize(1.7),tracking.track(t,r),r.on("track",(function(e){var t=e.data[0];if(t){var n=t.width;t.width*=1.5;var r=(t.width-n)/2;if(t.x-=r,t.y-=r,!o._cropper)return void console.error("Cropper not initialized");o._cropper.setData(t)}o.setState({tracking:!1})}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"downscaleSize",get:function(){return this.props.downscaleSize||lr}},{key:"sizeLimitInMb",get:function(){return this.props.sizeLimitInMb||pr}}]),t}(u.Component),Object(C.a)(Kn.prototype,"onFiles",[j.a],Object.getOwnPropertyDescriptor(Kn.prototype,"onFiles"),Kn.prototype),Object(C.a)(Kn.prototype,"cropAndSave",[j.a],Object.getOwnPropertyDescriptor(Kn.prototype,"cropAndSave"),Kn.prototype),Kn),mr=(n(1716),Yn=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={image:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onImageLoad",value:function(e){this.setState({image:e})}},{key:"onImageSave",value:function(e){var t=this;return this.props.dispatch(St.a.uploadHeroImage(this.props.course,e)).then((function(){t.props.onToggle(!1),t.setState({image:null})}))}},{key:"onCancel",value:function(){this.setState({image:null})}},{key:"render",value:function(){return u.createElement("div",{className:"hero-image-picker"},u.createElement(R.a,{title:this.state.image?"Adjust Hero Image":"Hero Image",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement(hr,{dispatch:this.props.dispatch,image:this.state.image,downscaleImage:!1,faceRecognition:!1,message:"Upload new hero image",onImageLoad:this.onImageLoad,onImageSave:this.onImageSave,onCancel:this.onCancel,aspectRatio:4/3,mimeType:"image/jpeg",quality:.8})))}}]),t}(u.Component),Object(C.a)(Yn.prototype,"onImageLoad",[j.a],Object.getOwnPropertyDescriptor(Yn.prototype,"onImageLoad"),Yn.prototype),Object(C.a)(Yn.prototype,"onImageSave",[j.a],Object.getOwnPropertyDescriptor(Yn.prototype,"onImageSave"),Yn.prototype),Object(C.a)(Yn.prototype,"onCancel",[j.a],Object.getOwnPropertyDescriptor(Yn.prototype,"onCancel"),Yn.prototype),Yn),fr=(n(1717),Gn=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).chaptersListRef=void 0,n._tooltip=void 0,n._recordingBuilder=new Qn(Object(X.a)(n)),n.state={isLoading:!1,isDeleteConfirmationModalVisible:!1,isDeleteHeroImageConfirmationModalVisible:!1,isVmDetailsModalVisible:!1,isDefaultVmDetailsModalVisible:!1,isUnsavedChangesModalVisible:!1,isChapterOrderModalVisible:!1,isHeroImageModalVisible:!1,chapterToBeRecorded:null,chapterToBePreviewed:null,formChanges:[]},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this)}},{key:"componentWillReceiveProps",value:function(e){e.courseName===this.props.courseName&&e.description===this.props.description&&e.templateId===this.props.templateId&&e.chapters===this.props.chapters||this.setState({formChanges:this._formChanges(e)})}},{key:"submit",value:function(e){e.preventDefault(),!function(e,t){var n=!1;return e.forEach((function(e,r){e.id!==t.get(r).id&&(n=!0)})),n}(this.props.initialValues.chapters,this.props.chapters)?this.save():this.toggleChaptersOrderModal(!0)}},{key:"save",value:function(){var e=this;this.setState({isLoading:!0}),this.saveUnsavedChanges().then((function(){return e.props.onToggle()})).catch((function(){return e.setState({isLoading:!1})}))}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("recordingDetails")),this.props.onToggle()}},{key:"reorderChaptersBack",value:function(){var e=function(e,t){var n={};return e.forEach((function(e){return n[e.id]=e.order})),t.sort((function(e,t){return n[e.id]-n[t.id]})).map((function(e,t){return e.set("order",t+1)}))}(this.props.initialValues.chapters,this.props.chapters);this.props.change("chapters",e)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({isDeleteConfirmationModalVisible:!this.state.isDeleteConfirmationModalVisible})}},{key:"toggleDeleteHeroImageConfirmationModal",value:function(){this.setState({isDeleteHeroImageConfirmationModalVisible:!this.state.isDeleteHeroImageConfirmationModalVisible})}},{key:"onConfirmDeletion",value:function(){return this._isDeletionAllowed()?this.props.dispatch(this.props.asyncActions.deleteCourse(this.props.course)).then(this.props.onToggle):Promise.reject("Deleting a recording is not allowed")}},{key:"onConfirmHeroImageDeletion",value:function(){return this.props.dispatch(this.props.asyncActions.deleteHeroImage(this.props.course)).then(this.toggleDeleteHeroImageConfirmationModal)}},{key:"toggleVMDetailsModal",value:function(e){this.setState({isVmDetailsModalVisible:e})}},{key:"toggleDefaultVMDetailsModal",value:function(e){this.setState({isDefaultVmDetailsModalVisible:e})}},{key:"toggleChaptersOrderModal",value:function(e){this.setState({isChapterOrderModalVisible:e})}},{key:"toggleHeroImageModal",value:function(e){this.setState({isHeroImageModalVisible:e})}},{key:"showVMDetails",value:function(){var e=Object(re.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("recordingDetails"));case 2:if(this.template){e.next=4;break}return e.abrupt("return");case 4:if(this.props.showVmDetails){e.next=7;break}return this.props.onVmDetails&&this.props.onVmDetails(),e.abrupt("return");case 7:this.template.defaultTemplate||Object(g.h)(this.template)?this.toggleDefaultVMDetailsModal(!0):this.toggleVMDetailsModal(!0);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRecordChapter",value:function(e){var t=this;this.props.user.creditCards.size?this._recordingBuilder.onRecordChapter(e):(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then((function(){return t._recordingBuilder.onRecordChapter(e)})))}},{key:"onToggleUnsavedChangesModal",value:function(){this.setState({isUnsavedChangesModalVisible:!this.state.isUnsavedChangesModalVisible})}},{key:"onDiscardUnsavedChanges",value:function(){var e=this;this._recordingBuilder.discardUnsavedChanges().then((function(){return e._recordingBuilder.proceedAction()}))}},{key:"onTemplateChange",value:function(e,t){var n=this.props.chapters.some((function(e){return!!e.videoUrl}));t!==this.props.course.templateId&&n&&this.props.dispatch(new v.i(new P.I({type:P.J.Info,title:"Are you sure?",text:"Your learners will get this new cloud desktop, but the recordings may have been created with the previous cloud desktop"})))}},{key:"saveUnsavedChanges",value:function(){var e=this;return this._recordingBuilder.saveUnsavedChapters().then((function(){var t=e.props.course.withMutations((function(t){return t.set("name",e.props.courseName).set("description",e.props.description).set("templateId",e.props.templateId)}));return e.props.dispatch(e.props.asyncActions.updateCourse(t))}))}},{key:"recordChapter",value:function(){this.state.chapterToBeRecorded&&this.props.onChapterRecord(this.state.chapterToBeRecorded)}},{key:"previewChapter",value:function(){this.state.chapterToBePreviewed&&this.props.onChapterPreview(this.state.chapterToBePreviewed)}},{key:"onTakeScreenshot",value:function(){this.toggleHeroImageModal(!0)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recording-details-modal form-styles"},u.createElement("div",{className:"modal"},u.createElement(R.a,{title:"Recording Details",visible:this.props.visible,transparent:this.isModalTransparent,onToggle:this.props.onToggle,scrollable:!0},u.createElement(er.a,{ref:function(t){return e._tooltip=t},className:"landing-page-btn"},u.createElement("a",{target:"_blank",href:this.props.course.url,className:"link"},this.props.course.url),u.createElement(T.a,{onClick:function(t){t.stopPropagation(),e._tooltip&&e._tooltip.show()},className:"empty purple"},"Landing Page")),u.createElement("i",{className:"fa fa-video-camera","aria-hidden":"true"}),u.createElement("form",{name:"recordingDetails",className:"recording-details-form",onSubmit:this.submit},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"courseName",component:T.s},{label:"Recording Name"})),u.createElement("p",{className:"field-info"},"All sessions of this recording will use this recording name and description")),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"description",component:T.v,rows:5},{label:"Recording Description"})),u.createElement("div",{className:"field-info"},u.createElement("div",null,"Make your recording's landing page more descriptive."," ",u.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),u.createElement(_.a,Object.assign({name:"chapters",component:T.q,ref:function(t){return e.chaptersListRef=t},forwardRef:!0},{asyncActions:this.props.asyncActions,course:this.props.course,templates:this.props.templates,rooms:this.props.rooms,onRecordChapter:this.onRecordChapter,onPreviewChapter:this._recordingBuilder.onPreviewChapter,onRecordUnsupported:this.props.onChapterRecordUnsupported,actionDispatch:this.props.dispatch})),u.createElement("div",{className:"row vm-row"},this.disableVM?u.createElement("div",{className:"disable-message"},this._getDisableMessage()):null,u.createElement(_.a,Object.assign({name:"templateId",component:T.u,onChange:this.onTemplateChange,disabled:this.disableVM},{label:"Cloud Desktop",deletedOnMissingOption:!0}),this.props.templates.filter((function(t){var n=t.state!==P.ab.Deleted;return e.template&&e.template.id===t.id&&Object(g.h)(t)?n:n&&(!!t.ownerId||t.defaultTemplate)})).toList().map((function(e){return u.createElement(T.n,{value:e.id,key:"vm-"+e.id,disabled:e.state!==P.ab.Ready||Object(g.h)(e),text:e.name},e.name,Object(g.h)(e)?" - Legacy":"")}))),u.createElement("p",{className:"field-info cloud-desktop-details-link"+(this.template&&this.template.state===P.ab.Ready?"":" disabled")},u.createElement(tr,{skip:!this.hasUnsavedChanges,onConfirm:this.showVMDetails},"Cloud Desktop Details"))),u.createElement("div",{className:"row hero-image-row"},u.createElement(zt,{image:this.props.course.imageUrl,onTakeScreenshot:this.onTakeScreenshot,width:320,height:240,labels:{createLabel:"Upload Hero Image",changeLabel:"Change Hero Image"}}),u.createElement("p",{className:"field-info"},"Hero Image: The first image shown on this recording\u2019s landing page"),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteHeroImageConfirmationModal},"Delete Hero Image"))),u.createElement("div",{className:"row"},u.createElement(or,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,course:this.props.course})),u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions recording-details-modal-form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel,disabled:this.state.isLoading,type:"button"},"Cancel"),u.createElement(T.a,{disabled:!this.props.valid||!this.hasUnsavedChanges,loading:this.state.isLoading},"Save")),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete Recording")))))),this.renderModals())}},{key:"renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(xe.a,{visible:this.state.isDeleteConfirmationModalVisible,title:"Delete Recording",messages:['Are you sure you want to delete recording "'.concat(this.props.course.name,'"?')],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),u.createElement(xe.a,{visible:this.state.isDeleteHeroImageConfirmationModalVisible,title:"Delete Hero Image",messages:["Are you sure you want to delete the hero image?","Note: Without a hero image, the landing page will show a task image or cloud desktop image"],onClose:this.toggleDeleteHeroImageConfirmationModal,onDelete:this.onConfirmHeroImageDeletion}),u.createElement(wn,{title:"Recording Details",visible:this.state.isUnsavedChangesModalVisible,onToggle:this.onToggleUnsavedChangesModal,saveable:!(!this.props.valid||!this.hasUnsavedChanges),changes:this.state.formChanges,onDiscard:this.onDiscardUnsavedChanges,onSave:this._recordingBuilder.onSaveUnsavedChanges}),u.createElement(nr,{visible:this.state.isChapterOrderModalVisible,onToggle:this.toggleChaptersOrderModal,onSave:this.save,onCancel:this.reorderChaptersBack}),this.template&&this.props.showVmDetails&&(this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible)?u.createElement(u.Fragment,null,u.createElement(Xn,{dispatch:this.props.dispatch,template:this.template,asyncActions:this.props.asyncActions,courses:this.props.courses,rooms:this.props.rooms,templates:this.props.templates,visible:this.state.isVmDetailsModalVisible,onToggle:this.toggleVMDetailsModal,onCustomize:this.props.onVmCustomize,onScreenshotUpdate:this.props.onVmScreenshotUpdate}),u.createElement(jn,{template:this.template,visible:this.state.isDefaultVmDetailsModalVisible,onToggle:this.toggleDefaultVMDetailsModal})):null,u.createElement(mr,{visible:this.state.isHeroImageModalVisible,course:this.props.course,dispatch:this.props.dispatch,onToggle:this.toggleHeroImageModal}))}},{key:"_formChanges",value:function(e){var t=[],n=e.initialValues;e.courseName!==n.courseName&&t.push({title:"Name",content:e.courseName}),e.description!==n.description&&t.push({title:"Description",content:e.description}),e.templateId!==n.templateId&&t.push({title:"Cloud Desktop",content:e.templates.get(e.templateId).name});var r=bn(e.chapters,n);return t=t.concat(r)}},{key:"_getDisableMessage",value:function(){return this.isCourseUsedInRunningSession?"Can't change because a session has started":this.isCourseUsedInAboutToStartSession?"Can't change because a session is starting":""}},{key:"_isDeletionAllowed",value:function(){var e;return this.isCourseUsedInRunningSession?e="A recording with currently running session cannot be deleted":this.isCourseUsedInAboutToStartSession?e="A recording with session that is about to start cannot be deleted":this.isCourseUsedInUpcomingSession&&(e="A recording with upcoming sessions cannot be deleted"),!e||(this.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Recording is in use",text:e}))),!1)}},{key:"template",get:function(){return this.props.templates.get(this.props.course.templateId)||null}},{key:"hasUnsavedChanges",get:function(){return!!this.state.formChanges.length}},{key:"isModalTransparent",get:function(){return this.props.transparent||this.props.cardModalVisible||this.state.isDeleteConfirmationModalVisible||this.state.isDeleteHeroImageConfirmationModalVisible||this.state.isUnsavedChangesModalVisible||this.state.isDefaultVmDetailsModalVisible||this.state.isVmDetailsModalVisible||this.state.isChapterOrderModalVisible||this.state.isHeroImageModalVisible}},{key:"isCourseUsedInRunningSession",get:function(){return Object(En.c)(this.props.course,this.props.rooms)}},{key:"isCourseUsedInAboutToStartSession",get:function(){return Object(En.b)(this.props.course,this.props.rooms)}},{key:"isCourseUsedInUpcomingSession",get:function(){return Object(En.e)(this.props.course,this.props.rooms)}},{key:"disableVM",get:function(){return this.isCourseUsedInRunningSession||this.isCourseUsedInAboutToStartSession}}]),t}(u.Component),Object(C.a)(Gn.prototype,"submit",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"submit"),Gn.prototype),Object(C.a)(Gn.prototype,"save",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"save"),Gn.prototype),Object(C.a)(Gn.prototype,"cancel",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"cancel"),Gn.prototype),Object(C.a)(Gn.prototype,"reorderChaptersBack",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"reorderChaptersBack"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleDeleteConfirmationModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleDeleteConfirmationModal"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleDeleteHeroImageConfirmationModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleDeleteHeroImageConfirmationModal"),Gn.prototype),Object(C.a)(Gn.prototype,"onConfirmDeletion",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onConfirmDeletion"),Gn.prototype),Object(C.a)(Gn.prototype,"onConfirmHeroImageDeletion",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onConfirmHeroImageDeletion"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleVMDetailsModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleVMDetailsModal"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleDefaultVMDetailsModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleDefaultVMDetailsModal"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleChaptersOrderModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleChaptersOrderModal"),Gn.prototype),Object(C.a)(Gn.prototype,"toggleHeroImageModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"toggleHeroImageModal"),Gn.prototype),Object(C.a)(Gn.prototype,"showVMDetails",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"showVMDetails"),Gn.prototype),Object(C.a)(Gn.prototype,"onRecordChapter",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onRecordChapter"),Gn.prototype),Object(C.a)(Gn.prototype,"onToggleUnsavedChangesModal",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onToggleUnsavedChangesModal"),Gn.prototype),Object(C.a)(Gn.prototype,"onDiscardUnsavedChanges",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onDiscardUnsavedChanges"),Gn.prototype),Object(C.a)(Gn.prototype,"onTemplateChange",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onTemplateChange"),Gn.prototype),Object(C.a)(Gn.prototype,"onTakeScreenshot",[j.a],Object.getOwnPropertyDescriptor(Gn.prototype,"onTakeScreenshot"),Gn.prototype),Gn),yr=Object(D.a)("recordingDetails"),vr=Object(S.a)({form:"recordingDetails",validate:yn.m,enableReinitialize:!1})(fr),br=Object(w.c)((function(e,t){return{courseName:yr(e,"courseName"),description:yr(e,"description"),templateId:yr(e,"templateId"),chapters:yr(e,"chapters"),initialValues:{courseName:t.course.name,description:t.course.description,templateId:t.course.templateId,chapters:t.course.chapters.map((function(e,t){return e.set("key",t)}))}}}))(vr),gr=n(1097),Or=n(1114),Cr=n(1096);function kr(){return(kr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function jr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var wr=d.a.createElement("title",null,"Icons/Close"),Er=d.a.createElement("desc",null,"Created with Sketch."),_r=d.a.createElement("defs",null,d.a.createElement("path",{d:"M0,3.70909091 C1.23636364,2.47272727 2.47272727,1.23636364 3.70909091,0 C9.14909091,5.37818182 14.5909091,10.82 19.9690909,16.26 C25.4090909,10.82 30.8509091,5.37818182 36.2909091,0 C37.5272727,1.23636364 38.7636364,2.47272727 40,3.70909091 C34.56,9.14909091 29.12,14.5909091 23.74,19.9690909 C29.12,25.4090909 34.56,30.8509091 40,36.2909091 C38.7636364,37.5272727 37.5272727,38.7636364 36.2909091,40 C30.8509091,34.56 25.4090909,29.12 19.9690909,23.74 C14.5909091,29.12 9.14909091,34.56 3.70909091,40 C2.47272727,38.7636364 1.23636364,37.5272727 0,36.2909091 C5.37818182,30.8509091 10.82,25.4090909 16.26,19.9690909 C10.82,14.5909091 5.37818182,9.14909091 0,3.70909091",id:"path-1"})),Sr=d.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},d.a.createElement("g",{transform:"translate(-3742.000000, -945.000000)",id:"Icons"},d.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},d.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},d.a.createElement("g",{id:"Icons/Close",transform:"translate(401.000000, 161.000000)"},d.a.createElement("g",{id:"Colors/Grey"},d.a.createElement("mask",{id:"mask-2",fill:"white"},d.a.createElement("use",{xlinkHref:"#path-1"})),d.a.createElement("use",{id:"Mask",fill:"#A3A5AB",xlinkHref:"#path-1"}),d.a.createElement("g",{mask:"url(#mask-2)",fill:"#A3A5AB",id:"Rectangle"},d.a.createElement("rect",{x:0,y:0,width:40,height:40})))))))),Dr=function(e){var t=e.svgRef,n=e.title,r=jr(e,["svgRef","title"]);return d.a.createElement("svg",kr({width:"40px",height:"40px",viewBox:"0 0 40 40",ref:t},r),void 0===n?wr:n?d.a.createElement("title",null,n):null,Er,_r,Sr)},Pr=d.a.forwardRef((function(e,t){return d.a.createElement(Dr,kr({svgRef:t},e))})),Tr=(n.p,n(1071));n(1718);function Rr(){return(Rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function xr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Mr,Nr,Vr,Ar,Ir=d.a.createElement("defs",null,d.a.createElement("path",{stroke:"#989898",strokeWidth:2.5,id:"search-a",d:"M18.8812955,7.65954906 C12.6931781,7.65954906 7.65954906,12.6931781 7.65954906,18.8812955 C7.65954906,25.0686667 12.6931781,30.103042 18.8812955,30.103042 C25.069413,30.103042 30.103042,25.0686667 30.103042,18.8812955 C30.103042,12.6931781 25.069413,7.65954906 18.8812955,7.65954906 L18.8812955,7.65954906 Z M40.7613504,41.7777778 L27.306001,28.3224284 C25.0664279,30.322447 22.1134152,31.5403688 18.8812955,31.5403688 C11.9006334,31.5403688 6.22222222,25.8612114 6.22222222,18.8812955 C6.22222222,11.9006334 11.9006334,6.22222222 18.8812955,6.22222222 C25.8619577,6.22222222 31.5403688,11.9006334 31.5403688,18.8812955 C31.5403688,22.1134152 30.322447,25.0664279 28.3224284,27.306001 L41.7777778,40.7613504 L40.7613504,41.7777778 Z"})),Ur=d.a.createElement("use",{fillRule:"evenodd",xlinkHref:"#search-a"}),Lr=function(e){var t=e.svgRef,n=e.title,r=xr(e,["svgRef","title"]);return d.a.createElement("svg",Rr({width:48,height:48,viewBox:"0 0 48 48",ref:t},r),n?d.a.createElement("title",null,n):null,Ir,Ur)},Fr=d.a.forwardRef((function(e,t){return d.a.createElement(Lr,Rr({svgRef:t},e))})),zr=(n.p,function(e){var t=u.useCallback((function(t){return e.onChange(t.target.value)}),[e.onChange]),n=u.useCallback((function(){return e.onChange("")}),[e.onChange]);return u.createElement("div",{className:"search-input"},u.createElement(Fr,{className:"search-icon"}),u.createElement(Tr.a,Object.assign({},e,{onChange:t,alwaysShowPlaceholder:!0,placeholder:e.placeholder||"Search"})),e.value&&u.createElement(Pr,{className:"btn-clear",onClick:n}))}),Br=(n(1719),function(e){return u.createElement("div",{className:"list-controls"},void 0!==e.filter&&e.onFilterChange&&u.createElement(zr,{onChange:e.onFilterChange,value:e.filter,placeholder:e.filterPlaceholder}),e.sortOptions&&e.sortBy&&e.onSortTypeChange&&u.createElement("div",{className:"control"},u.createElement(Cr.a,{value:e.sortBy,onChange:e.onSortTypeChange},Object.entries(e.sortOptions).map((function(e){var t=Object($n.a)(e,2),n=t[0],r=t[1];return u.createElement(Or.a,{key:n,value:r},r)})))))}),Wr=n(1221),Hr=(n(1720),function(){return u.createElement("div",{className:"dashboard-loading"},u.createElement(At.a,null),u.createElement("div",null,"Loading"))}),Kr=(n(1721),Mr=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.onClick(this.props.course)}},{key:"onPreview",value:function(e){e.stopPropagation(),this.props.onPreview(this.props.course)}},{key:"render",value:function(){var e=this.props.course;return u.createElement(gr.a,{className:"recorded-session"+(this.disabled?" disabled":""),onClick:this.onClick,attribute:e.name},this.disabled?u.createElement("div",{className:"cannot-schedule-message"},this.isTemplateDeleted&&"You cannot schedule a recording which uses a deleted cloud desktop.",!this.hasRecording&&"You cannot schedule a recording that does not have a recorded task."):null,u.createElement("div",{className:"header"},u.createElement("div",{className:"name"},e.name),u.createElement("div",{className:"duration"},!!this.totalDuration&&"(".concat(Object(ot.a)(this.totalDuration),")"))),u.createElement("div",{className:"screenshot",onClick:this.onPreview},u.createElement("div",{className:"translucent-layer"}),this.hasRecording?u.createElement("i",{className:"fa fa-play"}):null,u.createElement("img",{src:this.screenshot,width:"200",height:"150",alt:""})),u.createElement("div",{className:"info"},u.createElement("ul",null,e.chapters.map((function(e,t){return u.createElement("li",{className:"chapter-info",key:"chapter-"+t},u.createElement("span",null,t+1,". ",e.name),e.type===P.s.Instruction?u.createElement("span",{className:"duration","data-duration":Math.floor(e.duration/1e3)},Object(ot.a)(e.duration)):u.createElement("span",{className:"challenge-icon"},u.createElement("i",{className:"fa fa-trophy"})))})))))}},{key:"screenshot",get:function(){var e=this.props.templates.get(this.props.course.templateId);return Object(g.g)(this.props.templates,e)}},{key:"hasRecording",get:function(){return this.props.course.chapters.filter((function(e){return!!e.videoUrl})).size}},{key:"isTemplateDeleted",get:function(){var e=this,t=this.props.templates.find((function(t){return t.id===e.props.course.templateId}));return!t||t.state===P.ab.Deleted}},{key:"disabled",get:function(){return this.props.disableUnscheduleable&&(!this.hasRecording||this.isTemplateDeleted)}},{key:"totalDuration",get:function(){return this.props.course.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0)}}]),t}(u.Component),Object(C.a)(Mr.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(Mr.prototype,"onClick"),Mr.prototype),Object(C.a)(Mr.prototype,"onPreview",[j.a],Object.getOwnPropertyDescriptor(Mr.prototype,"onPreview"),Mr.prototype),Mr),Yr=(n(1722),Nr=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={filter:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recordings-list"},this.props.loadingInitialData?u.createElement(Hr,null):u.createElement(u.Fragment,null,u.createElement(Br,{filter:this.state.filter,onFilterChange:this._onFilterChange,filterPlaceholder:"Search recordings"}),u.createElement(Wr.a,null,u.createElement(gr.a,{className:"new-recording",onClick:this._onNewRecording},u.createElement("div",{className:"create-icon"}),u.createElement("p",null,"Create New Recording")),this._sortedFilteredRecordings.map((function(t){return u.createElement(Kr,{course:t,templates:e.props.templates,disableUnscheduleable:e.props.disableUnscheduleable,dispatch:e.props.dispatch,key:"rs-"+t.id,onClick:e.props.onRecordingClick,onPreview:e.props.onRecordingPreviewClick})})))))}},{key:"_onNewRecording",value:function(){this.props.dispatch(Object(Y.Hb)(Y.S))}},{key:"_onFilterChange",value:function(e){this.setState({filter:e})}},{key:"_sortedFilteredRecordings",get:function(){var e=this.state.filter.toLowerCase();return this.props.recordings.filter((function(t){return t.name.toLowerCase().includes(e)}))}}]),t}(u.Component),Object(C.a)(Nr.prototype,"_onNewRecording",[j.a],Object.getOwnPropertyDescriptor(Nr.prototype,"_onNewRecording"),Nr.prototype),Object(C.a)(Nr.prototype,"_onFilterChange",[j.a],Object.getOwnPropertyDescriptor(Nr.prototype,"_onFilterChange"),Nr.prototype),Nr);!function(e){e[e.Update=0]="Update",e[e.Screenshot=1]="Screenshot"}(Ar||(Ar={}));var Gr,Jr=(Vr=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._recordingDetails=void 0,n._chapterVmService=new Yt(Object(X.a)(n)),n.state={courseId:null,selectedTemplate:null,vm:null,courseVmId:null,selectedChapterId:null},n._redirectIfNoData(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onRecordingSelect",value:function(e){this.setState({courseId:e.id})}},{key:"onRecordingPreview",value:function(e){this.onRecordingSelect(e);var t=e.chapters.filter((function(e){return!!e.videoUrl}));if(t.count()){var n=t.first();this.onChapterPreview(n)}}},{key:"toggleRecordingDetailsModal",value:function(){this.recordingDetailsVisibility&&this.setState({courseId:null})}},{key:"customizeRecordingVm",value:function(e,t){var n=this;return this.setState({selectedTemplate:t}),this._createVmFromTemplate(t).then((function(){e===Ar.Update?n.props.dispatch(Object(h.g)(Y.U)):e===Ar.Screenshot&&n.props.dispatch(Object(h.g)(Y.T))}))}},{key:"endOfTemplateCustomization",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.Z)),this.setState({vm:new P.kb({}),selectedTemplate:null},(function(){e._recordingDetails&&e._recordingDetails.toggleVMDetailsModal(!0)}))}},{key:"onExitChapterRecordingOrPreview",value:function(){this.setState({selectedChapterId:null}),this.props.dispatch(Object(h.g)(Y.Z))}},{key:"onChapterRecord",value:function(e){var t=this;this.setState({selectedChapterId:e.id}),this._chapterVmService.requestVm().then((function(){return t.props.dispatch(Object(h.g)(Y.Y))}))}},{key:"onChapterPreview",value:function(e){this.setState({selectedChapterId:e.id}),this.props.dispatch(Object(h.g)(Y.X))}},{key:"onChapterRecordUnsupported",value:function(){this.props.dispatch(Object(h.g)(Y.ab))}},{key:"onUnsupportedRecordingBack",value:function(){this.props.dispatch(Object(h.g)(Y.Z))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recordings"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.Z,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Yr,{recordings:e.recordedSessions,templates:e.props.templates,loadingInitialData:e.props.loadingInitialData,dispatch:e.props.dispatch,onRecordingClick:e.onRecordingSelect,onRecordingPreviewClick:e.onRecordingPreview}),e.course?u.createElement(br,{onRef:function(t){return e._recordingDetails=t},course:e.course,visible:e.recordingDetailsVisibility,showVmDetails:!0,user:e.props.user,templates:e.props.templates,courses:e.props.courses,rooms:e.props.rooms,onToggle:e.toggleRecordingDetailsModal,onVmCustomize:function(t){return e.customizeRecordingVm(Ar.Update,t)},onVmScreenshotUpdate:function(t){return e.customizeRecordingVm(Ar.Screenshot,t)},onChapterRecord:e.onChapterRecord,onChapterPreview:e.onChapterPreview,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cardModalCtrl:e.props.cardModalCtrl,cardModalVisible:e.props.cardModalVisible,onChapterRecordUnsupported:e.onChapterRecordUnsupported}):null)}}),u.createElement(y.b,{path:Y.U,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(fn,{dispatch:e.props.dispatch,vm:e.state.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.state.selectedTemplate,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.T,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(hn,{dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.Y,exact:!0,render:function(){return e.course&&e.selectedChapter&&e.selectedCourseVm?u.createElement($e,{dispatch:e.props.dispatch,vm:e.selectedCourseVm,course:e.course,chapter:e.selectedChapter,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,onExit:e.onExitChapterRecordingOrPreview}):null}}),u.createElement(y.b,{path:Y.X,exact:!0,render:function(){return e.course&&e.selectedChapter?u.createElement(Kt,{course:e.course,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,chapter:e.selectedChapter,currentChapter:e.props.currentChapter,onExit:e.onExitChapterRecordingOrPreview}):null}}),u.createElement(y.b,{path:Y.ab,exact:!0,render:function(){return u.createElement(ee,{onBack:e.onUnsupportedRecordingBack})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromTemplate",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.getVMAndConnection(e,!0)).then((function(e){t.setState({vm:e})}))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=(Object(Y.Eb)(e,Y.Y)||Object(Y.Eb)(e,Y.X))&&(!this.course||!this.state.selectedChapterId),n=(Object(Y.Eb)(e,Y.U)||Object(Y.Eb)(e,Y.T))&&(!this.state.vm||!this.state.selectedTemplate);(t||n)&&this.props.dispatch(Object(h.h)(Y.Z))}},{key:"recordedSessions",get:function(){return this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList()}},{key:"recordingDetailsVisibility",get:function(){return!!this.state.courseId}},{key:"course",get:function(){return this.props.courses.get(this.state.courseId||"")||null}},{key:"selectedChapter",get:function(){var e=this;return this.course&&this.state.selectedChapterId?this.course.chapters.find((function(t){return t.id===e.state.selectedChapterId})):null}},{key:"selectedCourseVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(C.a)(Vr.prototype,"onRecordingSelect",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onRecordingSelect"),Vr.prototype),Object(C.a)(Vr.prototype,"onRecordingPreview",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onRecordingPreview"),Vr.prototype),Object(C.a)(Vr.prototype,"toggleRecordingDetailsModal",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"toggleRecordingDetailsModal"),Vr.prototype),Object(C.a)(Vr.prototype,"customizeRecordingVm",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"customizeRecordingVm"),Vr.prototype),Object(C.a)(Vr.prototype,"endOfTemplateCustomization",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"endOfTemplateCustomization"),Vr.prototype),Object(C.a)(Vr.prototype,"onExitChapterRecordingOrPreview",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onExitChapterRecordingOrPreview"),Vr.prototype),Object(C.a)(Vr.prototype,"onChapterRecord",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onChapterRecord"),Vr.prototype),Object(C.a)(Vr.prototype,"onChapterPreview",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onChapterPreview"),Vr.prototype),Object(C.a)(Vr.prototype,"onChapterRecordUnsupported",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onChapterRecordUnsupported"),Vr.prototype),Object(C.a)(Vr.prototype,"onUnsupportedRecordingBack",[j.a],Object.getOwnPropertyDescriptor(Vr.prototype,"onUnsupportedRecordingBack"),Vr.prototype),Vr),Zr=n(291),qr=n.n(Zr),Xr=n(1222),$r=n(1193),Qr=n(1140),eo=(n(1730),Gr=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={showContent:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"toggleContent",value:function(){this.setState({showContent:!this.state.showContent})}},{key:"render",value:function(){var e=this.props.hidden&&!this.state.showContent?"*".repeat(40):this.props.data;return u.createElement("div",{className:"lti-item "+(this.props.className||"")},u.createElement("span",{className:"label"},this.props.label),u.createElement("div",{className:"data-wrapper"},u.createElement("div",{className:"data",onClick:this.toggleContent},e),u.createElement(Qr.a,{className:"copy-button",value:this.props.data},"Copy")))}}]),t}(u.PureComponent),Object(C.a)(Gr.prototype,"toggleContent",[j.a],Object.getOwnPropertyDescriptor(Gr.prototype,"toggleContent"),Gr.prototype),Gr),to=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"lti-details"},u.createElement(eo,{label:"Launch URL",className:"url",data:this.props.url}),u.createElement(eo,{label:"Consumer Key",className:"key",data:this.props.consumerKey,hidden:!0}),u.createElement(eo,{label:"Secret",className:"secret",data:this.props.secret,hidden:!0}))}}]),t}(u.PureComponent),no=(n(1731),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"room-link"},u.createElement("span",{className:"invite-link-label"},"Invite link:"),u.createElement("span",{className:"invite-link"},ce.a.ShortURL,"/",u.createElement("span",null,this.props.secret.toLowerCase())),u.createElement(Qr.a,{className:"join-room-button",value:this.props.url,disabled:this.props.disabled},"Copy"),u.createElement(G.a,null,"Your learners can join this session using this invite link."))}}]),t}(u.PureComponent)),ro=ce.a.RoomStartDelay,oo=ce.a.TemplateCopyDelay,ao=ce.a.RoomDurationLimit,io=60*ao;function so(e,t){var n=!!qr.a.tz.zone(t)?t:qr.a.tz.guess();return qr.a.tz(e.format("MM-DD-YYYY HH:mm"),"MM-DD-YYYY HH:mm",n)}function co(e,t,n,r){var o=null,a=po(t),i=qr()(),s=i.add(a,"minutes").startOf("minute").diff(qr()(e.startTime))>0;if(n&&n.startTime.getTime()!==e.startTime.getTime()&&i.diff(qr()(n.startTime))>0&&i.diff(qr()(n.expirationTime))<0)o=new P.I({type:P.J.Info,text:"The session start time cannot be changed while the session is running"});else if(n&&n.startTime.getTime()!==e.startTime.getTime()&&(i.diff(qr()(n.expirationTime))>0||n.endTime&&i.diff(qr()(n.endTime))>0))o=new P.I({type:P.J.Info,text:"The session time cannot be changed after it ended"});else if((n&&n.startTime.getTime()!==e.startTime.getTime()||!n)&&s){var c="Please set the start time";a>0&&(c+=" at least ".concat(a," minute").concat(1===a?"":"s")),c+=" in future.",o=new P.I({type:P.J.Info,text:c})}else if(r&&r>qr()(e.expirationTime).diff(qr()(e.startTime))){var p=Object(x.c)(Math.round(r/1e3));o=new P.I({type:P.J.Info,text:"The duration of the session cannot be shorter than the recording duration (".concat(p,")")})}else if(i.diff(qr()(e.expirationTime))>0)o=new P.I({type:P.J.Info,text:"The session end time cannot be in the past"});else if(qr()(e.expirationTime).subtract(2,"minute").diff(qr()(e.startTime))<0)o=new P.I({type:P.J.Info,text:"The session duration cannot be less than ".concat(2," minutes")});else if(n&&0!==qr()(n.expirationTime).diff(qr()(e.expirationTime))||!n){qr()(e.expirationTime).diff(qr()(e.startTime),"minutes")>io&&(o=new P.I({type:P.J.Error,title:"Invalid duration",text:"The session cannot be longer than ".concat(ao," hours")}))}return{isValid:!o,notification:o}}function po(e){var t=0;return e.state!==P.ab.Ready&&(t+=oo),e.defaultTemplate||(t+=ro),e.defaultTemplate&&(t=0),t}function lo(e,t,n){var r=t.diff(e);return qr()(n).add(r,"ms")}function uo(e,t,n,r){var o=so(t,r).toDate(),a=so(n,r).toDate();return e.withMutations((function(e){return e.set("startTime",o).set("expirationTime",a)}))}var ho,mo,fo=function(e,t,n,r){var o;t.type===P.y.Recorded&&(o=t.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t})));var a=co(n,e.templates.get(t.templateId),r,o);return!a.isValid&&a.notification&&e.dispatch(new v.i(a.notification)),a.isValid},yo=(n(1732),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this._formatDuration();return u.createElement("div",{className:"active-session"},"00:00:00"!==e?u.createElement(u.Fragment,null,"This session will start in",u.createElement("div",{className:"duration"},this._formatDuration()),u.createElement("div",{className:"join-session-button",onClick:this.props.join},"Join")):u.createElement(u.Fragment,null,"The session is now running",u.createElement("div",{className:"join-session-button running",onClick:this.props.join},"Join")))}},{key:"_formatDuration",value:function(){return this.props.startsIn?m.utc(this.props.startsIn.as("milliseconds")).format("HH:mm:ss"):"00:00:00"}}]),t}(u.Component)),vo=(n(1733),function(e){var t=e.endedAt.format("MMM D, YYYY"),n=e.endedAt.format("h:mma"),r=Zr.tz(e.timezone).format("Z");return u.createElement("div",{className:"ended-session"},u.createElement("i",{className:"fa fa-calendar-times-o","aria-hidden":"true"}),u.createElement("span",null,"Ended on ",t," at ",n," (GMT ",r,")"))});n(1734);!function(e){e[e.None=0]="None",e[e.RecordingDetails=1]="RecordingDetails",e[e.SessionDetails=2]="SessionDetails"}(mo||(mo={}));var bo=Zr.tz.guess(),go=(ho=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._interval=void 0,n._minTimeInterval=void 0;var r=n.startsIn>0&&n.startsIn<=9e5;return n.state={isDuplicatedSession:!1,startsIn:r?n.startsInDuration:null,deleteConfirmationModalVisible:!1,isVmDetailsModalVisible:!1,isDefaultVmDetailsModalVisible:!1,isRecordingDetailsModalVisible:!1,isSaving:!1,isDeleting:!1,vmCustomizer:mo.None,minTime:n.minTime},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.showJoin&&this.startsIn>0&&(this._interval=setInterval((function(){var t=e.startsInDuration;(!e.showJoin||e.startsIn<=0)&&clearInterval(e._interval),e.setState({startsIn:t})}),1e3)),this.props.onRef&&this.props.onRef(this),this._minTimeInterval=setInterval((function(){e.state.minTime.isSame(e.minTime,"minute")||e.setState({minTime:e.minTime})}),1e3)}},{key:"componentWillReceiveProps",value:function(e){if(e.startTime!==this.props.startTime&&this.props.expirationTime){var t=lo(this.props.startTime,this.props.expirationTime,e.startTime);this.props.change("expirationTime",t)}}},{key:"componentWillUnmount",value:function(){clearInterval(this._interval),clearInterval(this._minTimeInterval)}},{key:"save",value:function(e){e.preventDefault();var t=this.state.isDuplicatedSession,n=this._prepareCourse(t),r=this._prepareRoom(t);t?this._duplicateSession(this.course.type===P.y.Recorded?this.course:n,r):this._updateSession(n,r)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({deleteConfirmationModalVisible:!this.state.deleteConfirmationModalVisible})}},{key:"toggleLRSEndModalVisible",value:function(e){this.setState({deleteConfirmationModalVisible:e})}},{key:"onConfirmDeletion",value:function(){return this._deleteSession(this.course,this.props.room)}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("editSession")),this.props.onToggle()}},{key:"duplicate",value:function(){var e=this;if(this.course.deleted)this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"Cannot duplicate session. It uses a recording that is deleted"})));else{var t=function(){e._updateDateAndTimeFields(),e.setState({isDuplicatedSession:!0})};this.props.user.creditCards.size?t():(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then(t.bind(this)))}}},{key:"join",value:function(){var e=Object(Y.Pb)(this.props.room.secret);this.props.dispatch(Object(h.g)(e))}},{key:"requestRoomExtend",value:function(){this.props.dispatch(this.props.asyncActions.requestRoomExtend(this.props.room))}},{key:"onRecordingChange",value:function(e,t){var n=this.props.courses.get(t);this.props.dispatch(Object(E.a)("editSession","courseName",n.name)),this.props.dispatch(Object(E.a)("editSession","description",n.description)),this.props.dispatch(Object(E.a)("editSession","templateId",n.templateId))}},{key:"showRoomCost",value:function(){var e=this.props;(0,e.dispatch)(e.asyncActions.loadRoomCost(this.props.room))}},{key:"showVMDetails",value:function(e){this.template&&(this.setState({vmCustomizer:e}),this.template.defaultTemplate||Object(g.h)(this.template)?this.updateDefaultVMDetailsModalVisibility(!0):this.updateVMDetailsModalVisibility(!0))}},{key:"updateVMDetailsModalVisibility",value:function(e){e||this.setState({vmCustomizer:mo.None}),this.setState({isVmDetailsModalVisible:e})}},{key:"updateDefaultVMDetailsModalVisibility",value:function(e){this.setState({isDefaultVmDetailsModalVisible:e})}},{key:"onVmCustomize",value:function(e){return this.state.vmCustomizer!==mo.None?this.props.onVmCustomize(e,this.state.vmCustomizer):Promise.reject("Missing VM customizer")}},{key:"onVmScreenshotUpdate",value:function(e){return this.state.vmCustomizer!==mo.None?this.props.onVmScreenshotUpdate(e,this.state.vmCustomizer):Promise.reject("Missing VM customizer")}},{key:"updateRecordingDetailsModalVisibility",value:function(){this.state.isRecordingDetailsModalVisible&&(this.props.dispatch(Object(E.a)("editSession","courseName",this.course.name)),this.props.dispatch(Object(E.a)("editSession","description",this.course.description)),this.props.dispatch(Object(E.a)("editSession","templateId",this.course.templateId))),this.setState({isRecordingDetailsModalVisible:!this.state.isRecordingDetailsModalVisible})}},{key:"openVMDetails",value:function(){var e=Object(re.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("editSession"));case 2:this.showVMDetails(mo.SessionDetails);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openRecordingDetails",value:function(){var e=Object(re.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("editSession"));case 2:this.updateRecordingDetailsModalVisibility();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.course.type===P.y.Recorded,n=this.isSessionAboutToStartOrRunning||this.isRoomExpiredOrEnded;return u.createElement("div",{className:"edit-session-modal"},u.createElement(R.a,{title:this.title,visible:this.props.visible,transparent:this.isModalTransparent,onToggle:this.props.onToggle,scrollable:!0},u.createElement("div",{className:"session-actions"},u.createElement(u.Fragment,null,u.createElement(T.a,{className:"empty small purple",onClick:this.duplicate,disabled:this.state.isDuplicatedSession},"Duplicate"),this.props.user.permissions.contains(P.eb.RequestRoomExtend)?u.createElement(T.a,{className:"empty small purple",onClick:this.requestRoomExtend},"Request Extend"):null,this.isRoomExpiredOrEnded?u.createElement(T.a,{className:"empty small purple",onClick:this.showRoomCost},"Costs"):null)),this.isRoomExpiredOrEnded?u.createElement(vo,{endedAt:this.endedAt,timezone:bo}):null,this.showJoin?u.createElement(yo,{join:this.join,startsIn:this.state.startsIn}):null,this.showRoomLink?u.createElement(no,{dispatch:this.props.dispatch,disabled:this.state.isDuplicatedSession,secret:this.props.room.secret,url:this.roomLink}):null,this.state.isDuplicatedSession?u.createElement("div",{className:"duplicate-message"},'Note: This duplicate session is not saved yet. Please make any changes and click "Save"'):null,u.createElement("form",{name:"editSession",className:"session-details-form form-styles",onSubmit:this.save},u.createElement(T.h,null,u.createElement("legend",null,"Basics"),t?u.createElement("div",{className:"row selected-recording-row"},this.isSessionAboutToStartOrRunning&&this._getDisableMessage(),this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"recording",onChange:this.onRecordingChange,component:T.u,disabled:n},{label:"Recording",deletedOnMissingOption:!0}),this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList().map((function(t){return u.createElement(T.n,{key:"r-"+t.id,value:t.id,deleted:t.deleted,disabled:!e._hasRecordedChapter(t)},t.name)}))),u.createElement("p",{className:"field-info edit-details"+(this.course.deleted?" disabled":"")},u.createElement(tr,{skip:this.props.pristine,onConfirm:this.openRecordingDetails},"Recording Details"))):null,u.createElement("div",{className:"row session-name-row"},this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"courseName",component:T.s,type:"text",autoComplete:"off",disabled:this.isRoomExpiredOrEnded||t},{label:"Session Name"})),t?u.createElement("p",{className:"field-info edit-hint"+(this.course.delete?" disabled":"")},"Edit the name, description, and cloud desktop in recording details"):null),u.createElement("div",{className:"row description-row"},this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"description",component:T.v,rows:5,disabled:this.isRoomExpiredOrEnded||t},{label:"Session Description"})),!t&&u.createElement("div",{className:"field-info"},u.createElement("div",null,"Make your session's lobby page more descriptive."," ",u.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),u.createElement("div",{className:"row vm-row"},this.isSessionAboutToStartOrRunning&&!t&&this._getDisableMessage(),u.createElement(_.a,Object.assign({name:"templateId",component:T.u,disabled:this.disableVM},{label:"Cloud Desktop",deletedOnMissingOption:!0}),this.props.templates.filter((function(t){var n=t.state!==P.ab.Deleted;return e.template&&e.template.id===t.id&&Object(g.h)(t)?n:n&&(!!t.ownerId||t.defaultTemplate)})).toList().map((function(e){return u.createElement(T.n,{value:e.id,key:"vm-"+e.id,disabled:e.state!==P.ab.Ready||Object(g.h)(e)},e.name,Object(g.h)(e)?" - Legacy":"")}))),u.createElement("p",{className:"field-info"+(this.template&&this.template.state===P.ab.Ready?"":" disabled")},u.createElement(tr,{skip:this.props.pristine,onConfirm:this.openVMDetails},"Cloud Desktop Details")))),u.createElement(Xr.a,{fieldset:u.createElement(T.h,null),disabled:this.isRoomExpiredOrEnded}),u.createElement(T.h,null,u.createElement("legend",null,"Schedule"),u.createElement("div",{className:"row timezone-row"},n&&this._getDisableMessage(),u.createElement(_.a,Object.assign({name:"startTime",component:T.r,disabled:n},{label:"Start",minDate:this.state.minTime})),u.createElement("div",{className:"field-info"},u.createElement(_.a,{name:"timezone",component:T.w,disabled:this.isRoomExpiredOrEnded}))),u.createElement(_.a,Object.assign({name:"expirationTime",component:T.r,disabled:this.isRoomExpiredOrEnded},{label:"End",minDate:this.props.startTime}))),this.props.room.ltiURL?u.createElement(T.h,{className:"lti"},u.createElement("legend",null,"LTI Details"),u.createElement("div",{className:"row lti"},u.createElement(to,{url:this.props.room.ltiURL,consumerKey:this.props.room.ltiConsumerKey,secret:this.props.room.ltiSecret}),u.createElement("p",{className:"field-info"},"Use these values in the Coursera course's LTI Item settings"))):null,u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel,disabled:this.state.isSaving||this.state.isDeleting},"Cancel"),u.createElement(T.a,{disabled:this.isSaveButtonDisabled,loading:this.state.isSaving},"Save")),this.state.isDuplicatedSession?null:u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete Session"))))),this.renderModals())}},{key:"renderModals",value:function(){var e=this;return u.createElement(u.Fragment,null,this.props.room.longRunning?u.createElement($r.a,{type:$r.b.Delete,visible:this.state.deleteConfirmationModalVisible,onToggle:this.toggleLRSEndModalVisible}):u.createElement(xe.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Session",messages:['Are you sure you want to delete session "'.concat(this.props.course.name,'"?')],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),this.course.type===P.y.Recorded&&this.state.isRecordingDetailsModalVisible?u.createElement(br,{visible:this.state.isRecordingDetailsModalVisible,transparent:this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible,onToggle:this.updateRecordingDetailsModalVisibility,course:this.course,templates:this.props.templates,courses:this.props.courses,rooms:this.props.rooms,user:this.props.user,vmDetailsHidden:!0,onVmDetails:this.openVMDetails,onVmCustomize:function(){},onVmScreenshotUpdate:function(){},onChapterRecord:function(t){return e.props.onChapterRecord(e.course,t)},onChapterPreview:function(t){return e.props.onChapterPreview(e.course,t)},onChapterRecordUnsupported:this.props.onChapterRecordUnsupported,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,cardModalCtrl:this.props.cardModalCtrl}):null,this.template&&(this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible)?u.createElement(u.Fragment,null,u.createElement(Xn,{dispatch:this.props.dispatch,template:this.template,asyncActions:this.props.asyncActions,courses:this.props.courses,rooms:this.props.rooms,templates:this.props.templates,visible:this.state.isVmDetailsModalVisible,onToggle:this.updateVMDetailsModalVisibility,onCustomize:this.onVmCustomize,onScreenshotUpdate:this.onVmScreenshotUpdate}),u.createElement(jn,{template:this.template,visible:this.state.isDefaultVmDetailsModalVisible,onToggle:this.updateDefaultVMDetailsModalVisibility})):null)}},{key:"_getDisableMessage",value:function(){return this.isSessionAboutToStartOrRunning?u.createElement("div",{className:"disable-message"},this.isSessionRunning?"Can't change because a session has started":this.isSessionAboutToStart?"Can't change because a session is starting":""):null}},{key:"_prepareCourse",value:function(e){var t=this;return e?new P.x({name:this.props.courseName,description:this.props.description,templateId:this.props.templateId,type:this.course.type}):this.course.withMutations((function(e){return e.set("name",t.props.courseName).set("description",t.props.description).set("templateId",t.props.templateId)}))}},{key:"_prepareRoom",value:function(e){var t=this,n=so(this.props.startTime,this.props.timezone),r=so(this.props.expirationTime,this.props.timezone);return e?new P.P({region:this.props.region,expectedAttendees:this.props.customersNum,startTime:n.toDate(),expirationTime:r.toDate(),courseId:this.course.id,charge:this.props.charge,chargeAmount:this.props.chargeAmount}):this.props.room.withMutations((function(e){return e.set("region",t.props.region).set("expectedAttendees",t.props.customersNum).set("startTime",n.toDate()).set("expirationTime",r.toDate()).set("courseId",t.course.id).set("charge",t.props.charge).set("chargeAmount",t.props.chargeAmount)}))}},{key:"_updateDateAndTimeFields",value:function(){var e,t,n=(e=this.props.templates,!!(t=this.course)&&!e.find((function(e){return e.id===t.templateId&&e.defaultTemplate})))?ce.a.RoomStartDelay:5,r=this.props.expirationTime.diff(this.props.startTime),o=Zr().add(n,"m"),a=Zr(o).add(r,"ms");this.props.change("startTime",o),this.props.change("expirationTime",a)}},{key:"_updateSession",value:function(e,t){var n=this;if(this.template&&this.template.state!==P.ab.Deleted){if(this._validateTimeAndWarn(e,t,this.props.room)){var r=[this.props.dispatch(this.props.asyncActions.updateRoom(e,t))];e.type!==P.y.Recorded&&r.push(this.props.dispatch(this.props.asyncActions.updateCourse(e))),this.setState({isSaving:!0}),Promise.all(r).then((function(){return n.props.onToggle()})).catch((function(){return n.setState({isSaving:!1})}))}}else this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"Cannot update session. The selected cloud desktop was deleted. Please select a new one"})))}},{key:"_duplicateSession",value:function(e,t){var n=this;if(this.template&&this.template.state!==P.ab.Deleted){if(this._validateTimeAndWarn(e,t)){var r=Promise.resolve(e);e.type!==P.y.Recorded&&(r=this.props.dispatch(this.props.asyncActions.createCourse(new P.x({name:e.name,description:e.description,templateId:e.templateId,type:e.type})))),this.setState({isSaving:!0}),r.then((function(e){return n.props.dispatch(n.props.asyncActions.addRoom(e,t)).then((function(){return n.props.onToggle()}))})).catch((function(){return n.setState({isSaving:!1})}))}}else this.props.dispatch(new v.i(new P.I({type:P.J.Error,text:"Cannot save session. The selected cloud desktop was deleted. Please select a new one"})))}},{key:"_deleteSession",value:function(e,t){var n=this;this.setState({isDeleting:!0});var r=this.props.dispatch(this.props.asyncActions.deleteRoom(e,t)).then((function(){e.type===P.y.Live&&n.props.dispatch(n.props.asyncActions.deleteCourse(e)),n.props.onToggle()}));return r.catch((function(){return n.setState({isDeleting:!1})})),r}},{key:"_validateTimeAndWarn",value:function(e,t,n){return fo(this.props,e,t,n)}},{key:"_hasRecordedChapter",value:function(e){return e.chapters.filter((function(e){return!!e.videoUrl})).count()>0}},{key:"minTime",get:function(){return Zr().add(1,"minute").seconds(0)}},{key:"isRoomExpiredOrEnded",get:function(){return!this.state.isDuplicatedSession&&Object(En.g)(this.props.room)}},{key:"isSaveButtonDisabled",get:function(){return this.state.isDuplicatedSession?!this.props.valid:!this.props.valid||this.props.pristine||this.state.isDeleting}},{key:"endedAt",get:function(){var e=this.props.room.expirationTime,t=this.props.room.endTime;return Zr(t||e)}},{key:"roomLink",get:function(){return Object(Y.Cb)(this.props.room.secret)}},{key:"startsIn",get:function(){return this.props.room.startTime.getTime()-Zr.now()}},{key:"startsInDuration",get:function(){return Zr.duration(Math.max(this.startsIn,0))}},{key:"showJoin",get:function(){return this.startsIn<=9e5&&!this.isRoomExpiredOrEnded&&!this.state.isDuplicatedSession}},{key:"showRoomLink",get:function(){return this.props.room.secret&&!this.isRoomExpiredOrEnded&&!this.showJoin&&!this.state.isDuplicatedSession}},{key:"chaptersSize",get:function(){return this.props.course.chapters.filter((function(e){return!!e.videoUrl})).size}},{key:"course",get:function(){return this.props.recording?this.props.courses.get(this.props.recording):this.props.course}},{key:"template",get:function(){return this.props.templates.get(this.props.templateId||"")||null}},{key:"title",get:function(){return this.course.type===P.y.Live?this.state.isDuplicatedSession?"Duplicate Live Session":"Live Session Details":this.state.isDuplicatedSession?"Duplicate Recorded Session":"Recorded Session Details"}},{key:"isModalTransparent",get:function(){return!!this.props.cost.costs.size||this.props.cardModalVisible||this.state.deleteConfirmationModalVisible||this.state.isRecordingDetailsModalVisible||this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible}},{key:"isSessionRunning",get:function(){return Object(En.h)(this.props.room)}},{key:"isSessionAboutToStart",get:function(){return Object(En.f)(this.props.room)}},{key:"isSessionAboutToStartOrRunning",get:function(){return(this.isSessionAboutToStart||this.isSessionRunning)&&!this.state.isDuplicatedSession}},{key:"disableVM",get:function(){return this.isRoomExpiredOrEnded||this.course.type===P.y.Recorded||this.isSessionAboutToStartOrRunning}}]),t}(u.Component),Object(C.a)(ho.prototype,"save",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"save"),ho.prototype),Object(C.a)(ho.prototype,"toggleDeleteConfirmationModal",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"toggleDeleteConfirmationModal"),ho.prototype),Object(C.a)(ho.prototype,"toggleLRSEndModalVisible",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"toggleLRSEndModalVisible"),ho.prototype),Object(C.a)(ho.prototype,"onConfirmDeletion",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"onConfirmDeletion"),ho.prototype),Object(C.a)(ho.prototype,"cancel",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"cancel"),ho.prototype),Object(C.a)(ho.prototype,"duplicate",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"duplicate"),ho.prototype),Object(C.a)(ho.prototype,"join",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"join"),ho.prototype),Object(C.a)(ho.prototype,"requestRoomExtend",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"requestRoomExtend"),ho.prototype),Object(C.a)(ho.prototype,"onRecordingChange",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"onRecordingChange"),ho.prototype),Object(C.a)(ho.prototype,"showRoomCost",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"showRoomCost"),ho.prototype),Object(C.a)(ho.prototype,"showVMDetails",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"showVMDetails"),ho.prototype),Object(C.a)(ho.prototype,"updateVMDetailsModalVisibility",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"updateVMDetailsModalVisibility"),ho.prototype),Object(C.a)(ho.prototype,"updateDefaultVMDetailsModalVisibility",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"updateDefaultVMDetailsModalVisibility"),ho.prototype),Object(C.a)(ho.prototype,"onVmCustomize",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"onVmCustomize"),ho.prototype),Object(C.a)(ho.prototype,"onVmScreenshotUpdate",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"onVmScreenshotUpdate"),ho.prototype),Object(C.a)(ho.prototype,"updateRecordingDetailsModalVisibility",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"updateRecordingDetailsModalVisibility"),ho.prototype),Object(C.a)(ho.prototype,"openVMDetails",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"openVMDetails"),ho.prototype),Object(C.a)(ho.prototype,"openRecordingDetails",[j.a],Object.getOwnPropertyDescriptor(ho.prototype,"openRecordingDetails"),ho.prototype),ho),Oo=Object(S.a)({form:"editSession",validate:yn.r,enableReinitialize:!0})(go),Co=Object(D.a)("editSession"),ko=Object(w.c)((function(e,t){return{courseName:Co(e,"courseName"),description:Co(e,"description"),templateId:Co(e,"templateId"),customersNum:Co(e,"customersNum"),region:Co(e,"region"),startTime:Co(e,"startTime"),expirationTime:Co(e,"expirationTime"),timezone:Co(e,"timezone"),recording:Co(e,"recording"),charge:Co(e,"charge"),chargeAmount:Co(e,"chargeAmount"),initialValues:{courseName:t.course.name,description:t.course.description,templateId:t.course.templateId,customersNum:t.room.expectedAttendees,region:t.room.region,recording:t.course.id,startTime:Zr(t.room.startTime),expirationTime:Zr(t.room.expirationTime),timezone:bo,charge:t.room.charge,chargeAmount:t.room.chargeAmount}}}))(Oo),jo=n(49),wo=n(1735),Eo=n.n(wo);n(1913),n(1914),n(1915);function _o(e){var t=Object(En.g)(e),n=Object(En.h)(e);return t?e.cost?e.cost.costs.count():e.attendeesCount:n?e.attendeesCount:e.expectedAttendees===P.A.TwentyPlus?20:Number(e.expectedAttendees)}function So(e){return e&&e.state!==P.ab.Deleted?"".concat(e.name).concat(Object(g.h)(e)?" - Legacy":""):"- Deleted -"}function Do(e){var t=e.course.name,n=function(e){return e.room.longRunning?"\ud83d\udd53":e.course.type===P.y.Recorded?"\ud83c\udfa5":""}(e);return n?"".concat(n," ").concat(t):t}n(1916);var Po,To,Ro,xo,Mo,No=n(2002),Vo=n(1994),Ao=n(1058),Io=n(1121).isSelected,Uo=25,Lo=30,Fo=460,zo=1198,Bo=230,Wo=610,Ho=160,Ko=80,Yo=120,Go=(Ro=To=function(e){function t(e){var n;Object(i.a)(this,t);var r=(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._generateTableEvents(),o=n._calculateScroll(r);return n.state={tableEvents:r,scrollToIndex:o},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.events!==e.events){var t=this._generateTableEvents();this.setState({tableEvents:t})}if(this.props.events.length&&!e.events.length){var n=this._calculateScroll(this.state.tableEvents);this.setState({scrollToIndex:n})}}},{key:"render",value:function(){var e=this.props,t=e.events,n=e.localizer.messages;return u.createElement("div",{className:"agenda-view"},0!==t.length?u.createElement(u.Fragment,null,u.createElement("div",{className:"agenda-content"},u.createElement(No.a,{headerHeight:Uo,scrollToIndex:this.state.scrollToIndex,scrollToAlignment:"start",height:Math.min(Fo,this.state.tableEvents.length*Lo+Uo),width:zo,rowCount:this.state.tableEvents.length,rowHeight:Lo,rowGetter:this._rowGetter,rowRenderer:this._rowRenderer,gridStyle:{outline:"none"},className:"agenda-table",headerClassName:"agenda-header-cell"},u.createElement(Vo.a,{width:Bo,label:"Date & Time",dataKey:""}),u.createElement(Vo.a,{width:Wo,label:"Name",dataKey:""}),u.createElement(Vo.a,{width:Ho,label:"Cloud Desktop",dataKey:""}),u.createElement(Vo.a,{width:Ko,label:"Learners",dataKey:""}),u.createElement(Vo.a,{width:Yo,label:"Cost",dataKey:""}))),u.createElement("div",{className:"agenda-description"},"Note: For upcoming sessions, the learners and cost values are estimates")):u.createElement("span",{className:"agenda-empty"},n.noEventsInRange))}},{key:"_rowGetter",value:function(e){return this.state.tableEvents[e.index]}},{key:"_rowRenderer",value:function(e){var t=this,n=e.rowData,r=n.event,o=n.rangeDate,a=n.showRangeDate,i=this.props,s=i.accessors,c=i.getters,p=i.selected,l=i.localizer,d=i.components,h=d.event,m=d.date,f=s.title(r),y=s.end(r),v=s.start(r),b=c.eventProp(r,v,y,Io(r,p)),g=a&&l.format(o,"agendaDateFormat"),O=u.createElement("div",{className:"agenda-date-cell"},a?m?u.createElement(m,{day:o,label:g}):g:null),C=Object(En.g)(r.room),k=r.room.cost;return u.createElement("div",{key:e.index+"-"+r.room.id,className:b.className+" agenda-row",style:e.style,onClick:function(){return t.props.onSelectEvent(r)},"data-name":f},O,u.createElement("div",{className:"agenda-time-cell"},this._timeRangeLabel(o,r)),u.createElement("div",{className:"agenda-event-cell"},h?u.createElement(h,{event:r,title:f}):f),u.createElement("div",{className:"agenda-vm-cell"},So(r.template)),u.createElement("div",{className:"agenda-customers-cell"},_o(r.room)),u.createElement("div",{className:"agenda-cost-cell"},C&&k?u.createElement(u.Fragment,null,x.a[k.currency],Object(x.b)(k.total)," (",u.createElement("a",{href:"javascript:void(0);",onClick:function(e){e.stopPropagation(),t.props.onShowCost(r)}},"Details"),")"):u.createElement(u.Fragment,null,C?u.createElement(u.Fragment,null,u.createElement("i",{className:"fa fa-hourglass-half"})," ("):null,u.createElement("a",{href:"javascript:void(0);",onClick:function(e){e.stopPropagation(),t.props.onShowCost(r)}},"Estimate"),C?")":null)))}},{key:"_calculateScroll",value:function(e){if(!e.length)return 0;var t=new Date,n=Ao.startOf(t,"day"),r=e.filter((function(e){return e.rangeDate.getTime()===n.getTime()})),o=0;if(r.length){var a=r.filter((function(e){return e.event.room.startTime<t&&e.event.room.expirationTime>t}));if(a.length)o=e.findIndex((function(e){return e===a[0]}));else{var i=r.find((function(e){return e.event.room.startTime>t}));if(i){o=e.findIndex((function(e){return e===i}))}else{var s=r[r.length-1],c=e.findIndex((function(e){return e===s}));o=c===e.length-1?e.length-1:c+1}}}else{var p=e.findIndex((function(e){return e.event.room.startTime>t}));o=p>=0?p:e.length-1}return o-3<0?0:o-3}},{key:"_timeRangeLabel",value:function(e,t){var n=this.props,r=n.accessors,o=n.components,a=n.localizer,i=o.time,s="",c=a.messages.allDay,p=r.end(t),l=r.start(t);return r.allDay(t)||(Ao.eq(l,p,"day")?c=a.format({start:l,end:p},"agendaTimeRangeFormat"):Ao.eq(e,l,"day")?c=a.format(l,"agendaTimeFormat"):Ao.eq(e,p,"day")&&(c=a.format(p,"agendaTimeFormat"))),Ao.gt(e,l,"day")&&(s="continues-prior"),Ao.lt(e,p,"day")&&(s+=" continues-after"),u.createElement("span",{className:s.trim()},i?u.createElement(i,{event:t,day:e,label:c}):c)}},{key:"_generateRange",value:function(e){var t=new Set;return e.forEach((function(e){var n=Ao.startOf(e.room.startTime,"day"),r=Ao.startOf(e.room.expirationTime,"day");Ao.range(n,r,"day").forEach((function(e){t.add(e.getTime())}))})),Array.from(t).map((function(e){return new Date(e)}))}},{key:"_getDateEvents",value:function(e,t,n){var r=Ao.startOf(e,"day"),o=Ao.endOf(e,"day");return t.filter((function(e){var t=n.end(e),a=n.start(e);return a>=r&&a<=o||t>=r&&t<=r||a<r&&t>=r}))}},{key:"_generateTableEvents",value:function(){var e=this,t=[];return this._generateRange(this.props.events).forEach((function(n){e._getDateEvents(n,e.props.events,e.props.accessors).forEach((function(e,r){return t.push({rangeDate:n,showRangeDate:0===r,event:e})}))})),t}}]),t}(u.PureComponent),To.title=function(){return null},Po=Ro,Object(C.a)(Po.prototype,"_rowGetter",[j.a],Object.getOwnPropertyDescriptor(Po.prototype,"_rowGetter"),Po.prototype),Object(C.a)(Po.prototype,"_rowRenderer",[j.a],Object.getOwnPropertyDescriptor(Po.prototype,"_rowRenderer"),Po.prototype),Po),Jo=(n(1962),n(97));function Zo(e){return null}function qo(e){var t=e.data,n=e.className,r=e.filter,o=e.initialSortBy,a=e.initialSortOrder,i=e.onClick,s=e.classNameForRow,c=function(e){var t=[],n={};return d.a.Children.forEach(e,(function(e){var r=e.props.config;t.push(r.id),n[r.id]=r})),[t,n]}(e.children),p=Object($n.a)(c,2),l=p[0],h=p[1],m=function(e,t,n,r){var o=r.toLowerCase();return Object(u.useMemo)((function(){return r?e.filter((function(e){return t.some((function(t){var r=e[t],a=(n[t]||{}).formatter;return!!a&&-1!==a(r).toLowerCase().indexOf(o)}))})):e}),[e,o])}(t,l,h,r),f=function(e,t,n){var r=Object(u.useState)(t),o=Object($n.a)(r,2),a=o[0],i=o[1],s=Object(u.useState)(n),c=Object($n.a)(s,2),p=c[0],l=c[1],d=Object(u.useCallback)((function(t){a===t?l(p===Mo.Ascending?Mo.Descending:Mo.Ascending):(i(t),l(e[t].defaultSortOrder||Mo.Ascending))}),[p,a]);return[a,p,d]}(h,o,a),y=Object($n.a)(f,3),v=y[0],b=y[1],g=y[2],O=function(e,t,n,r){var o=r===Mo.Ascending?1:-1,a=t[n].comparator;return Object(u.useMemo)((function(){return Object(Jo.a)(e).sort((function(e,t){return a(e[n],t[n])*o}))}),[e,n,r,a])}(m,h,v,b),C=function(e,t){return Object(u.useCallback)((function(n){if(t){var r=n.currentTarget.dataset.index,o=e[Number(r||"-1")];o&&t(o)}}),[e,t])}(O,i);return d.a.createElement("table",{className:n},d.a.createElement("thead",null,d.a.createElement("tr",null,l.map((function(e){return d.a.createElement("th",{key:e,onClick:function(){return g(e)},className:e===v?Xo[b]:""},h[e].header)})))),d.a.createElement("tbody",null,O.map((function(e,t){return d.a.createElement("tr",{"data-index":t,key:"row-".concat(t),className:s?s(e):"",onClick:C},l.map((function(n){return d.a.createElement("td",{key:"".concat(n,"-").concat(t)},h[n].formatter(e[n]))})))}))))}!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(Mo||(Mo={}));var Xo=(xo={},Object($.a)(xo,Mo.Descending,"sort-descending"),Object($.a)(xo,Mo.Ascending,"sort-ascending"),xo);var $o=function(e){var t=e.onSelectEvent,n=e.events,r=e.getters,o=function(e){return d.a.useMemo((function(){return e.filter((function(e){return e.room.longRunning})).map((function(e){return{title:Do(e),startTime:e.room.startTime,expirationTime:e.room.endTime||e.room.expirationTime,template:So(e.template),attendeesCount:_o(e.room),event:e}}))}),[e])}(n),a=Object(u.useState)(""),i=Object($n.a)(a,2),s=i[0],c=i[1],p=Object(u.useCallback)((function(e){return t&&t(e.event)}),[t]),l=function(e){return Object(u.useCallback)((function(t){return e.eventProp(t.event).className||""}),[e])}(r);return d.a.createElement("div",{className:"lrs-view"},d.a.createElement("div",{className:"filter"},d.a.createElement("label",{htmlFor:"lrs-view-filter"},"Filter: "),d.a.createElement("input",{id:"lrs-view-filter",type:"text",value:s,onChange:function(e){return c(e.target.value)}})),d.a.createElement(qo,{data:o,initialSortBy:"startTime",initialSortOrder:Mo.Descending,filter:s,onClick:p,classNameForRow:l},d.a.createElement(Zo,{config:{id:"title",header:"Name",formatter:ea,comparator:ta}}),d.a.createElement(Zo,{config:{id:"startTime",header:"Start Time",formatter:na,comparator:ra,defaultSortOrder:Mo.Descending}}),d.a.createElement(Zo,{config:{id:"expirationTime",header:"Expiration Time",formatter:na,comparator:ra,defaultSortOrder:Mo.Descending}}),d.a.createElement(Zo,{config:{id:"template",header:"Cloud Desktop",formatter:ea,comparator:ta}}),d.a.createElement(Zo,{config:{id:"attendeesCount",header:"Learners",formatter:oa,comparator:aa,defaultSortOrder:Mo.Descending}})))},Qo=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.a.createElement($o,this.props)}}]),t}(d.a.PureComponent);Qo.title=function(){return null};var ea=function(e){return e},ta=function(e,t){return e.localeCompare(t)},na=function(e){return f()(e).format("ddd, D MMM, hh:mm a")},ra=function(e,t){return e.getTime()-t.getTime()},oa=function(e){return e.toString()},aa=function(e,t){return e-t},ia=(n(1963),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this._getDateLabel(this.props.date);return this.props.drilldownView?u.createElement("a",{href:"javascript:void(0);",onClick:this.props.onDrillDown},e):e}},{key:"_getDateLabel",value:function(e){var t=m(e),n=m(e).startOf("month"),r=m(e).endOf("month"),o=t.isSame(n,"dates"),a=t.isSame(r,"dates"),i=t.format("DD");if(o||a){var s=t.format("MMM");return u.createElement("span",{className:"date-label"},"".concat(s," ").concat(i))}return u.createElement("span",{className:"date-label"},i)}}]),t}(u.Component)),sa=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.event,t=m(e.room.startTime),n=m(e.room.endTime?e.room.endTime:e.room.expirationTime),r=t.isSame(n,"day")?"hh:mm a":"D MMM, hh:mm a",o="".concat(t.format(r)," - ").concat(n.format(r)),a=Do(e);return u.createElement("div",null,o,": ",a)}}]),t}(u.Component),ca=(n(1964),n(1075).navigate),pa=n(1205),la=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._docKeydownEventCb=void 0,n._nextArrow=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(document.addEventListener("keydown",this._docKeydownEventCb=function(t){return e._keyboardControl(t)}),this._nextArrow){var t=pa();this._nextArrow.style.right="".concat(t+5,"px")}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._docKeydownEventCb)}},{key:"changeView",value:function(e){this.props.onView(e)}},{key:"navigate",value:function(e){this.props.onNavigate(e)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"toolbar"},u.createElement("i",{className:"fa fa-caret-left navigation navigation-prev notification-"+this.props.view,onClick:function(){return e.navigate(ca.PREVIOUS)}}),u.createElement("div",{className:"views"},this.props.views.map((function(t){return u.createElement("div",{key:t,className:e.props.view===t?"active":"",onClick:function(){return e.changeView(t)}},e.props.localizer.messages[t])}))),u.createElement("i",{ref:function(t){return e._nextArrow=t},className:"fa fa-caret-right navigation navigation-next notification-"+this.props.view,onClick:function(){return e.navigate(ca.NEXT)}}))}},{key:"_keyboardControl",value:function(e){e.target===document.body&&(e.keyCode===ke.c?(e.preventDefault(),this.navigate(ca.PREVIOUS)):e.keyCode===ke.d&&(e.preventDefault(),this.navigate(ca.NEXT)))}}]),t}(u.Component),ua=n(1965),da=n(1243),ha=n(1075).navigate,ma=n(1058),fa=n(1205),ya=n(1231),va=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._allDayRowContent=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._checkUpdateAllDayForScrolling()}},{key:"componentDidUpdate",value:function(){this._checkUpdateAllDayForScrolling()}},{key:"render",value:function(){var e=this.props.date,n=t.range(e,this.props);return u.createElement(da,Object.assign({},this.props,{range:n,eventOffset:15}))}},{key:"_checkUpdateAllDayForScrolling",value:function(){var e=fa();if(!(e<=0)){this._allDayRowContent||(this._allDayRowContent=ya(Object(F.findDOMNode)(this),".rbc-row-content")[0]);var t=this._allDayRowContent;t.scrollHeight>t.clientHeight&&""===t.style.marginRight?t.style.marginRight="-".concat(e,"px"):t.scrollHeight<=t.clientHeight&&""!==t.style.marginRight&&(t.style.marginRight="")}}}]),t}(u.Component);va.range=function(e,t){var n=ma.startOf(e,"day"),r=ma.add(ma.endOf(e,"day"),6,"day");return ma.range(n,r)},va.title=function(e,t){var n=t.localizer,r=va.range(e,{localizer:n}),o=Object(ua.a)(r),a=o[0],i=o.slice(1);return n.format({start:a,end:i.pop()},"dayRangeHeaderFormat")},va.navigate=function(e,t){switch(t){case ha.PREVIOUS:return ma.add(e,-7,"day");case ha.NEXT:return ma.add(e,7,"day");default:return e}};n(1966);var ba,ga=n(1908),Oa=Eo.a.momentLocalizer(m),Ca=ga(Eo.a),ka={event:function(e){return Do(e.event)},toolbar:la,month:{dateHeader:ia,event:sa},timeGutterHeader:function(){return u.createElement("div",{className:"rbc-allday-text"},"all day")}},ja=new Date,wa=Math.max(ja.getHours()-6+1,0),Ea=new Date;Ea.setHours(wa,0,0);var _a,Sa,Da,Pa=(ba=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._eventStartAccessor=function(e){return e.room.startTime},n._eventEndAccessor=function(e){return e.room.endTime?e.room.endTime:e.room.expirationTime},n._eventTitleAccessor=function(e){return Do(e)},n._eventAllDayAccessor=function(e){return e.room.longRunning};var r=n._getAllSessions(n.props.courses,n.props.rooms),o=n._getEvents(r);return n.state={sessions:r,events:o},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.courses!==e.courses||this.props.rooms!==e.rooms){var t=this._getAllSessions(this.props.courses,this.props.rooms),n=this._getEvents(t);this.setState({sessions:t,events:n})}}},{key:"eventProps",value:function(e){return{className:this.eventStyles(e)}}},{key:"eventStyles",value:function(e){var t=new Date,n="";return e.room.startTime<t&&t<e.room.expirationTime&&(n="event-running"),e.room.startTime<t&&e.room.expirationTime<t&&(n="event-expired"),e.room.endTime&&e.room.startTime<t&&e.room.endTime<t&&(n="event-ended"),e.currentlySaving&&(n+=" event-saving"),this._isSibling(e)||(n+=" event-single"),n}},{key:"onSelectSlot",value:function(e){var t=function(e){return"string"===typeof e?new Date(e):e},n=t(e.start),r=t(e.end);this.props.onSelectSlot(m(n),m(r))}},{key:"onSelectEvent",value:function(e){var t=this._getSessionByEventDetails(e);t&&this.props.onSelectEvent&&this.props.onSelectEvent(t.course,t.room)}},{key:"onShowCost",value:function(e){this.props.onCostDetails&&this.props.onCostDetails(e.room)}},{key:"onEventDrag",value:function(e){var t=this,n=e.start,r=e.end,o=e.event;this.props.onEventDrag&&this.setState((function(e){var a=e.events,i=a.map((function(e){return e.room.id===o.room.id?Object(jo.a)({},o,{start:n,end:r,currentlySaving:!0}):e})),s=t._getSessionByEventDetails(o);if(s&&t.props.onEventDrag){var c=s.room.withMutations((function(e){return e.set("startTime",n).set("expirationTime",r)}));t.props.onEventDrag(s.course,c).then((function(e){e||t.setState({events:a})}))}return{events:i}}))}},{key:"render",value:function(){return u.createElement("div",{className:"rhyme-calendar"},u.createElement(Ca,{localizer:Oa,defaultView:"week",components:ka,defaultDate:ja,scrollToTime:Ea,formats:{dayFormat:"ddd, D MMM",agendaDateFormat:"ddd, D MMM",agendaTimeRangeFormat:function(e,t,n){var r=e.start,o=e.end;return n.format(r,"hh:mm a",t)+" - "+n.format(o,"hh:mm a",t)},dayHeaderFormat:"ddd, D MMM",agendaHeaderFormat:function(){return"ddd, D MMM"},dayRangeHeaderFormat:function(e,t,n){var r=e.start,o=e.end;return n.format(r,"D MMM",t)+" - "+n.format(o,"D MMM",t)},timeGutterFormat:"ha"},selectable:!0,resizable:!1,showMultiDayTimes:!0,popup:!0,popupOffset:40,step:20,timeslots:3,views:{lrs:Qo,agenda:Go,week:va,month:!0},startAccessor:this._eventStartAccessor,endAccessor:this._eventEndAccessor,titleAccessor:this._eventTitleAccessor,tooltipAccessor:this._eventTitleAccessor,allDayAccessor:this._eventAllDayAccessor,events:this.state.events,eventPropGetter:this.eventProps,onSelectSlot:this.onSelectSlot,onSelectEvent:this.onSelectEvent,onEventDrop:this.onEventDrag,onShowCost:this.onShowCost,messages:{lrs:"Long Running",agenda:"List",week:"Week",month:"Month",noEventsInRange:"There are not created sessions"}}))}},{key:"_isSibling",value:function(e){return!!this.state.events.filter((function(t){return t.room.id!==e.room.id})).find((function(t){return e.room.expirationTime>t.room.startTime&&t.room.expirationTime>e.room.startTime}))}},{key:"_getAllSessions",value:function(e,t){return e.count()&&t.count()?t.map((function(t){var n=e.get(t.courseId);return n?{room:t,course:n}:null})).filter((function(e){return!!e})).toArray():[]}},{key:"_getEvents",value:function(e){var t=this;return e.map((function(e){var n=e.room,r=e.course;return{currentlySaving:!1,room:n,course:r,template:t.props.templates.get(r.templateId)}})).filter((function(e){return!!e})).sort((function(e,t){var n=e.room,r=n.startTime,o=n.endTime,a=n.expirationTime,i=t.room,s=i.startTime,c=i.endTime,p=i.expirationTime,l=r.getTime()-s.getTime();return 0===l?o&&c?o.getTime()-c.getTime():a.getTime()-p.getTime():l}))}},{key:"_getSessionByEventDetails",value:function(e){return this.state.sessions.find((function(t){var n=t.room,r=t.course;return n.id===e.room.id&&r.id===e.course.id}))||null}}]),t}(u.PureComponent),Object(C.a)(ba.prototype,"eventProps",[j.a],Object.getOwnPropertyDescriptor(ba.prototype,"eventProps"),ba.prototype),Object(C.a)(ba.prototype,"onSelectSlot",[j.a],Object.getOwnPropertyDescriptor(ba.prototype,"onSelectSlot"),ba.prototype),Object(C.a)(ba.prototype,"onSelectEvent",[j.a],Object.getOwnPropertyDescriptor(ba.prototype,"onSelectEvent"),ba.prototype),Object(C.a)(ba.prototype,"onShowCost",[j.a],Object.getOwnPropertyDescriptor(ba.prototype,"onShowCost"),ba.prototype),Object(C.a)(ba.prototype,"onEventDrag",[j.a],Object.getOwnPropertyDescriptor(ba.prototype,"onEventDrag"),ba.prototype),ba),Ta=(n(1967),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"create-session-btn"},u.createElement(T.a,{className:"create-button",onClick:this.props.onClick},"Create Session"),u.createElement("span",{className:"line-separator"}))}}]),t}(u.Component)),Ra=(n(1968),_a=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._updateTimeout=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.room.startTime.getTime()-(new Date).getTime();e>0&&(this._updateTimeout=setTimeout(this.forceUpdate.bind(this),e))}},{key:"componentWillUnmount",value:function(){this._updateTimeout&&clearTimeout(this._updateTimeout)}},{key:"joinSession",value:function(){var e=this.props.room.secret;this.props.dispatch(Object(h.g)(Object(Y.Pb)(e)))}},{key:"render",value:function(){if(!this.course)return null;var e=this.course.name;return u.createElement("div",{className:"join-session-btn"},u.createElement("div",{className:"cont"},u.createElement("p",{className:"title"},"Session \u201c",e.length<=50?e:e.substr(0,50)+"...","\u201d start",(new Date).getTime()>=this.props.room.startTime.getTime()?"ed":"s"," ","at ",this.startTime),u.createElement("div",null,u.createElement(T.a,{onClick:this.joinSession},"Join Session"),u.createElement("a",{href:"javascript:void(0);",onClick:this.props.onSessionCreate},"Create Another Session"))))}},{key:"course",get:function(){return this.props.courses.get(this.props.room.courseId)}},{key:"startTime",get:function(){var e=m.tz.guess();return m(this.props.room.startTime).tz(e).format("h:mma ([GMT] Z)")}}]),t}(u.Component),Object(C.a)(_a.prototype,"joinSession",[j.a],Object.getOwnPropertyDescriptor(_a.prototype,"joinSession"),_a.prototype),_a);!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.NoCourses=2]="NoCourses"}(Da||(Da={}));var xa,Ma,Na=(Sa=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={loadState:e.loadingInitialData?Da.Loading:Da.Loaded},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.loadingInitialData!==e.loadingInitialData&&this.setState({loadState:this.props.loadingInitialData?Da.Loading:Da.Loaded})}},{key:"createSession",value:function(){this.props.dispatch(Object(h.g)(Y.nb))}},{key:"startScheduling",value:function(e,t){this.props.dispatch(Object(h.g)(Object(Y.Qb)(e.format(Y.cb),t.format(Y.cb))))}},{key:"onCostDetails",value:function(e){this.props.dispatch(this.props.asyncActions.loadRoomCost(e))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"sessions-list"},function(){switch(e.state.loadState){case Da.Loading:default:return u.createElement(Hr,null);case Da.Loaded:case Da.NoCourses:return e.renderScheduler()}}())}},{key:"renderScheduler",value:function(){var e=this.upcomingSession;return u.createElement("div",null,e?u.createElement(Ra,{dispatch:this.props.dispatch,room:e,courses:this.props.courses,onSessionCreate:this.createSession}):u.createElement(Ta,{onClick:this.createSession}),u.createElement(Pa,{rooms:this.props.rooms,courses:this.props.courses,templates:this.props.templates,onEventDrag:this._onEventDrag,onSelectEvent:this.props.onSessionSelect,onSelectSlot:this.startScheduling,onCostDetails:this.onCostDetails}))}},{key:"_onEventDrag",value:function(e,t){var n=this.props.rooms.find((function(e){return e.id===t.id}));if(fo(this.props,e,t,n)){var r=t.toJS();return this.props.dispatch(this.props.asyncActions.updateRoom(e,new P.P(r))).then((function(){return!0})).catch((function(){return!1}))}return Promise.resolve(!1)}},{key:"upcomingSession",get:function(){var e=(new Date).getTime(),t=this.props.rooms.filter((function(t){return t.startTime.getTime()-6e5<=e&&e<(t.endTime||t.expirationTime).getTime()})).sort((function(e,t){return e.startTime.getTime()-t.startTime.getTime()})).first();return t&&this.props.courses.get(t.courseId)?t:null}}]),t}(u.Component),Object(C.a)(Sa.prototype,"createSession",[j.a],Object.getOwnPropertyDescriptor(Sa.prototype,"createSession"),Sa.prototype),Object(C.a)(Sa.prototype,"startScheduling",[j.a],Object.getOwnPropertyDescriptor(Sa.prototype,"startScheduling"),Sa.prototype),Object(C.a)(Sa.prototype,"onCostDetails",[j.a],Object.getOwnPropertyDescriptor(Sa.prototype,"onCostDetails"),Sa.prototype),Object(C.a)(Sa.prototype,"_onEventDrag",[j.a],Object.getOwnPropertyDescriptor(Sa.prototype,"_onEventDrag"),Sa.prototype),Sa);n(1969);!function(e){e[e.Update=0]="Update",e[e.Screenshot=1]="Screenshot"}(Ma||(Ma={}));var Va,Aa,Ia,Ua,La,Fa,za,Ba,Wa,Ha=(xa=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._sessionDetails=void 0,n._chapterVmService=new Yt(Object(X.a)(n)),n.state={selectedSession:null,selectedTemplate:null,courseId:null,selectedChapterId:null,courseVmId:null,vm:null,vmCustomizer:null},n._redirectIfNoData(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"showSessionDetails",value:function(e,t){this.setState({selectedSession:{courseId:e.id,roomId:t.id}})}},{key:"toggleSessionDetailsModal",value:function(){this.sessionDetailsVisibility&&this.setState({selectedSession:null})}},{key:"customizeSessionVm",value:function(e,t,n){var r=this;return this.setState({selectedTemplate:t,vmCustomizer:n}),this._createVmFromTemplate(t).then((function(){e===Ma.Update?r.props.dispatch(Object(h.g)(Y.kb)):e===Ma.Screenshot&&r.props.dispatch(Object(h.g)(Y.jb))}))}},{key:"endOfTemplateCustomization",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.ob)),this.setState({vm:new P.kb({}),selectedTemplate:null},(function(){e._sessionDetails&&e.state.vmCustomizer&&(e.state.vmCustomizer===mo.SessionDetails?e._sessionDetails.updateVMDetailsModalVisibility(!0):(e._sessionDetails.updateRecordingDetailsModalVisibility(),e._sessionDetails.updateVMDetailsModalVisibility(!0)),e._sessionDetails.setState({vmCustomizer:e.state.vmCustomizer}))}))}},{key:"onChapterRecord",value:function(e,t){var n=this;this.setState({courseId:e.id,selectedChapterId:t.id},(function(){n._chapterVmService.requestVm().then((function(){return n.props.dispatch(Object(h.g)(Y.hb))}))}))}},{key:"onChapterPreview",value:function(e,t){this.setState({courseId:e.id,selectedChapterId:t.id}),this.props.dispatch(Object(h.g)(Y.fb))}},{key:"onChapterRecordUnsupported",value:function(){this.props.dispatch(Object(h.g)(Y.gb))}},{key:"reopenRecordingDetails",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.ob)),this.setState({courseId:null,selectedChapterId:null},(function(){e._sessionDetails&&e._sessionDetails.updateRecordingDetailsModalVisibility()}))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"sessions"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.ob,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Na,{courses:e.props.courses,rooms:e.props.rooms,templates:e.props.templates,user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,loadingInitialData:e.props.loadingInitialData,onSessionSelect:e.showSessionDetails}),e.selectedSessionCourse&&e.selectedSessionRoom?u.createElement(ko,{onRef:function(t){return e._sessionDetails=t},course:e.selectedSessionCourse,room:e.selectedSessionRoom,courses:e.props.courses,templates:e.props.templates,rooms:e.props.rooms,cost:e.props.cost,visible:e.sessionDetailsVisibility,user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cardModalCtrl:e.props.cardModalCtrl,cardModalVisible:e.props.cardModalVisible,onToggle:e.toggleSessionDetailsModal,onVmCustomize:function(t,n){return e.customizeSessionVm(Ma.Update,t,n)},onVmScreenshotUpdate:function(t,n){return e.customizeSessionVm(Ma.Screenshot,t,n)},onChapterRecord:e.onChapterRecord,onChapterPreview:e.onChapterPreview,onChapterRecordUnsupported:e.onChapterRecordUnsupported}):null)}}),u.createElement(y.b,{path:Y.kb,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(fn,{dispatch:e.props.dispatch,vm:e.state.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.state.selectedTemplate,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.jb,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(hn,{dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.hb,exact:!0,render:function(){return e.course&&e.selectedChapter&&e.selectedRecordingVm?u.createElement($e,{dispatch:e.props.dispatch,vm:e.selectedRecordingVm,course:e.course,chapter:e.selectedChapter,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,onExit:e.reopenRecordingDetails,remoteClientManager:e.props.remoteClientManager}):null}}),u.createElement(y.b,{path:Y.fb,exact:!0,render:function(){return e.course&&e.selectedChapter?u.createElement(Kt,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,course:e.course,chapter:e.selectedChapter,currentChapter:e.props.currentChapter,onExit:e.reopenRecordingDetails}):null}}),u.createElement(y.b,{path:Y.gb,exact:!0,render:function(){return u.createElement(ee,{onBack:e.reopenRecordingDetails})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromTemplate",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.getVMAndConnection(e,!0)).then((function(e){t.setState({vm:e})}))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=(Object(Y.Eb)(e,Y.hb)||Object(Y.Eb)(e,Y.fb))&&(!this.course||!this.selectedChapter),n=(Object(Y.Eb)(e,Y.kb)||Object(Y.Eb)(e,Y.jb))&&(!this.state.vm||!this.state.selectedTemplate);(t||n)&&this.props.dispatch(Object(h.h)(Y.ob))}},{key:"sessionDetailsVisibility",get:function(){return!!this.state.selectedSession}},{key:"selectedSessionCourse",get:function(){var e=this.state.selectedSession;return e?this.props.courses.get(e.courseId):null}},{key:"selectedSessionRoom",get:function(){var e=this.state.selectedSession;return e?this.props.rooms.find((function(t){return t.id===e.roomId})):null}},{key:"course",get:function(){return this.props.courses.get(this.state.courseId||"")}},{key:"selectedChapter",get:function(){var e=this;return this.course&&this.state.selectedChapterId?this.course.chapters.find((function(t){return t.id===e.state.selectedChapterId})):null}},{key:"selectedRecordingVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(C.a)(xa.prototype,"showSessionDetails",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"showSessionDetails"),xa.prototype),Object(C.a)(xa.prototype,"toggleSessionDetailsModal",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"toggleSessionDetailsModal"),xa.prototype),Object(C.a)(xa.prototype,"customizeSessionVm",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"customizeSessionVm"),xa.prototype),Object(C.a)(xa.prototype,"endOfTemplateCustomization",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"endOfTemplateCustomization"),xa.prototype),Object(C.a)(xa.prototype,"onChapterRecord",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"onChapterRecord"),xa.prototype),Object(C.a)(xa.prototype,"onChapterPreview",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"onChapterPreview"),xa.prototype),Object(C.a)(xa.prototype,"onChapterRecordUnsupported",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"onChapterRecordUnsupported"),xa.prototype),Object(C.a)(xa.prototype,"reopenRecordingDetails",[j.a],Object.getOwnPropertyDescriptor(xa.prototype,"reopenRecordingDetails"),xa.prototype),xa),Ka=(n(1970),n(1971),n(1128)),Ya=n(1132),Ga=n(1131),Ja=(n(1972),Va=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onConfirm",value:function(e){this.props.onConfirm(this.props.confirmPassword),this.props.dispatch(Object(E.a)("confirmChanges","confirmPassword","")),this.props.onToggle(!1),e.preventDefault()}},{key:"render",value:function(){return u.createElement("div",{className:"confirm-changes-modal form-styles"},u.createElement(R.a,{title:"Confirm Changes",onToggle:this.props.onToggle,visible:this.props.visible},u.createElement("form",{name:"confirmChanges",onSubmit:this.onConfirm},u.createElement("p",{className:"text"},"Please enter your current password to confirm changes"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"confirmPassword",type:"password",autoFocus:!0,component:T.s},{label:"Current Password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid||!this.props.confirmPassword},"Save")))))}}]),t}(u.Component),Object(C.a)(Va.prototype,"onConfirm",[j.a],Object.getOwnPropertyDescriptor(Va.prototype,"onConfirm"),Va.prototype),Va),Za=Object(S.a)({form:"confirmChanges",validate:T.D})(Ja),qa=Object(D.a)("confirmChanges"),Xa=Object(w.c)((function(e){return{confirmPassword:qa(e,"confirmPassword")}}))(Za),$a=(Aa=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={isDeleting:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){!this.props.visible&&e.visible&&this.props.dispatch(Object(E.b)("deleteAccountForm"))}},{key:"onClose",value:function(){this.props.onToggle(!1)}},{key:"onDelete",value:function(){var e=this;this.props.securityCode&&(this.setState({isDeleting:!0}),this.props.onConfirm(this.props.securityCode).catch((function(){return e.setState({isDeleting:!1})})))}},{key:"render",value:function(){return u.createElement("div",{className:"delete-account-modal form-styles"},u.createElement(R.a,{title:"Delete Account",onToggle:this.props.onToggle,visible:this.props.visible},u.createElement("form",{name:"deleteAccountForm",onSubmit:function(e){return e.preventDefault()}},u.createElement("p",{className:"text"},"Please check your email to find the security code"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"securityCode",type:"password",maxLength:T.l.securityCode.max,autoFocus:!0,component:T.s},{label:"Security code"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{type:"button",className:"short-btn",onClick:this.onClose,disabled:this.state.isDeleting},"No, keep it"),u.createElement(T.a,{className:"short-btn empty",onClick:this.onDelete,disabled:!this.props.valid,loading:this.state.isDeleting},"Delete")))))}}]),t}(u.PureComponent),Object(C.a)(Aa.prototype,"onClose",[j.a],Object.getOwnPropertyDescriptor(Aa.prototype,"onClose"),Aa.prototype),Object(C.a)(Aa.prototype,"onDelete",[j.a],Object.getOwnPropertyDescriptor(Aa.prototype,"onDelete"),Aa.prototype),Aa),Qa=Object(S.a)({form:"deleteAccountForm",validate:T.J})($a),ei=Object(D.a)("deleteAccountForm"),ti=Object(w.c)((function(e){return{securityCode:ei(e,"securityCode")}}))(Qa),ni=(n(1973),Ia=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={isLoading:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.props.newPassword&&(this.setState({isLoading:!0}),this.props.onPassword(this.props.newPassword).then((function(){t.props.onToggle(!1),t.props.dispatch(Object(E.b)("setPassword"))})).finally((function(){return t.setState({isLoading:!1})})))}},{key:"render",value:function(){return u.createElement(R.a,{title:"Set Password",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("form",{name:"setPassword",className:"set-pass-modal",onSubmit:this.onSubmit},u.createElement("p",{className:"text"},"Please set a password to be able to confirm changes"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"newPassword",type:"password",autoFocus:!0,component:T.s},{label:"Password"})),u.createElement("p",{className:"description"},"Long passwords are safer. ",Ya.a[Object(Ya.b)(this.props.newPassword||"")])),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"repeatPassword",type:"password",component:T.s},{label:"Repeat password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid,loading:this.state.isLoading},"Save"))))}}]),t}(u.Component),Object(C.a)(Ia.prototype,"onSubmit",[j.a],Object.getOwnPropertyDescriptor(Ia.prototype,"onSubmit"),Ia.prototype),Ia),ri=Object(S.a)({form:"setPassword",validate:T.I})(ni),oi=Object(D.a)("setPassword"),ai=Object(w.c)((function(e){return{newPassword:oi(e,"newPassword"),repeatPassword:oi(e,"repeatPassword")}}))(ri),ii=n(1117).default,si=n(1161).default,ci=function(e){return Object.values(e).map((function(e){return u.createElement(Or.a,{value:e,key:e},e)}))},pi=(Ua=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._lastPassAutofilledPass=void 0,n._lastPasswordValue="",n._cardForm=void 0,n._cardSubmitResolve=void 0,n._cardSubmitReject=void 0,n._autofillTimeout=void 0,n._cardPromise=new Promise((function(e,t){n._cardSubmitResolve=e,n._cardSubmitReject=t})),n.state={loading:!1,isConfirmChangesVisible:!1,isSetPasswordVisible:!1,isDeleteAccountModalVisible:!1,ccValid:!0,ccPristine:!0,ccDelete:!1,ccUpdate:!1},n._updateCardBalance(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._handleLastPassAutofill()}},{key:"componentWillUnmount",value:function(){clearTimeout(this._autofillTimeout)}},{key:"cancel",value:function(){this.props.dispatch(Object(E.b)("settings")),this._cardForm.reset()}},{key:"save",value:function(){var e=this,t=Promise.resolve();!this.state.ccPristine&&this.card&&(t=new Promise((function(t){return e.setState({ccDelete:!0,ccUpdate:!0},t)}))),t.then((function(){e.props.newPassword||e.props.email!==e.props.user.email||e.state.ccDelete&&!e.state.ccUpdate?e.props.user.hasPassword||e.props.newPassword?e.toggleConfirmChangesModal(!0):e.toggleSetPasswordModal(!0):e.updateData()}))}},{key:"deleteCard",value:function(){this.state.ccDelete||(this.setState({ccDelete:!0}),this.props.user.hasPassword?this.toggleConfirmChangesModal(!0):this.toggleSetPasswordModal(!0))}},{key:"cardSubmit",value:function(e,t){var n=this,r=t?this.props.asyncActions.editCreditCard(this.props.user,this.card.id,e):this.props.asyncActions.addCreditCard(this.props.user,e);return this.props.dispatch(r).then((function(){n._cardForm.reset(),n._cardSubmitResolve()}),(function(){return n._cardSubmitReject()}))}},{key:"onDeleteUser",value:function(){var e=this;this.props.dispatch(this.props.asyncActions.deleteUserConfirmation()).then((function(){return e.toggleDeleteAccountModal(!0)}))}},{key:"stopLoader",value:function(){this.setState({loading:!1})}},{key:"updateData",value:function(e){var t=this;this.setState({loading:!0}),Promise.all([this.state.ccDelete?Promise.resolve():this._updateSettings(this.props.newPassword,e),this._updateCard(e)]).then((function(){var e=new P.I({type:P.J.General,text:"Successfully updated"});t.props.dispatch(new v.i(e)),t.props.change("newPassword",""),t.setState({ccDelete:!1,ccUpdate:!1,ccPristine:!0,ccValid:!0})})).finally(this.stopLoader)}},{key:"deleteUser",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.deleteUser(e)).then((function(){t.props.dispatch(new v.i(new P.I({type:P.J.General,title:"Account Deleted",text:"Your account was successfully deleted and all personally identifiable information removed"})))}))}},{key:"toggleConfirmChangesModal",value:function(e){var t=this;this.setState({isConfirmChangesVisible:e},(function(){e||t.setState({ccDelete:!1})}))}},{key:"toggleDeleteAccountModal",value:function(e){this.setState({isDeleteAccountModalVisible:e})}},{key:"toggleSetPasswordModal",value:function(e){this.setState({isSetPasswordVisible:e})}},{key:"onCardUpdate",value:function(e){var t=e.valid,n=e.pristine,r=n,o=!!n||t;this.setState({ccValid:o,ccPristine:r,ccDelete:!1})}},{key:"onPassChange",value:function(e){this._stopLastPassManipulations(e)}},{key:"onPasswordSet",value:function(e){var t=this,n=this._updateSettings(e,e);return this.state.ccDelete&&n.then((function(){return t.updateData(e)})),n}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"settings-form form-styles"},u.createElement("fieldset",{className:"no-border"},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"name",component:T.s,type:"text"},{label:"Name"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"email",component:T.f,disabled:this.props.user.origin!==P.db.Rhyme},{label:"Email"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"newPassword",autoComplete:"new-password",component:T.s,type:"password",onChange:this.onPassChange},{label:"Password",ignoreLastPass:!0})),u.createElement("p",{className:"field-info"},"Long passwords are safer. ",this.renderPassStrength()))),u.createElement("fieldset",null,u.createElement("legend",null,"Credit Card"),u.createElement(Ga.b,{card:this.card,dispatch:this.props.dispatch,hideSaveButton:!0,onRef:function(t){return e._cardForm=t},onCardSave:this.cardSubmit,onStripeError:this.stopLoader,onUpdate:this.onCardUpdate}),this.card&&u.createElement("a",{href:"javascript:void(0);",className:"delete-card",onClick:this.deleteCard},"Delete Card")),u.createElement("fieldset",null,u.createElement("legend",null,"SMS"),u.createElement("div",{className:"row"},u.createElement(_.a,{name:"cellNumber",component:T.p})),u.createElement("div",{className:"row"},u.createElement(_.a,{disabled:!this.props.cellNumber,name:"missedChat",label:"Message notifications preference",component:T.u},ci(P.H)),u.createElement("p",{className:"field-info"},"We will forward missed chat messages to the host by SMS")),u.createElement("div",{className:"row"},u.createElement(_.a,{disabled:!this.props.cellNumber,name:"sessionReminder",label:"Session reminders preference",component:T.u},ci(P.T)),u.createElement("p",{className:"field-info"},"We will remind the host of a session by SMS"))),u.createElement("fieldset",{className:"no-border"},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"bio",type:"text",component:T.v},{label:"About You"})))),u.createElement("fieldset",null,u.createElement("legend",null,"Your Social Media Profiles"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"twitterUrl",component:T.s,type:"text"},{label:"Twitter"})),u.createElement("p",{className:"field-info"},"Promote your social media profiles in the landing pages of your recordings and in your profile")),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"githubUrl",component:T.s,type:"text"},{label:"GitHub"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"linkedinUrl",component:T.s,type:"text"},{label:"LinkedIn"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"facebookUrl",component:T.s,type:"text"},{label:"Facebook"})))),u.createElement("div",{className:"row"},u.createElement("div",{className:"action-btns"},u.createElement(T.a,{className:"empty",disabled:this.pristine,onClick:this.cancel},"Cancel"),u.createElement(T.a,{disabled:!this.valid,loading:this.state.loading,onClick:this.save},"Save")),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.onDeleteUser},"Delete Account"))),this.renderModals())}},{key:"renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(Xa,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.isConfirmChangesVisible,onToggle:this.toggleConfirmChangesModal,onConfirm:this.updateData}),u.createElement(ai,{dispathc:this.props.dispatch,visible:this.state.isSetPasswordVisible,onToggle:this.toggleSetPasswordModal,onPassword:this.onPasswordSet}),u.createElement(ti,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.isDeleteAccountModalVisible,onToggle:this.toggleDeleteAccountModal,onConfirm:this.deleteUser}))}},{key:"renderPassStrength",value:function(){if(this.props.newPassword){var e=Object(Ya.b)(this.props.newPassword);return Ya.a[e]}return""}},{key:"_updateSettings",value:function(e,t){var n=this,r=Promise.resolve();if(!this.props.pristine||!this.props.user.hasPassword){var o=si((function(e,t,n){return n.set(e,t)})),a=si((function(e,t,n){return t?n.set(e,t):n})),i=this.props.cellNumber?Object(Ka.a)(Object(Ka.b)(this.props.cellNumber||""),"E.164"):"",s=this._formatSocialLink(this.props.twitterUrl,T.A),c=this._formatSocialLink(this.props.githubUrl,T.j),p=this._formatSocialLink(this.props.linkedinUrl,T.m),l=this._formatSocialLink(this.props.facebookUrl,T.g),u=ii(a("name",this.props.name),a("email",this.props.email),a("password",t),a("newPassword",e),o("mobileNumber",i),o("bio",this.props.bio),o("twitterUrl",s),o("githubUrl",c),o("linkedinUrl",p),o("facebookUrl",l),(function(e){return e.set("settings",e.settings.set("missedChatNotifications",n.props.missedChat).set("sessionReminder",n.props.sessionReminder))})),d=this.props,h=d.asyncActions,m=d.dispatch,f=this.props.user.withMutations(u);r=m(h.updateUser(f))}return r}},{key:"_formatSocialLink",value:function(e,t){return e?e.trim().replace(t,(function(e,t,n){return n})):""}},{key:"_updateCard",value:function(e){var t=this,n=Promise.resolve();if(this.state.ccDelete&&!this.state.ccUpdate){var r=this.props.user.set("password",e||"");return this.props.dispatch(this.props.asyncActions.deleteCreditCard(r,this.card)).then((function(){t.state.ccUpdate||t._cardForm.clear()}),(function(e){throw t._cardForm.reset(),e}))}return this.state.ccPristine||(n=this._cardPromise,this._cardForm.submit(this.state.ccDelete&&this.state.ccUpdate)),n}},{key:"_updateCardBalance",value:function(){if(this.card&&this.card.brand===P.m.Rhyme){var e=this.props,t=e.asyncActions,n=e.dispatch,r=e.user;n(t.loadCreditCards(r))}}},{key:"_handleLastPassAutofill",value:function(){var e=this;this._autofillTimeout=setTimeout((function(){e.props.newPassword&&(e._lastPassAutofilledPass=e.props.newPassword,e.props.change("newPassword",""))}),1e3)}},{key:"_stopLastPassManipulations",value:function(e){var t=this,n=e.target.value;this._lastPassAutofilledPass&&this._lastPassAutofilledPass===n&&n.substr(0,n.length-1)!==this._lastPasswordValue?setTimeout((function(){return t.props.change("newPassword",t._lastPasswordValue)})):this._lastPasswordValue=n}},{key:"valid",get:function(){var e=!!this.props.valid&&!this.props.pristine,t=this.state.ccValid&&!this.state.ccPristine||this.state.ccDelete;return e||t}},{key:"pristine",get:function(){return!!this.props.pristine&&this.state.ccPristine}},{key:"card",get:function(){return this.props.user.creditCards.find((function(e){return e.primary}))}}]),t}(u.Component),Object(C.a)(Ua.prototype,"cancel",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"cancel"),Ua.prototype),Object(C.a)(Ua.prototype,"save",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"save"),Ua.prototype),Object(C.a)(Ua.prototype,"deleteCard",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"deleteCard"),Ua.prototype),Object(C.a)(Ua.prototype,"cardSubmit",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"cardSubmit"),Ua.prototype),Object(C.a)(Ua.prototype,"onDeleteUser",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onDeleteUser"),Ua.prototype),Object(C.a)(Ua.prototype,"stopLoader",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"stopLoader"),Ua.prototype),Object(C.a)(Ua.prototype,"updateData",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"updateData"),Ua.prototype),Object(C.a)(Ua.prototype,"deleteUser",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"deleteUser"),Ua.prototype),Object(C.a)(Ua.prototype,"toggleConfirmChangesModal",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleConfirmChangesModal"),Ua.prototype),Object(C.a)(Ua.prototype,"toggleDeleteAccountModal",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleDeleteAccountModal"),Ua.prototype),Object(C.a)(Ua.prototype,"toggleSetPasswordModal",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleSetPasswordModal"),Ua.prototype),Object(C.a)(Ua.prototype,"onCardUpdate",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onCardUpdate"),Ua.prototype),Object(C.a)(Ua.prototype,"onPassChange",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onPassChange"),Ua.prototype),Object(C.a)(Ua.prototype,"onPasswordSet",[j.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onPasswordSet"),Ua.prototype),Ua),li=Object(S.a)({form:"settings",validate:T.M,enableReinitialize:!0})(pi),ui=Object(D.a)("settings"),di=Object(w.c)((function(e,t){var n=t.user;return{name:ui(e,"name"),email:ui(e,"email"),cellNumber:ui(e,"cellNumber"),newPassword:ui(e,"newPassword"),bio:ui(e,"bio"),twitterUrl:ui(e,"twitterUrl"),githubUrl:ui(e,"githubUrl"),linkedinUrl:ui(e,"linkedinUrl"),facebookUrl:ui(e,"facebookUrl"),missedChat:ui(e,"missedChat"),sessionReminder:ui(e,"sessionReminder"),initialValues:{sessionReminder:n.settings.sessionReminder,missedChat:n.settings.missedChatNotifications,name:n.name,email:n.email,cellNumber:n.mobileNumber,bio:n.bio,twitterUrl:n.twitterUrl,githubUrl:n.githubUrl,linkedinUrl:n.linkedinUrl,facebookUrl:n.facebookUrl}}}))(li),hi=(n(1974),n(1975),n(1216)),mi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.user;return u.createElement("div",{className:"default-avatar-picker"},hi.a.map((function(n,r){return u.createElement("div",{className:"d-avatar"+(t.avatarUrl||t.photo!==r+1?"":" selected"),key:"da-"+r,onClick:function(){return e.props.onAvatarPick(r+1)}},u.createElement("img",{src:n,width:80,height:80}))})))}}]),t}(u.Component),fi=(La=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={image:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onImageLoad",value:function(e){this.setState({image:e})}},{key:"onImageSave",value:function(e){var t=this,n=this.props.asyncActions.uploadAvatar(this.props.user,e);return this.props.dispatch(n).then((function(){t.props.dispatch(new v.i(new P.I({type:P.J.General,text:"Photo successfully updated"}))),t.props.onToggle(!1),t.setState({image:null})}))}},{key:"cancel",value:function(){this.setState({image:null})}},{key:"onDefaultAvatar",value:function(e){var t=this.props.user.set("photo",e).set("avatarUrl","");this.props.dispatch(this.props.asyncActions.updateUser(t)),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"avatar-picker"},u.createElement(R.a,{title:this.state.image?"Adjust Photo":"Your Photo",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"picker"},u.createElement(hr,{dispatch:this.props.dispatch,image:this.state.image,downscaleImage:!0,downscaleSize:{width:200,height:200},faceRecognition:!0,message:"Upload your photo",onImageLoad:this.onImageLoad,onImageSave:this.onImageSave,onCancel:this.cancel}),this.state.image?null:u.createElement(u.Fragment,null,u.createElement("div",{className:"sep-line","data-text":"Or"}),u.createElement("h3",null,"Choose a standard photo"),u.createElement(mi,{user:this.props.user,onAvatarPick:this.onDefaultAvatar})))))}}]),t}(u.Component),Object(C.a)(La.prototype,"onImageLoad",[j.a],Object.getOwnPropertyDescriptor(La.prototype,"onImageLoad"),La.prototype),Object(C.a)(La.prototype,"onImageSave",[j.a],Object.getOwnPropertyDescriptor(La.prototype,"onImageSave"),La.prototype),Object(C.a)(La.prototype,"cancel",[j.a],Object.getOwnPropertyDescriptor(La.prototype,"cancel"),La.prototype),Object(C.a)(La.prototype,"onDefaultAvatar",[j.a],Object.getOwnPropertyDescriptor(La.prototype,"onDefaultAvatar"),La.prototype),La),yi=n(1062),vi=(Fa=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={avatarPickerVisible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"changeAvatar",value:function(){this.updateAvatarPickerVisibility(!0)}},{key:"updateAvatarPickerVisibility",value:function(e){this.setState({avatarPickerVisible:e})}},{key:"render",value:function(){return u.createElement("div",{className:"update-avatar"},u.createElement(yi.a,{source:this.props.user,width:150,height:150,fontSize:62}),u.createElement("div",{className:"update",onClick:this.changeAvatar},"Change"),u.createElement(fi,{user:this.props.user,asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,visible:this.state.avatarPickerVisible,onToggle:this.updateAvatarPickerVisibility}))}}]),t}(u.Component),Object(C.a)(Fa.prototype,"changeAvatar",[j.a],Object.getOwnPropertyDescriptor(Fa.prototype,"changeAvatar"),Fa.prototype),Object(C.a)(Fa.prototype,"updateAvatarPickerVisibility",[j.a],Object.getOwnPropertyDescriptor(Fa.prototype,"updateAvatarPickerVisibility"),Fa.prototype),Fa),bi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"settings"},u.createElement(vi,{user:this.props.user,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions}),u.createElement(di,{user:this.props.user,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions}))}}]),t}(u.Component),gi=(n(1976),n(1038)),Oi=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._root=void 0,n._tabLine=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._root=document.getElementById("root"),this._root&&(this._tabLine=document.createElement("div"),this._tabLine.className="tab-line",this._root.appendChild(this._tabLine))}},{key:"componentWillUnmount",value:function(){this._root&&this._root.removeChild(this._tabLine)}},{key:"render",value:function(){var e=this;return u.createElement("nav",{className:"route-tabs"},Object.keys(this.props.tabs).map((function(t,n){return u.createElement(gi.a,{onMouseOver:e._onMouseOver.bind(e,t),className:"tab"+(e.props.location.pathname.startsWith(t)?" selected":""),to:t,key:"tab-nab-"+n},e.props.tabs[t])})))}},{key:"_onMouseOver",value:function(e){this.props.onMouseOver&&this.props.onMouseOver(e)}}]),t}(u.Component),Ci=(n(1977),n(1978),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n="asc"===t?-1:1;return function(t,r){var o=e(t),a=e(r);return(Number(o<a)-.5)*n}}),ki=(n(1979),za=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._vmNameRef=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._ellipsizeText()}},{key:"componentDidUpdate",value:function(e){this.props.template.name!==e.template.name&&this._ellipsizeText()}},{key:"select",value:function(){this.props.disabled||this.props.onSelect(this.props.template)}},{key:"softwareDetails",value:function(e){this.props.disabled||(this.props.onSoftwareDetails(this.props.template),e.stopPropagation())}},{key:"render",value:function(){var e=this,t=this.props.template,n="vm-template"+(this.props.disabled?" disabled":"");return u.createElement(gr.a,{className:n,onClick:this.select},u.createElement("div",{className:"image"},u.createElement("img",{src:t.screenshotUrl,width:"160",height:"128",alt:""})),u.createElement("p",{ref:function(t){return e._vmNameRef=t}},t.name),!this.props.hideDetailsBubble&&u.createElement("div",{className:"info"},u.createElement("div",{className:"mouse-over-filler"}),u.createElement("p",{className:"template-name"},t.name),u.createElement("p",{className:"detailed"},u.createElement("span",null,"Size: ",Object(g.k)(t.templateSize,"???")),u.createElement("br",null),u.createElement("a",{href:"javascript:void(0);",onClick:this.softwareDetails},"More Details"))))}},{key:"_ellipsizeText",value:function(){if(this._vmNameRef)for(var e=this._vmNameRef.innerHTML.split(" ");this._vmNameRef.scrollHeight>this._vmNameRef.offsetHeight;)e.pop(),this._vmNameRef.innerHTML=e.join(" ")+"..."}}]),t}(u.Component),Object(C.a)(za.prototype,"select",[j.a],Object.getOwnPropertyDescriptor(za.prototype,"select"),za.prototype),Object(C.a)(za.prototype,"softwareDetails",[j.a],Object.getOwnPropertyDescriptor(za.prototype,"softwareDetails"),za.prototype),za);!function(e){e.MostRecent="Sort by creation date (ascending)",e.LeastRecent="Sort by creation date (descending)",e.Name="Sort by name (a-z)"}(Wa||(Wa={}));var ji,wi,Ei,_i,Si,Di,Pi,Ti,Ri=(Ba=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={detailsFor:null,sortBy:Wa.Name,filter:""},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.props.loadingInitialData?u.createElement(Hr,null):u.createElement("div",{className:"vm-list"},u.createElement(Br,{filterPlaceholder:"Search cloud desktops",filter:this.state.filter,onFilterChange:this._onFilterChange,sortBy:this.state.sortBy,sortOptions:Wa,onSortTypeChange:this._onSortChange}),u.createElement(Wr.a,null,u.createElement(gr.a,{className:"new-template",onClick:this.props.onNewTemplate},u.createElement("div",{className:"create-icon"}),u.createElement("p",null,"Create New",u.createElement("br",null),"Cloud Desktop")),this._sortedVisibleTemplates.map((function(t){return u.createElement(ki,{key:t.id,disabled:t.state!==P.ab.Ready,template:t,hideDetailsBubble:e.props.hideDetailsBubble,onSelect:function(){return e.props.onTemplateSelect(t)},onSoftwareDetails:function(){return e._onTemplateDetails(t)}})}))),u.createElement(jn,{visible:!!this.state.detailsFor,template:this.state.detailsFor||new P.Y({}),onToggle:this._onSoftwareDetailsToggle}))}},{key:"_onTemplateDetails",value:function(e){this.setState({detailsFor:e})}},{key:"_onSoftwareDetailsToggle",value:function(e){e||this.setState({detailsFor:null})}},{key:"_onFilterChange",value:function(e){this.setState({filter:e})}},{key:"_onSortChange",value:function(e){this.setState({sortBy:e})}},{key:"_sortedVisibleTemplates",get:function(){var e=this.state.filter.toLowerCase();return this.props.templates.filter((function(t){return Object(g.i)(t)&&function(t){return t.name.toLowerCase().includes(e)}(t)})).sort(this._templateSort).toList()}},{key:"_templateSort",get:function(){switch(this.state.sortBy){case Wa.MostRecent:return Ci((function(e){return e.createdAt}),"desc");case Wa.LeastRecent:return Ci((function(e){return e.createdAt}));case Wa.Name:default:return Ci((function(e){return e.name}))}}}]),t}(u.PureComponent),Object(C.a)(Ba.prototype,"_onSoftwareDetailsToggle",[j.a],Object.getOwnPropertyDescriptor(Ba.prototype,"_onSoftwareDetailsToggle"),Ba.prototype),Object(C.a)(Ba.prototype,"_onFilterChange",[j.a],Object.getOwnPropertyDescriptor(Ba.prototype,"_onFilterChange"),Ba.prototype),Object(C.a)(Ba.prototype,"_onSortChange",[j.a],Object.getOwnPropertyDescriptor(Ba.prototype,"_onSortChange"),Ba.prototype),Ba),xi=(n(1980),n(1342)),Mi=(ji=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"terminateAndLeave",value:function(){var e=this.props,t=e.asyncActions,n=e.dispatch,r=e.vm;return r&&this.isVmReady?n(t.terminateVM(r)).then(this.props.onResolve):(this.props.onResolve(),Promise.resolve())}},{key:"render",value:function(){return u.createElement(Fe.a,{text:this.isVmReady?"If you leave now, your cloud desktop will be terminated.":"",visible:this.props.visible,onToggle:this.props.onToggle,onResolve:this.terminateAndLeave})}},{key:"isVmReady",get:function(){return!!this.props.vm&&this.props.vm.state===P.jb.Ready}}]),t}(u.Component),Object(C.a)(ji.prototype,"terminateAndLeave",[j.a],Object.getOwnPropertyDescriptor(ji.prototype,"terminateAndLeave"),ji.prototype),ji),Ni=(n(1981),wi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._stopwatch=void 0,n._gtmVmLaunchTime=null,n.state={uploadInProgress:!1,screenshot:"",templateName:"",templateNameValid:!1,connected:!1,isTerminateVmModalVisible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onUploadStart",value:function(){this.setState({uploadInProgress:!0})}},{key:"onUploadEnd",value:function(){this.setState({uploadInProgress:!1})}},{key:"onScreenshotUpdate",value:function(e){this.setState({screenshot:e})}},{key:"onTemplateNameUpdate",value:function(e,t){this.setState({templateName:e,templateNameValid:t})}},{key:"onComplete",value:function(){return this.state.screenshot?this.props.onDataCompleted(this.props.vm,new P.Y({name:this.state.templateName}),this.state.screenshot):Promise.reject("Missing screenshot")}},{key:"onToggleTerminateVmModal",value:function(e){this.setState({isTerminateVmModalVisible:e})}},{key:"onExit",value:function(){this.props.vm.id?this.onToggleTerminateVmModal(!0):this.exit()}},{key:"exit",value:function(){this.props.onExit&&this.props.onExit(),this.props.dispatch(Object(h.c)(this.props.totalPagesBackwards||-1))}},{key:"onVmInit",value:function(){this._gtmVmLaunchTime=Ue.a.customizeVmLaunchTime(this.props.vm.id)}},{key:"onVmConnect",value:function(){this._stopwatch&&this._stopwatch.start(),this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this._stopwatch&&this._stopwatch.pause(),this.setState({connected:!1})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"customize-vm"},u.createElement(Gt.a,{vm:this.props.vm,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,controls:!0,asyncActions:this.props.asyncActions,template:this.template},u.createElement("div",{className:"customize-template-wizard"},u.createElement("div",{className:"logo-container"},u.createElement("div",{className:"logo"}),u.createElement(Jt,{onRef:function(t){return e._stopwatch=t}})),u.createElement("h3",null,"Customize Cloud Desktop"),u.createElement(qt,{className:"customize-vm-wizard",onComplete:this.onComplete,onExit:this.onExit},u.createElement(Xt,{title:"Install Software",disableNext:!this.state.connected},u.createElement(dn,null)),u.createElement(Xt,{title:"Upload Files",disableNext:!this.state.connected||this.state.uploadInProgress,disablePrev:this.state.uploadInProgress},u.createElement(tn,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,disabled:!this.state.connected,onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd})),u.createElement(Xt,{title:"Apply Licenses",disableNext:!this.state.connected},u.createElement(ln,null)),u.createElement(Xt,{title:"Configure"},u.createElement(cn,null)),u.createElement(Xt,{title:"Screenshot & Name",disableNext:!this.isCompleted||!this.state.connected},u.createElement(an,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onScreenshotUpdate:this.onScreenshotUpdate,onTemplateNameUpdate:this.onTemplateNameUpdate}))))),this.props.vm.id?u.createElement(Mi,{vm:this.props.vm,visible:this.state.isTerminateVmModalVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.onToggleTerminateVmModal,onResolve:this.exit}):null)}},{key:"template",get:function(){return this.props.templates.get(this.props.vm.templateId)}},{key:"isCompleted",get:function(){return!!this.state.screenshot&&this.state.templateNameValid&&!this.state.uploadInProgress}}]),t}(u.Component),Object(C.a)(wi.prototype,"onUploadStart",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onUploadStart"),wi.prototype),Object(C.a)(wi.prototype,"onUploadEnd",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onUploadEnd"),wi.prototype),Object(C.a)(wi.prototype,"onScreenshotUpdate",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onScreenshotUpdate"),wi.prototype),Object(C.a)(wi.prototype,"onTemplateNameUpdate",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onTemplateNameUpdate"),wi.prototype),Object(C.a)(wi.prototype,"onComplete",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onComplete"),wi.prototype),Object(C.a)(wi.prototype,"onToggleTerminateVmModal",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onToggleTerminateVmModal"),wi.prototype),Object(C.a)(wi.prototype,"onExit",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onExit"),wi.prototype),Object(C.a)(wi.prototype,"exit",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"exit"),wi.prototype),Object(C.a)(wi.prototype,"onVmInit",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onVmInit"),wi.prototype),Object(C.a)(wi.prototype,"onVmConnect",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onVmConnect"),wi.prototype),Object(C.a)(wi.prototype,"onVmDisconnect",[j.a],Object.getOwnPropertyDescriptor(wi.prototype,"onVmDisconnect"),wi.prototype),wi),Vi=(n(1982),n(1983),Ei={},Object($.a)(Ei,g.c.DefaultWin,"Use our default Windows cloud desktop which has most of the popular software already installed."),Object($.a)(Ei,g.c.CustomWin,"Install your software, save your data, and configure a Windows cloud desktop just the way you like it."),Object($.a)(Ei,g.c.DefaultUbuntu,"Use our default linux (Ubuntu) cloud desktop which has most of the popular software already installed."),Object($.a)(Ei,g.c.CustomUbuntu,"Install your software, save your data, and configure a linux (Ubuntu) cloud desktop just the way you like it."),Ei),Ai=(_i=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"chooseVm",value:function(){this.props.onSelect(this.props.type)}},{key:"softwareDetails",value:function(){this.props.onSoftwareDetailsRequest(this.props.type)}},{key:"mouseOver",value:function(){this.props.onMouseChange(this.props.type)}},{key:"mouseOut",value:function(){this.props.onMouseChange(null)}},{key:"render",value:function(){var e=this.props.template,t=Object(x.b)(Math.round(e.price/4),!0).split(".");return u.createElement("div",{className:"vm-selector-vm"+(this.props.hovered?" hovered":"")},u.createElement(gr.a,{className:"vm"+(this.props.recommended?" recommended":""),onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.chooseVm,border:this.props.hovered},this.props.recommended&&u.createElement("p",{className:"recommended-label"},"Recommended"),u.createElement("p",{className:"name"},e.name),u.createElement("div",{className:"icon ".concat(e.icon)}),u.createElement("p",{className:"price"},x.a[e.currency],u.createElement("span",{className:"dollars"},t[0]),t[1]&&u.createElement("span",{className:"cents"},".",t[1])),u.createElement("div",{className:"arrow"})),u.createElement("div",{className:"software",onMouseOver:this.mouseOver,onMouseOut:this.mouseOut},u.createElement("p",{className:"title"},Vi[this.props.type]),u.createElement("p",null,"This cloud desktop already has:"),u.createElement("div",{className:"apps"},u.createElement("div",{className:"software-icons "+(e.os===P.K.Win?"windows":"ubuntu")}),u.createElement("a",{href:"javascript:void(0);",onClick:this.softwareDetails},"+ More"))))}}]),t}(u.Component),Object(C.a)(_i.prototype,"chooseVm",[j.a],Object.getOwnPropertyDescriptor(_i.prototype,"chooseVm"),_i.prototype),Object(C.a)(_i.prototype,"softwareDetails",[j.a],Object.getOwnPropertyDescriptor(_i.prototype,"softwareDetails"),_i.prototype),Object(C.a)(_i.prototype,"mouseOver",[j.a],Object.getOwnPropertyDescriptor(_i.prototype,"mouseOver"),_i.prototype),Object(C.a)(_i.prototype,"mouseOut",[j.a],Object.getOwnPropertyDescriptor(_i.prototype,"mouseOut"),_i.prototype),_i),Ii=(Si=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={size:new P.Y({}).templateSize,hovered:null,softwareDetailsFor:null,softwareDetailsVisible:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"onSelect",value:function(e){var t=!!this.props.user.creditCards.size;if(t)switch(e){case g.c.CustomWin:case g.c.CustomUbuntu:this.props.onVmSelect(e,this.state.size,!1,t);break;case g.c.DefaultWin:case g.c.DefaultUbuntu:this.props.onVmSelect(e,this.state.size,!0,t)}else this.props.onVmSelect(e,this.state.size,!1,t)}},{key:"onTemplateSize",value:function(e){this.setState({size:e})}},{key:"onMouseChange",value:function(e){this.setState({hovered:e})}},{key:"onSoftwareDetailsRequest",value:function(e){this.setState({softwareDetailsFor:e}),this.updateSoftwareDetailsVisibility(!0)}},{key:"updateSoftwareDetailsVisibility",value:function(e){this.setState({softwareDetailsVisible:e})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"vm-selector form-styles"},u.createElement("h2",null,!this.props.hideBackButton&&u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Choose Cloud Desktop"),u.createElement("div",{className:"text main-title"},"Choose the type of cloud desktops you want your learners to use.",!1),u.createElement("div",{className:"list"},Object.keys(this.templates).filter((function(t){return!e.props.customOnly||!e.templates[t].default})).map((function(t,n){return u.createElement(Ai,{key:"vm-"+n,hovered:t===e.state.hovered,type:t,template:e.templates[t],onSelect:e.onSelect,recommended:(g.c.DefaultWin===t||g.c.DefaultUbuntu===t)&&e.props.recommendDefault,onMouseChange:e.onMouseChange,onSoftwareDetailsRequest:e.onSoftwareDetailsRequest})}))),this.state.softwareDetailsFor&&u.createElement(jn,{template:new P.Y({os:this.templates[this.state.softwareDetailsFor].os,name:this.templates[this.state.softwareDetailsFor].name}),visible:this.state.softwareDetailsVisible,onToggle:this.updateSoftwareDetailsVisibility}),u.createElement("div",{className:"labels-padding"}),this.props.recommendDefault&&u.createElement("p",{className:"text recommend"},"Note: We recommend you create your first session with Default Windows or Ubuntu"),u.createElement("p",{className:"text price-label"},"Prices shown for 15 mins usage"))}},{key:"_templateSelectValueFilter",value:function(e){return e.replace(/\s\(.+\)$/,"")}},{key:"templates",get:function(){return Object(g.j)(this.props.templates)}}]),t}(u.Component),Object(C.a)(Si.prototype,"back",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"back"),Si.prototype),Object(C.a)(Si.prototype,"onSelect",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"onSelect"),Si.prototype),Object(C.a)(Si.prototype,"onTemplateSize",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"onTemplateSize"),Si.prototype),Object(C.a)(Si.prototype,"onMouseChange",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"onMouseChange"),Si.prototype),Object(C.a)(Si.prototype,"onSoftwareDetailsRequest",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"onSoftwareDetailsRequest"),Si.prototype),Object(C.a)(Si.prototype,"updateSoftwareDetailsVisibility",[j.a],Object.getOwnPropertyDescriptor(Si.prototype,"updateSoftwareDetailsVisibility"),Si.prototype),Si),Ui=(Di=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).templateSelected=void 0,n._templateType=void 0,n._templateSize=void 0,n.state={vmId:"",totalPagesBackwards:0},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"createVmAndConnection",value:function(e,t,n){var r=this;this._templateType=e,this._templateSize=t,this._requestVm().then((function(){n?r.props.dispatch(Object(h.g)(Y.vb)):r.props.dispatch(Object(h.g)(Y.sb))}))}},{key:"saveAndExit",value:function(e,t,n){var r=this;t=t.set("templateSize",this._templateSize);var o=this.props.asyncActions.saveTemplate(e,t);return this.props.dispatch(o).then((function(e){var t=new Blob([Ie.a.toArrayBuffer(n)],{type:"image/png"});return r.props.dispatch(r.props.asyncActions.saveTemplateScreenshot(e,t))})).then(this.props.onExit)}},{key:"onExitCustomization",value:function(){this.setState({vmId:""})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"new-template"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.ub,exact:!0,render:function(){return u.createElement(Ii,{user:e.props.user,templates:e.props.templates,customOnly:!0,onVmSelect:e.createVmAndConnection,dispatch:e.props.dispatch})}}),u.createElement(y.b,{path:Y.sb,exact:!0,render:function(){return u.createElement(xi.a,{condition:!e.templateSelected,redirectPath:Y.vb,dispatch:e.props.dispatch},u.createElement(Ni,{vms:e.props.vms,vm:e.vm,remoteClientManager:e.props.remoteClientManager,onDataCompleted:e.saveAndExit,onExit:e.onExitCustomization,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,cost:e.props.cost}))}}),u.createElement(y.a,{to:Y.H})))}},{key:"_requestVm",value:function(){var e,t=this;switch(this.templateSelected=!0,this._templateType){case g.c.CustomWin:default:e=this.props.templates.find((function(e){return e.defaultTemplate&&e.os===P.K.Win}));break;case g.c.CustomUbuntu:e=this.props.templates.find((function(e){return e.defaultTemplate&&e.os===P.K.Linux}))}var n=this.props.asyncActions.getVMAndConnection(e,!0),r=this.props.dispatch(n);return r.then((function(e){return t.setState({vmId:e.id})})),r}},{key:"vm",get:function(){return this.props.vms.get(this.state.vmId)||new P.kb({})}}]),t}(u.Component),Object(C.a)(Di.prototype,"createVmAndConnection",[j.a],Object.getOwnPropertyDescriptor(Di.prototype,"createVmAndConnection"),Di.prototype),Object(C.a)(Di.prototype,"saveAndExit",[j.a],Object.getOwnPropertyDescriptor(Di.prototype,"saveAndExit"),Di.prototype),Object(C.a)(Di.prototype,"onExitCustomization",[j.a],Object.getOwnPropertyDescriptor(Di.prototype,"onExitCustomization"),Di.prototype),Di);!function(e){e[e.None=0]="None",e[e.New=1]="New",e[e.Update=2]="Update",e[e.Screenshot=3]="Screenshot"}(Ti||(Ti={}));var Li,Fi,zi,Bi,Wi,Hi,Ki,Yi,Gi,Ji,Zi,qi,Xi,$i,Qi,es,ts,ns,rs,os=(Pi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).vmRequested=void 0,n.state={selectedTemplate:null,vmId:"",templateCustomizationVisible:!1},n._redirectIfNoData(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"showDetailsFor",value:function(e){this.setState({selectedTemplate:e.id}),this.toggleDetailsModal(!0)}},{key:"toggleDetailsModal",value:function(e){this.setState({templateCustomizationVisible:e}),e||this.setState({selectedTemplate:null})}},{key:"endOfTemplateCustomization",value:function(){this.customizeTemplate(Ti.None),this.toggleDetailsModal(!0)}},{key:"customizeTemplate",value:function(e){return this.props.user.creditCards.size?this._customizeTemplate(e):(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then(this._customizeTemplate.bind(this,e)))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"templates"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.vb,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Ri,{templates:e.customTemplates,onNewTemplate:function(){return e.customizeTemplate(Ti.New)},onTemplateSelect:e.showDetailsFor,hideDetailsBubble:!0,loadingInitialData:e.props.loadingInitialData}),e.state.selectedTemplate?u.createElement(Xn,{dispatch:e.props.dispatch,template:e.template||new P.Y({}),templates:e.props.templates,asyncActions:e.props.asyncActions,courses:e.props.courses,rooms:e.props.rooms,visible:e.state.templateCustomizationVisible,transparent:e.props.cardModalVisible,onToggle:e.toggleDetailsModal,onCustomize:function(){return e.customizeTemplate(Ti.Update)},onScreenshotUpdate:function(){return e.customizeTemplate(Ti.Screenshot)}}):null)}}),u.createElement(y.b,{path:Y.tb,render:function(){return u.createElement(Ui,{vms:e.props.vms,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,user:e.props.user,templates:e.props.templates,cost:e.props.cost,onExit:function(){return e.customizeTemplate(Ti.None)}})}}),u.createElement(y.b,{path:Y.xb,exact:!0,render:function(){return e.vm&&e.template?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.vm,template:e.template},u.createElement(hn,{dispatch:e.props.dispatch,vm:e.vm,template:e.template,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.wb,exact:!0,render:function(){return e.vm&&e.template?u.createElement(Zt,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.vm,template:e.template},u.createElement(fn,{dispatch:e.props.dispatch,vm:e.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.template,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromSelectedTemplate",value:function(){var e=this;this.vmRequested=!0;var t=this.template;return t?this.props.dispatch(this.props.asyncActions.getVMAndConnection(t,!0)).then((function(t){e.setState({vmId:t.id})})):Promise.reject("No selected template")}},{key:"_customizeTemplate",value:function(e){var t=this;switch(this.setState({vmId:""}),e){case Ti.None:return this.props.dispatch(Object(h.g)(Y.vb)),Promise.resolve();case Ti.New:return this.props.dispatch(Object(h.g)(Y.ub)),Promise.resolve();case Ti.Screenshot:return this._createVmFromSelectedTemplate().then((function(){return t.props.dispatch(Object(h.g)(Y.xb))}));case Ti.Update:return this._createVmFromSelectedTemplate().then((function(){return t.props.dispatch(Object(h.g)(Y.wb))}))}}},{key:"_redirectIfNoData",value:function(){var e=this.props.location;!Object(Y.Eb)(e,Y.xb)&&!Object(Y.Eb)(e,Y.wb)||this.vm&&this.template||this.props.dispatch(Object(h.h)(Y.vb))}},{key:"customTemplates",get:function(){return this.props.templates.filter((function(e){return!e.defaultTemplate}))}},{key:"template",get:function(){return this.props.templates.get(this.state.selectedTemplate||"")||null}},{key:"vm",get:function(){return this.props.vms.get(this.state.vmId)||null}}]),t}(u.Component),Object(C.a)(Pi.prototype,"showDetailsFor",[j.a],Object.getOwnPropertyDescriptor(Pi.prototype,"showDetailsFor"),Pi.prototype),Object(C.a)(Pi.prototype,"toggleDetailsModal",[j.a],Object.getOwnPropertyDescriptor(Pi.prototype,"toggleDetailsModal"),Pi.prototype),Object(C.a)(Pi.prototype,"endOfTemplateCustomization",[j.a],Object.getOwnPropertyDescriptor(Pi.prototype,"endOfTemplateCustomization"),Pi.prototype),Pi),as=(Li=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this)))._toggle=e,n._saveResolver=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"show",value:function(){this._toggle(!0)}},{key:"onSave",value:function(){var e=this;return new Promise((function(t,n){e._saveResolver=t}))}},{key:"saveCallback",value:function(){this._saveResolver&&this._saveResolver()}}]),t}((function e(){Object(i.a)(this,e)})),Object(C.a)(Li.prototype,"saveCallback",[j.a],Object.getOwnPropertyDescriptor(Li.prototype,"saveCallback"),Li.prototype),Li),is=(n(1984),Fi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onCardSave",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.addCreditCard(this.props.user,e)).then((function(){t.props.onCardSave&&t.props.onCardSave();var e=new P.I({type:P.J.General,text:"Card successfully added!"});t.props.dispatch(new v.i(e)),t.props.onToggle(!1)}))}},{key:"render",value:function(){return u.createElement("div",{className:"card-modal"},u.createElement(R.a,{title:"Payment Information",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",null,"We need your payment information in order to proceed with the selected action."),u.createElement(Ga.b,{dispatch:this.props.dispatch,onCardSave:this.onCardSave})))}},{key:"card",get:function(){return this.props.user.creditCards.find((function(e){return e.primary}))}}]),t}(u.Component),Object(C.a)(Fi.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor(Fi.prototype,"onCardSave"),Fi.prototype),Fi),ss=(zi={},Object($.a)(zi,Y.ob,"Sessions"),Object($.a)(zi,Y.Z,"Recordings"),Object($.a)(zi,Y.vb,"Cloud Desktops"),Object($.a)(zi,Y.pb,"Settings"),zi),cs=(Bi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).cardModalCtrl=void 0,n.state={cardModalVisible:!1},n.cardModalCtrl=new as(n.toggleCardModal.bind(Object(X.a)(n))),Object(O.c)(O.a.TryFlowSession),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"toggleCardModal",value:function(e){this.setState({cardModalVisible:e})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"dashboard"},u.createElement(Oi,{tabs:ss,location:this.props.location}),u.createElement(y.d,null,u.createElement(y.b,{path:Y.ob,render:function(){return u.createElement(Ha,{loadingInitialData:e.props.loadingInitialData,courses:e.props.courses,rooms:e.props.rooms,templates:e.props.templates,vms:e.props.vms,user:e.props.user,cost:e.props.cost,currentChapter:e.props.currentChapter,location:e.props.location,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible})}}),u.createElement(y.b,{path:Y.Z,render:function(){return u.createElement(Jr,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,courses:e.courses,currentChapter:e.props.currentChapter,templates:e.props.templates,rooms:e.props.rooms,vms:e.props.vms,user:e.props.user,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible,location:e.props.location})}}),u.createElement(y.b,{path:Y.vb,render:function(){return u.createElement(os,{loadingInitialData:e.props.loadingInitialData,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,templates:e.nonLegacyTemplates,courses:e.props.courses,rooms:e.props.rooms,cost:e.props.cost,user:e.props.user,vms:e.props.vms,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible,location:e.props.location})}}),u.createElement(y.b,{path:Y.pb,exact:!0,render:function(){return u.createElement(bi,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,user:e.props.user})}}),u.createElement(y.a,{to:Y.H})),u.createElement(is,{user:this.props.user,visible:this.state.cardModalVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.toggleCardModal,onCardSave:this.cardModalCtrl.saveCallback}))}},{key:"courses",get:function(){return this.props.courses.filter((function(e){return!e.deleted})).toMap()}},{key:"nonLegacyTemplates",get:function(){return this.props.templates.filter((function(e){return!Object(g.h)(e)})).toMap()}}]),t}(u.Component),Object(C.a)(Bi.prototype,"toggleCardModal",[j.a],Object.getOwnPropertyDescriptor(Bi.prototype,"toggleCardModal"),Bi.prototype),Bi),ps=n(1337),ls=(n(1985),n(1986),function(e){return u.createElement("div",{className:"bottom-container"},e.children)}),us=(Wi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._manuallyEnteredCard=void 0,n.state={cardType:Ga.a.CreditCard},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.user.creditCards.size&&!this.props.user.creditCards.size&&this.props.onCardLoaded&&!this._manuallyEnteredCard)switch(this.props.templateType){case g.c.CustomWin:case g.c.CustomUbuntu:return this.props.onCardLoaded(!1);case g.c.DefaultWin:case g.c.DefaultUbuntu:return this.props.onCardLoaded(!0)}}},{key:"onCardSave",value:function(e){switch(this._manuallyEnteredCard=!0,this.props.templateType){case g.c.CustomWin:case g.c.CustomUbuntu:return this.props.onCardSave(e,!1);case g.c.DefaultWin:case g.c.DefaultUbuntu:return this.props.onCardSave(e,!0);default:return Promise.reject("Unknown template type")}}},{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"updateCardType",value:function(e){this.setState({cardType:e})}},{key:"render",value:function(){return u.createElement("div",{className:"card-form form-styles"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),this.state.cardType===Ga.a.CreditCard?"Credit":"Rhyme Gift"," Card"),u.createElement("p",{className:"text"},"Please enter a Rhyme (or credit) card. You will NOT be charged till you use a cloud desktop."),u.createElement(Ga.b,{dispatch:this.props.dispatch,onCardSave:this.onCardSave,onCardTypeChange:this.updateCardType,key:"cc-form"}),u.createElement(ls,null,"How will I be charged?",u.createElement("br",null),"You will be charged ",this.price," every 15 mins for each cloud desktop you or your learners use",u.createElement("br",null),u.createElement("br",null),"Example:",u.createElement("br",null),"For a 27 mins session with 2 learners, you pay: ",this.price," x 2 x ( 2 learners + 1 host ) +"," ",this.processingFee," (credit card processing) = ",this.totalPrice))}},{key:"price",get:function(){var e=this._templatePrice;return x.a[e.currency]+Object(x.b)(e.price/4,!0)}},{key:"totalPrice",get:function(){var e=this._templatePrice,t=Math.round(.5*e.price*3+g.a);return x.a[e.currency]+Object(x.b)(t,!0)}},{key:"processingFee",get:function(){var e=this._templatePrice;return x.a[e.currency]+Object(x.b)(g.a,!0)}},{key:"_templatePrice",get:function(){return Object(g.e)(this.props.templates,this.props.templateType)}}]),t}(u.Component),Object(C.a)(Wi.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor(Wi.prototype,"onCardSave"),Wi.prototype),Object(C.a)(Wi.prototype,"back",[j.a],Object.getOwnPropertyDescriptor(Wi.prototype,"back"),Wi.prototype),Object(C.a)(Wi.prototype,"updateCardType",[j.a],Object.getOwnPropertyDescriptor(Wi.prototype,"updateCardType"),Wi.prototype),Wi),ds=(n(1987),Hi={},Object($.a)(Hi,P.K.Win,"Windows"),Object($.a)(Hi,P.K.Linux,"Ubuntu"),Hi),hs=(Ki=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={modalVisible:!1,isLoadingExistingCustomTemplate:!1,isUpdatingCustomTemplate:!1},n._selected=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"updateModalVisibility",value:function(e){this.setState({modalVisible:e})}},{key:"back",value:function(){this.props.dispatch(Object(h.c)(this.props.totalPagesBackwards||-1))}},{key:"createNew",value:function(){this.props.onCustomVmSelect()}},{key:"onSelect",value:function(e){this._selected=e,this.updateModalVisibility(!0)}},{key:"useExistingCustomTemplate",value:function(){var e=this;this.setState({isLoadingExistingCustomTemplate:!0}),this.props.onCustomVmSelect(this._selected,!0).catch((function(){return e.setState({isLoadingExistingCustomTemplate:!1})}))}},{key:"updateCustomTemplate",value:function(){var e=this;this.setState({isUpdatingCustomTemplate:!0}),this.props.onCustomVmSelect(this._selected).catch((function(){return e.setState({isUpdatingCustomTemplate:!1})}))}},{key:"render",value:function(){return u.createElement("div",{className:"custom-vm-selector"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Custom ",ds[this.props.os]," Cloud Desktops"),u.createElement("p",{className:"form-text"},"Choose from your saved custom cloud desktops or create a new one"),u.createElement(Ri,{loadingInitialData:this.props.loadingInitialData,onNewTemplate:this.createNew,onTemplateSelect:this.onSelect,templates:this.templates}),u.createElement(R.a,{title:"Update cloud desktop?",visible:this.state.modalVisible,onToggle:this.updateModalVisibility},u.createElement("p",{className:"text"},"Do you want to update this cloud desktop?"),u.createElement("div",null,u.createElement(T.a,{className:"short-btn",onClick:this.useExistingCustomTemplate,loading:this.state.isLoadingExistingCustomTemplate,disabled:this.state.isUpdatingCustomTemplate},"No, use it as is")),u.createElement("div",null,u.createElement(T.a,{className:"short-btn empty",onClick:this.updateCustomTemplate,loading:this.state.isUpdatingCustomTemplate,disabled:this.state.isLoadingExistingCustomTemplate},"Yes"))))}},{key:"templates",get:function(){var e=this;return this.props.templates.filter((function(t){return!t.defaultTemplate&&t.os===e.props.os}))}}]),t}(u.Component),Object(C.a)(Ki.prototype,"updateModalVisibility",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"updateModalVisibility"),Ki.prototype),Object(C.a)(Ki.prototype,"back",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"back"),Ki.prototype),Object(C.a)(Ki.prototype,"createNew",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"createNew"),Ki.prototype),Object(C.a)(Ki.prototype,"onSelect",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"onSelect"),Ki.prototype),Object(C.a)(Ki.prototype,"useExistingCustomTemplate",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"useExistingCustomTemplate"),Ki.prototype),Object(C.a)(Ki.prototype,"updateCustomTemplate",[j.a],Object.getOwnPropertyDescriptor(Ki.prototype,"updateCustomTemplate"),Ki.prototype),Ki),ms=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"requestVm",value:function(e){var t=this._instance,n=t.course,r=t.props;return n&&n.id&&!n.virtualMachineId?r.dispatch(r.asyncActions.getCourseVMAndConnection(n,r.asyncActions)).then((function(){return r.dispatch(Object(Y.Hb)(e))})):Promise.resolve()}}]),e}(),fs=n(48),ys=Symbol("CourseReady"),vs=(Yi=function(){function e(t){Object(i.a)(this,e),this._instance=t,this._emitter=new fs.EventEmitter,this._course=void 0,this._room=void 0,this._template=void 0,this._templateType=void 0,this._templateSize=void 0,Object(O.c)(O.a.SessionCreationRoom)}return Object(s.a)(e,[{key:"onSessionDetailsSubmit",value:function(e,t){this._course=e,t&&(this._room=t,Object(O.h)(O.a.SessionCreationRoom,t))}},{key:"onVmSelect",value:function(e,t,n,r){this._templateType=e,this._templateSize=t;var o=this._instance.props.templates,a=!1;return this._templateType===g.c.DefaultWin||this._templateType===g.c.CustomWin&&!(a=!!o.find((function(e){return!e.defaultTemplate&&e.os===P.K.Win})))?this._template=this._defaultWin:(this._templateType===g.c.DefaultUbuntu||this._templateType===g.c.CustomUbuntu&&!(a=!!o.find((function(e){return!e.defaultTemplate&&e.os===P.K.Linux}))))&&(this._template=this._defaultUbuntu),n||!a&&r?this._saveCourse(n):Promise.resolve()}},{key:"onCustomVmSelect",value:function(e,t){return this._template=e,this._template||(this._templateType===g.c.CustomWin?this._template=this._defaultWin:this._templateType===g.c.CustomUbuntu&&(this._template=this._defaultUbuntu)),this._template?this._saveCourse(t):Promise.resolve()}},{key:"onCardSave",value:function(e,t){var n=this,r=this._instance.props;return(0,r.dispatch)(r.asyncActions.addCreditCard(this._instance.props.user,e)).then((function(){return t||n._template?n._saveCourse(t):Promise.resolve()}))}},{key:"onCardLoaded",value:function(e){var t=this;return new Promise((function(){return e||t._template?t._saveCourse(e):Promise.reject("Invalid template")}))}},{key:"onCustomVmCustomization",value:function(e,t,n){var r=this;if(this._course&&this._course.id)return t=t.set("templateSize",this._templateSize),this._instance.props.dispatch(this._instance.props.asyncActions.saveCourseTemplate(this._course,e,t)).then((function(e){if(n){var t=new Blob([Ie.a.toArrayBuffer(n)],{type:"image/png"}),o=r._course;if(!o)throw new Error("Cannot set template of non-existing course");return Promise.all([r._instance.props.dispatch(r._instance.props.asyncActions.updateCourse(o.set("templateId",e.id))),r._instance.props.dispatch(r._instance.props.asyncActions.saveTemplateScreenshot(e,t))])}throw new Error("No screenshot set")}))}},{key:"saveCourse",value:function(){return this._saveCourse(!1)}},{key:"onCourseReadyEvent",value:function(e){this._emitter.addListener(ys,e)}},{key:"_saveCourse",value:function(e){var t=this;if(this._course&&this._template){var n,r=this._course,o=this._template;if(r.id){var a=r.set("templateId",o.id);n=this._instance.props.asyncActions.updateCourse(a)}else n=this._instance.props.asyncActions.createCourse(new P.x({type:r.type,name:r.name,description:r.description,templateId:o.id}));return this._instance.props.dispatch(n).then((function(n){var o=r.set("id",n.id);t._course=o,t._emitter.emit(ys,o,e)}))}return Promise.reject("Invalid template or course")}},{key:"course",get:function(){var e=this._course;if(e){var t=this._instance.props.courses.get(e.id);return t||e}return null}},{key:"room",get:function(){return this._room}},{key:"templateType",get:function(){return this._templateType}},{key:"_defaultWin",get:function(){return this._instance.props.templates.find((function(e){return e.defaultTemplate&&e.os===P.K.Win}))}},{key:"_defaultUbuntu",get:function(){return this._instance.props.templates.find((function(e){return e.defaultTemplate&&e.os===P.K.Linux}))}}]),e}(),Object(C.a)(Yi.prototype,"onSessionDetailsSubmit",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onSessionDetailsSubmit"),Yi.prototype),Object(C.a)(Yi.prototype,"onVmSelect",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onVmSelect"),Yi.prototype),Object(C.a)(Yi.prototype,"onCustomVmSelect",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onCustomVmSelect"),Yi.prototype),Object(C.a)(Yi.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onCardSave"),Yi.prototype),Object(C.a)(Yi.prototype,"onCardLoaded",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onCardLoaded"),Yi.prototype),Object(C.a)(Yi.prototype,"onCustomVmCustomization",[j.a],Object.getOwnPropertyDescriptor(Yi.prototype,"onCustomVmCustomization"),Yi.prototype),Yi),bs=(Gi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._sessionBuilder=new vs(Object(X.a)(n)),n._createCourseVmService=new ms(Object(X.a)(n)),e.preloadedData&&n.onSessionDetailsSubmit(e.preloadedData.course,e.preloadedData.room),n._redirectIfNoData(),n._sessionBuilder.onCourseReadyEvent((function(e,t){n.setState({courseId:e.id}),t&&n.props.dispatch(Object(Y.Hb)(Object(Y.Ob)(e.id)))})),n.state={courseId:"",totalPagesBackwards:0},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onSessionDetailsSubmit",value:function(e,t){this.props.dispatch(Object(Y.Hb)(this.props.routes.vmSelectorRoute)),this._sessionBuilder.onSessionDetailsSubmit(e,t)}},{key:"onCustomVmSelect",value:function(e,t){var n=this;return this._sessionBuilder.onCustomVmSelect(e,t).then((function(){return t?Promise.resolve():n._createCourseVmService.requestVm(n.props.routes.customizeVmRoute)}))}},{key:"onCardSave",value:function(e,t){var n=this;return this._sessionBuilder.onCardSave(e,t).then((function(){return n._handleCustomVm(t)}))}},{key:"onCardLoaded",value:function(e){var t=this;return this._sessionBuilder.onCardLoaded(e).then((function(){return t._handleCustomVm(e)}))}},{key:"onTemplateCustomizeCompleted",value:function(e,t,n){var r=this;return this._sessionBuilder.onCustomVmCustomization(e,t,n).then((function(){var e=r.state.courseId;e?r.props.dispatch(Object(Y.Hb)(Object(Y.Ob)(e))):console.error("Missing course after template customization")}))}},{key:"onVmSelect",value:function(e,t,n,r){var o=this,a=this._sessionBuilder.onVmSelect(e,t,n,r);if(!r)return this.props.onCardForm&&this.props.onCardForm(),this.setState({totalPagesBackwards:-2}),void this.props.dispatch(Object(Y.Hb)(this.props.routes.cardFormRoute));this.setState({totalPagesBackwards:0}),a.then((function(){return o._handleCustomVm(n)}))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"new-session-wizard"},u.createElement(y.d,null,this.props.routes.sessionDetailsRoute&&u.createElement(y.b,{path:this.props.routes.sessionDetailsRoute,exact:!0,render:function(){return u.createElement(ps.a,{data:{course:e._sessionBuilder.course,room:e._sessionBuilder.room},dispatch:e.props.dispatch,onSessionDetailsSubmit:e.onSessionDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.vmSelectorRoute,exact:!0,render:function(){return u.createElement(Ii,{dispatch:e.props.dispatch,user:e.props.user,templates:e.props.templates,recommendDefault:e.props.recommendDefaultTemplates,onVmSelect:e.onVmSelect})}}),u.createElement(y.b,{path:this.props.routes.customVmSelectorRoute,exact:!0,render:function(){return u.createElement(hs,{dispatch:e.props.dispatch,os:g.b[e._sessionBuilder.templateType],onCustomVmSelect:e.onCustomVmSelect,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:this.props.routes.cardFormRoute,exact:!0,render:function(){return u.createElement(us,{user:e.props.user,dispatch:e.props.dispatch,templates:e.props.templates,templateType:e._sessionBuilder.templateType,onCardSave:e.onCardSave,onCardLoaded:e.onCardLoaded})}}),u.createElement(y.b,{path:this.props.routes.customizeVmRoute,exact:!0,render:function(){return u.createElement(Ni,{vms:e.props.vms,vm:e.vm,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,cost:e.props.cost,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onDataCompleted:e.onTemplateCustomizeCompleted,totalPagesBackwards:e.state.totalPagesBackwards})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=this.props.routes.sessionDetailsRoute||Y.ib;this._sessionBuilder.course&&this._sessionBuilder.room||Object(Y.Eb)(e,t)||this.props.dispatch(Object(h.h)(t))}},{key:"_handleCustomVm",value:function(e){if(!e){var t=!1;this._sessionBuilder.templateType===g.c.CustomWin?t=!!this.props.templates.find((function(e){return!e.defaultTemplate&&e.os===P.K.Win})):this._sessionBuilder.templateType===g.c.CustomUbuntu&&(t=!!this.props.templates.find((function(e){return!e.defaultTemplate&&e.os===P.K.Linux}))),t?this.props.dispatch(Object(Y.Hb)(this.props.routes.customVmSelectorRoute)):this._createCourseVmService.requestVm(this.props.routes.customizeVmRoute)}}},{key:"course",get:function(){var e=this.state.courseId;if(e)return this.props.courses.get(e)}},{key:"vm",get:function(){return this.course&&this.course.virtualMachineId?this.props.vms.get(this.course.virtualMachineId):new P.kb({})}}]),t}(u.Component),Object(C.a)(Gi.prototype,"onSessionDetailsSubmit",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onSessionDetailsSubmit"),Gi.prototype),Object(C.a)(Gi.prototype,"onCustomVmSelect",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onCustomVmSelect"),Gi.prototype),Object(C.a)(Gi.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onCardSave"),Gi.prototype),Object(C.a)(Gi.prototype,"onCardLoaded",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onCardLoaded"),Gi.prototype),Object(C.a)(Gi.prototype,"onTemplateCustomizeCompleted",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onTemplateCustomizeCompleted"),Gi.prototype),Object(C.a)(Gi.prototype,"onVmSelect",[j.a],Object.getOwnPropertyDescriptor(Gi.prototype,"onVmSelect"),Gi.prototype),Gi),gs=(n(1988),Ji=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"onRecordingSelect",value:function(e){var t="",n=e.chapters.filter((function(e){return!e.videoUrl}));if(1===n.size){var r=n.first().name;t='This recording has a task titled "'.concat(r,'" that is not recorded. ')+"That task will be skipped in this session"}else n.size>1&&(t="This recording has tasks that are not recorded. Those tasks will be skipped in this session");t&&this.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Warning",text:t,ttl:1e4}))),this.props.onRecordingSelect(e)}},{key:"render",value:function(){return u.createElement("div",{className:"recorded-sessions-list"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Recorded Sessions"),u.createElement("div",{className:"sessions"},u.createElement(Yr,{recordings:this.recordings,templates:this.props.templates,loadingInitialData:this.props.loadingInitialData,disableUnscheduleable:!0,dispatch:this.props.dispatch,onRecordingClick:this.onRecordingSelect,onRecordingPreviewClick:this.onRecordingSelect})))}},{key:"recordings",get:function(){return this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList()}}]),t}(u.Component),Object(C.a)(Ji.prototype,"back",[j.a],Object.getOwnPropertyDescriptor(Ji.prototype,"back"),Ji.prototype),Object(C.a)(Ji.prototype,"onRecordingSelect",[j.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onRecordingSelect"),Ji.prototype),Ji),Os=(Zi=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o))))._course=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onCardSave",value:function(e){var t=this,n=this.props,r=n.asyncActions;return(0,n.dispatch)(r.addCreditCard(this.props.user,e)).then((function(){return t._selectRecord()}))}},{key:"onRecordingSelect",value:function(e){this._course=e,this.props.user.creditCards.size?this._selectRecord():this.props.dispatch(Object(h.g)(Y.J))}},{key:"render",value:function(){var e=this;return u.createElement(y.d,null,u.createElement(y.b,{path:Y.K,exact:!0,render:function(){return u.createElement(gs,{dispatch:e.props.dispatch,courses:e.props.courses,templates:e.props.templates,loadingInitialData:e.props.loadingInitialData,onRecordingSelect:e.onRecordingSelect})}}),u.createElement(y.b,{path:Y.J,exact:!0,render:function(){return u.createElement(us,{user:e.props.user,dispatch:e.props.dispatch,templates:e.props.templates,templateType:e.templateType,onCardSave:e.onCardSave})}}),u.createElement(y.a,{to:Y.H}))}},{key:"_selectRecord",value:function(){this.props.dispatch(Object(Y.Hb)(Object(Y.Ob)(this._course.id)))}},{key:"templateType",get:function(){return Object(g.f)(this.props.templates,this._course.templateId)}}]),t}(u.Component),Object(C.a)(Zi.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor(Zi.prototype,"onCardSave"),Zi.prototype),Object(C.a)(Zi.prototype,"onRecordingSelect",[j.a],Object.getOwnPropertyDescriptor(Zi.prototype,"onRecordingSelect"),Zi.prototype),Zi),Cs=n(1340),ks=(n(1989),qi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).chaptersListRef=void 0,n._recordingBuilder=new Qn(Object(X.a)(n)),n.state={isLoading:!1,unsavedChangesModalVisibility:!1,chapterToBeRecorded:null,chapterToBePreviewed:null,formChanges:[]},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.chapters!==this.props.chapters&&this.setState({formChanges:bn(e.chapters,this.props.initialValues)})}},{key:"submit",value:function(e){var t=this;e.preventDefault(),this.setState({isLoading:!0}),this.saveUnsavedChanges().then((function(){return t._updateChaptersListInput(),t.props.onDone()})).catch((function(){return t.setState({isLoading:!1})}))}},{key:"onToggleUnsavedChangesModal",value:function(){this.state.unsavedChangesModalVisibility&&!this.isFormSaveable&&this.chaptersListRef.getRenderedComponent().showValidation();this.setState({unsavedChangesModalVisibility:!this.state.unsavedChangesModalVisibility})}},{key:"onDiscardUnsavedChanges",value:function(){var e=this;this._recordingBuilder.discardUnsavedChanges().then((function(){return e._recordingBuilder.proceedAction()}))}},{key:"saveUnsavedChanges",value:function(){return this._recordingBuilder.saveUnsavedChapters()}},{key:"recordChapter",value:function(){this.state.chapterToBeRecorded&&this.props.onRecordChapter(this.state.chapterToBeRecorded)}},{key:"previewChapter",value:function(){this.state.chapterToBePreviewed&&this.props.onPreviewChapter(this.state.chapterToBePreviewed)}},{key:"onSaveUnsavedChanges",value:function(){return this._recordingBuilder.onSaveUnsavedChanges().then(this._updateChaptersListInput)}},{key:"render",value:function(){var e=this;return(u.createElement("div",{className:"chapter-list-form form-styles"},u.createElement("h2",null,"Add Tasks"),u.createElement("p",{className:"text"},u.createElement("span",null,"Instruction: Show learners how to do the task"),u.createElement("span",null,"Challenge: Ask learners to do the task themselves")),u.createElement("form",{name:"chaptersList",onSubmit:this.submit},u.createElement(_.a,Object.assign({name:"chapters",component:vn.a,ref:function(t){return e.chaptersListRef=t},forwardRef:!0},{asyncActions:this.props.asyncActions,course:this.props.course,templates:this.props.templates,rooms:this.props.rooms,actionDispatch:this.props.dispatch,onRecordChapter:this._recordingBuilder.onRecordChapter,onPreviewChapter:this._recordingBuilder.onPreviewChapter,onRecordUnsupported:this.props.onRecordUnsupported})),u.createElement(T.a,{disabled:!this.props.valid,loading:this.state.isLoading},"Done")),u.createElement(wn,{title:"Recording Details",visible:this.state.unsavedChangesModalVisibility,onToggle:this.onToggleUnsavedChangesModal,saveable:this.isFormSaveable,changes:this.state.formChanges,onDiscard:this.onDiscardUnsavedChanges,onSave:this.onSaveUnsavedChanges}),u.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"})))}},{key:"_updateChaptersListInput",value:function(){this._recordingBuilder.chaptersListRenderedComponent&&this._recordingBuilder.chaptersListRenderedComponent.props.input.onChange(this.props.course.chapters.map((function(e,t){return e.set("key",t)})))}},{key:"hasUnsavedChanges",get:function(){return!!this.state.formChanges.length}},{key:"isFormSaveable",get:function(){return!(!this.props.valid||!this.hasUnsavedChanges)}}]),t}(u.Component),Object(C.a)(qi.prototype,"submit",[j.a],Object.getOwnPropertyDescriptor(qi.prototype,"submit"),qi.prototype),Object(C.a)(qi.prototype,"onToggleUnsavedChangesModal",[j.a],Object.getOwnPropertyDescriptor(qi.prototype,"onToggleUnsavedChangesModal"),qi.prototype),Object(C.a)(qi.prototype,"onDiscardUnsavedChanges",[j.a],Object.getOwnPropertyDescriptor(qi.prototype,"onDiscardUnsavedChanges"),qi.prototype),Object(C.a)(qi.prototype,"onSaveUnsavedChanges",[j.a],Object.getOwnPropertyDescriptor(qi.prototype,"onSaveUnsavedChanges"),qi.prototype),Object(C.a)(qi.prototype,"_updateChaptersListInput",[j.a],Object.getOwnPropertyDescriptor(qi.prototype,"_updateChaptersListInput"),qi.prototype),qi),js=Object(D.a)("chaptersList"),ws=Object(S.a)({form:"chaptersList",validate:yn.h,enableReinitialize:!1})(ks),Es=Object(w.c)((function(e,t){return{chapters:js(e,"chapters"),initialValues:{chapters:t.course.chapters.map((function(e,t){return e.set("key",t)}))}}}))(ws),_s=(Xi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._chapterVmService=new Yt(Object(X.a)(n)),n.state={courseVmId:null},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){Object(Y.Gb)(this.props.location.pathname,this.props.routes.recordingChapterMediaRoute)&&!e.courses.count()&&this.props.courses.count()&&this._chapterVmService.requestVm().then(this.forceUpdate)}},{key:"onExitChapterRecordingOrPreview",value:function(){this.props.dispatch(Object(Y.Hb)(this.props.routes.recordChaptersRoute(this.course.id)))}},{key:"onUnsupportedRecordingBack",value:function(){this.props.dispatch(Object(Y.Hb)(this.props.routes.recordChaptersRoute(this.course.id)))}},{key:"onRecordUnsupported",value:function(){var e=this.props.chapterListRoutes.recordingChaptersUnsupportedRoute;this.props.dispatch(Object(Y.Hb)(e(this.course.id)))}},{key:"onPreviewChapter",value:function(e){var t=this.props.chapterListRoutes.recordingChapterPreviewRoute;this.props.dispatch(Object(Y.Hb)(t(this.course.id,e.id)))}},{key:"onRecordChapter",value:function(e){var t=this;this._chapterVmService.requestVm().then((function(){var n=t.props.chapterListRoutes.recordingChapterMediaRoute;t.props.dispatch(Object(Y.Hb)(n(t.course.id,e.id)))}))}},{key:"render",value:function(){var e=this;return this.props.loadingInitialData||this.course?u.createElement(y.d,null,u.createElement(y.b,{path:this.props.routes.recordingChaptersRoute,exact:!0,render:function(){return e.course?u.createElement(Es,{dispatch:e.props.dispatch,course:e.course,asyncActions:e.props.asyncActions,templates:e.props.templates,rooms:e.props.rooms,vms:e.props.vms,onDone:function(){return e.props.onCreatingChaptersCompleted(e.course)},onRecordUnsupported:e.onRecordUnsupported,onPreviewChapter:e.onPreviewChapter,onRecordChapter:e.onRecordChapter}):null}}),u.createElement(y.b,{path:this.props.routes.recordingChapterMediaRoute,exact:!0,render:function(t){var n=t.match;if(e.course){var r=e.course.chapters.find((function(e){return e.id===n.params.chapterId}));return r&&e.courseVm?u.createElement($e,{dispatch:e.props.dispatch,vm:e.courseVm,course:e.course,chapter:r,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,onExit:e.onExitChapterRecordingOrPreview,remoteClientManager:e.props.remoteClientManager}):null}return null}}),u.createElement(y.b,{path:this.props.routes.recordingChapterPreviewRoute,exact:!0,render:function(t){var n=t.match;if(e.course){var r=e.course.chapters.find((function(e){return e.id===n.params.chapterId}));return r?u.createElement(Kt,{course:e.course,chapter:r,currentChapter:e.props.currentChapter,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onExit:e.onExitChapterRecordingOrPreview}):null}return null}}),u.createElement(y.b,{path:Y.P,exact:!0,render:function(){return u.createElement(ee,{onBack:e.onUnsupportedRecordingBack})}}),u.createElement(y.a,{to:Y.H})):"Session not found"}},{key:"course",get:function(){return this.props.courses.get(this.props.match.params.courseId)}},{key:"courseVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(C.a)(Xi.prototype,"onExitChapterRecordingOrPreview",[j.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onExitChapterRecordingOrPreview"),Xi.prototype),Object(C.a)(Xi.prototype,"onUnsupportedRecordingBack",[j.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onUnsupportedRecordingBack"),Xi.prototype),Object(C.a)(Xi.prototype,"onRecordUnsupported",[j.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onRecordUnsupported"),Xi.prototype),Object(C.a)(Xi.prototype,"onPreviewChapter",[j.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onPreviewChapter"),Xi.prototype),Object(C.a)(Xi.prototype,"onRecordChapter",[j.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onRecordChapter"),Xi.prototype),Xi),Ss=($i=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._sessionBuilder=new vs(Object(X.a)(n)),n._createCourseVmService=new ms(Object(X.a)(n)),n.state={courseId:"",totalPagesBackwards:0},e.preloadedData&&n._sessionBuilder.onSessionDetailsSubmit(e.preloadedData.course),n._sessionBuilder.onCourseReadyEvent((function(e,t){if(n.setState({courseId:e.id}),t){var r=n.props.routes.recordChaptersRoute(e.id);n.props.dispatch(Object(Y.Hb)(r))}})),e.routes.recordingDetailsRoute&&n.props.location.pathname!==e.routes.recordingDetailsRoute&&!Object(Y.Db)(e.routes.recordingChaptersRoute,n.props.location.pathname)&&n.props.dispatch(Object(Y.Hb)(e.routes.recordingDetailsRoute)),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onSessionDetailsSubmit",value:function(e){this._sessionBuilder.onSessionDetailsSubmit(e);var t=this.props.routes.recordingVmSelectorRoute;this.props.dispatch(Object(Y.Hb)(t))}},{key:"onVmSelect",value:function(e,t,n,r){var o=this,a=this._sessionBuilder.onVmSelect(e,t,n,r);if(!r)return this.props.onCardForm&&this.props.onCardForm(),this.setState({totalPagesBackwards:-2}),void this.props.dispatch(Object(Y.Hb)(this.props.routes.recordingCardFormRoute));this.setState({totalPagesBackwards:0}),a.then((function(){return o._handleCustomVm(n)}))}},{key:"onCustomVmSelect",value:function(e,t){var n=this;return this._sessionBuilder.onCustomVmSelect(e,t).then((function(){return t?Promise.resolve():n._createCourseVmService.requestVm(n.props.routes.recordingCustomizeVmRoute)}))}},{key:"onCardSave",value:function(e,t){var n=this;return this._sessionBuilder.onCardSave(e,t).then((function(){return n._handleCustomVm(t)}))}},{key:"onCardLoaded",value:function(e){var t=this;return this._sessionBuilder.onCardLoaded(e).then((function(){return t._handleCustomVm(e)}))}},{key:"onTemplateCustomizeCompleted",value:function(e,t,n){var r=this;return this._sessionBuilder.onCustomVmCustomization(e,t,n).then((function(){var e=r.state.courseId;e?r.props.dispatch(Object(Y.Hb)(r.props.routes.recordChaptersRoute(e))):console.error("Missing course after template customization")}))}},{key:"onCreatingChaptersCompleted",value:function(e){return this.props.schedule?e.chapters.find((function(e){return!!e.videoUrl}))?(this.props.dispatch(Object(Y.Hb)(Object(Y.Ob)(e.id))),Promise.resolve()):(this.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"No recorded tasks",text:"You cannot schedule a recording that does not have a recorded task"}))),Promise.reject("No recorded tasks")):(this.props.dispatch(Object(Y.Hb)(this.props.routes.recordingsRoute)),Promise.resolve())}},{key:"render",value:function(){var e=this;return u.createElement(y.d,null,this.props.routes.recordingDetailsRoute&&u.createElement(y.b,{path:this.props.routes.recordingDetailsRoute,exact:!0,render:function(){return u.createElement(Cs.a,{course:e._sessionBuilder.course,schedule:e.props.schedule,dispatch:e.props.dispatch,onSessionDetailsSubmit:e.onSessionDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.recordingVmSelectorRoute,exact:!0,render:function(){return u.createElement(Ii,{dispatch:e.props.dispatch,user:e.props.user,templates:e.props.templates,recommendDefault:e.props.recommendDefaultTemplates,onVmSelect:e.onVmSelect})}}),u.createElement(y.b,{path:this.props.routes.recordingCardFormRoute,exact:!0,render:function(){return u.createElement(us,{user:e.props.user,dispatch:e.props.dispatch,templates:e.props.templates,templateType:e._sessionBuilder.templateType,onCardSave:e.onCardSave,onCardLoaded:e.onCardLoaded})}}),u.createElement(y.b,{path:this.props.routes.recordingCustomVmSelectorRoute,exact:!0,render:function(){return u.createElement(hs,{dispatch:e.props.dispatch,os:g.b[e._sessionBuilder.templateType],onCustomVmSelect:e.onCustomVmSelect,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:this.props.routes.recordingCustomizeVmRoute,exact:!0,render:function(){return u.createElement(Ni,{vms:e.props.vms,vm:e.vm,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,cost:e.props.cost,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onDataCompleted:e.onTemplateCustomizeCompleted,totalPagesBackwards:e.state.totalPagesBackwards})}}),u.createElement(y.b,{path:this.props.routes.recordingChaptersRoute,render:function(t){var n=t.match;return u.createElement(_s,{routes:e.props.chaptersWrapperRoutes,chapterListRoutes:e.props.chapterListRoutes,courses:e.props.courses,templates:e.props.templates,rooms:e.props.rooms,vms:e.props.vms,currentChapter:e.props.currentChapter,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,match:n,location:e.props.location,onCreatingChaptersCompleted:e.onCreatingChaptersCompleted})}}),u.createElement(y.a,{to:Y.H}))}},{key:"_handleCustomVm",value:function(e){if(!e){var t=!1;this._sessionBuilder.templateType===g.c.CustomWin?t=!!this.props.templates.find((function(e){return!e.defaultTemplate&&e.os===P.K.Win})):this._sessionBuilder.templateType===g.c.CustomUbuntu&&(t=!!this.props.templates.find((function(e){return!e.defaultTemplate&&e.os===P.K.Linux}))),t?this.props.dispatch(Object(Y.Hb)(this.props.routes.recordingCustomVmSelectorRoute)):this._createCourseVmService.requestVm(this.props.routes.recordingCustomizeVmRoute)}}},{key:"course",get:function(){var e=this.state.courseId;if(e)return this.props.courses.get(e)}},{key:"vm",get:function(){var e;return this.course&&this.course.virtualMachineId&&(e=this.props.vms.get(this.course.virtualMachineId)),e||new P.kb({})}}]),t}(u.Component),Object(C.a)($i.prototype,"onSessionDetailsSubmit",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onSessionDetailsSubmit"),$i.prototype),Object(C.a)($i.prototype,"onVmSelect",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onVmSelect"),$i.prototype),Object(C.a)($i.prototype,"onCustomVmSelect",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onCustomVmSelect"),$i.prototype),Object(C.a)($i.prototype,"onCardSave",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onCardSave"),$i.prototype),Object(C.a)($i.prototype,"onCardLoaded",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onCardLoaded"),$i.prototype),Object(C.a)($i.prototype,"onTemplateCustomizeCompleted",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onTemplateCustomizeCompleted"),$i.prototype),Object(C.a)($i.prototype,"onCreatingChaptersCompleted",[j.a],Object.getOwnPropertyDescriptor($i.prototype,"onCreatingChaptersCompleted"),$i.prototype),$i),Ds=n(370),Ps=(Qi=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._course=void 0,n._room=void 0,n._loadData(),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onCardForm",value:function(){this.props.user.mobileNumber&&this.props.dispatch(new v.i(new P.I({type:P.J.Error,title:"Unverified cell number",text:"Please click the link sent to you by SMS to get your credit",context:Ds.a})))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"try-flow"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.f,render:function(){return u.createElement(bs,{preloadedData:{course:e._course,room:e._room},asyncActions:e.props.asyncActions,cost:e.props.cost,courses:e.props.courses,dispatch:e.props.dispatch,location:e.props.location,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,rooms:e.props.rooms,user:e.props.user,vms:e.props.vms,templates:e.props.templates,hideChargeScreenBackButton:!0,recommendDefaultTemplates:!0,onCardForm:e.onCardForm,routes:{cardFormRoute:Y.c,customizeVmRoute:Y.e,customVmSelectorRoute:Y.d,vmSelectorRoute:Y.g}})}}),u.createElement(y.b,{path:Y.p,render:function(){return u.createElement(Ss,{preloadedData:{course:e._course},asyncActions:e.props.asyncActions,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,cost:e.props.cost,courses:e.props.courses,currentChapter:e.props.currentChapter,location:e.props.location,rooms:e.props.rooms,schedule:!0,templates:e.props.templates,vms:e.props.vms,user:e.props.user,hideChargeScreenBackButton:!0,recommendDefaultTemplates:!0,onCardForm:e.onCardForm,routes:{recordChaptersRoute:Y.Ab,recordingChaptersRoute:Y.k,recordingCardFormRoute:Y.h,recordingCustomizeVmRoute:Y.n,recordingCustomVmSelectorRoute:Y.m,recordingsRoute:Y.p,recordingVmSelectorRoute:Y.o},chaptersWrapperRoutes:{recordChaptersRoute:Y.Ab,recordingChapterMediaRoute:Y.i,recordingChapterPreviewRoute:Y.j,recordingChaptersRoute:Y.k,recordingChaptersUnsupportedRoute:Y.l},chapterListRoutes:{recordingChapterMediaRoute:Y.yb,recordingChapterPreviewRoute:Y.zb,recordingChaptersUnsupportedRoute:Y.Bb}})}})))}},{key:"_loadData",value:function(){var e=Object(O.d)(O.a.TryFlowSession);e?(this._course=new P.x(e.course),this._room=new P.P(e.room)):this.props.dispatch(Object(h.g)(Y.w))}}]),t}(u.Component),Object(C.a)(Qi.prototype,"onCardForm",[j.a],Object.getOwnPropertyDescriptor(Qi.prototype,"onCardForm"),Qi.prototype),Qi),Ts=n(168),Rs=function(){function e(t){Object(i.a)(this,e),this._timers=Object(tt.Map)([[]]),this._notified={},this._props=void 0,this._props=t,this.setTimers(this._props),Object(Ts.c)()}return Object(s.a)(e,[{key:"setTimers",value:function(e){var t=this,n=Date.now();this.destroyTimers(),this._cleanNotified(e),this._props=e,this._timers=e.rooms.filter((function(e){var r=e.startTime.getTime()-n,o=0<r&&r<864e5;return!e.deleted&&o&&!t._notified[e.id]})).map((function(e){return setTimeout((function(){return t._notify(e)}),e.startTime.getTime()-n-6e5)})).toMap()}},{key:"updateTimers",value:function(e){this.setTimers(e)}},{key:"destroyTimers",value:function(){this._timers.forEach(clearTimeout)}},{key:"_notify",value:function(e){this._notified[e.id]=!0;var t=this._props.courses.get(e.courseId),n=Math.round((e.startTime.getTime()-(new Date).getTime())/1e3/60);t&&n>0&&(this._props.dispatch(new v.i(new P.I({type:P.J.General,context:"upcoming_session",ttl:15e3,text:"**Session starting**: Your session "+"\u201c".concat(t.name.length>50?t.name.substr(0,50)+"...":t.name,"\u201d ")+"is starting in ".concat(n," min").concat(n>1?"s":"",". [Join now](").concat(Object(Y.Pb)(e.secret),")")}))),this._desktopNotification(t.name,n))}},{key:"_desktopNotification",value:function(e,t){Object(Ts.a)()&&"hidden"===document.visibilityState&&Object(Ts.b)("Session starting",'"'.concat(e,'" starts in ').concat(t," min").concat(t>1?"s":""),15e3)}},{key:"_cleanNotified",value:function(e){var t=this;e.rooms.forEach((function(e){var n=t._props.rooms.get(e.id);n&&e.startTime!==n.startTime&&(t._notified[e.id]=!1)}))}}]),e}(),xs=(n(1990),Zr.tz.guess()),Ms=(es=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).startTimePickerRef=void 0,n.expirationTimePickerRef=void 0,n.state={timezone:xs,mobileNumber:e.user.mobileNumber,mobileNumberError:null,isSaving:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.setState({timezone:xs,mobileNumber:"",mobileNumberError:null})}},{key:"onSaveRoom",value:function(){var e=this,t=this.props,n=uo(t.room,t.startTime,t.expirationTime,this.state.timezone),r=[this.props.onSaveRoom(this.props.course,n)];if(this.state.mobileNumber!==this.props.user.mobileNumber&&this._isMobileNumberValid(this.state.mobileNumber)){var o=Object(Ka.b)(this.state.mobileNumber),a=Object(Ka.a)(o,"E.164"),i=this.props.user.set("mobileNumber",a);r.push(this.props.onUserUpdate(i))}this.setState({isSaving:!0}),Promise.all(r).catch((function(){return e.setState({isSaving:!1})}))}},{key:"onMobileNumberChanged",value:function(e){this.setState({mobileNumber:e})}},{key:"onMobileNumberBlur",value:function(e){var t=this;e!==this.state.mobileNumber?this.setState({mobileNumber:e},(function(){return t._validateMobileNumber(t.state.mobileNumber)})):this._validateMobileNumber(this.state.mobileNumber)}},{key:"onStartTimeChange",value:function(e){this.props.onStartTimeChange(e);var t=this.props,n=lo(t.startTime,t.expirationTime,e);this.props.onExpirationChange(n)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"create-event-modal"},u.createElement(R.a,{title:"Schedule Session",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"join-room form-styles"},u.createElement("div",{className:"row"},u.createElement(T.e,{ref:function(t){return e.startTimePickerRef=t},label:"Start",date:this.props.startTime,minDate:this.props.minStartDate,onDateChange:this.onStartTimeChange}),u.createElement("div",{className:"field-info"},u.createElement(T.z,{timezone:this.state.timezone,onTimezoneChange:function(t){return e.setState({timezone:t})}}))),u.createElement(T.e,{ref:function(t){return e.expirationTimePickerRef=t},label:"End",date:this.props.expirationTime,minDate:this.props.minExpDate,onDateChange:this.props.onExpirationChange}),!this.props.user.mobileNumber&&u.createElement("div",{className:"mobile-number"},u.createElement(T.c,{value:this.state.mobileNumber,error:this.state.mobileNumberError?this.state.mobileNumberError:"",onChange:this.onMobileNumberChanged,onBlur:this.onMobileNumberBlur}),u.createElement("div",{className:"field-info"},"(Optional) Get reminder SMS 15 mins before session starts"))),u.createElement(T.a,{className:"def-btn btn",onClick:this.onSaveRoom,disabled:!this.isDataValid,loading:this.state.isSaving},"Save"),u.createElement("i",{className:"fa fa-calendar","aria-hidden":"true"})))}},{key:"_isMobileNumberValid",value:function(e){var t=Object(Ka.b)(e);return t&&t.country&&t.phone}},{key:"_validateMobileNumber",value:function(e){var t=Object(T.B)({cellNumber:e});this.setState({mobileNumberError:t.cellNumber?t.cellNumber:null})}},{key:"isDataValid",get:function(){return null===this.state.mobileNumberError}}]),t}(u.Component),Object(C.a)(es.prototype,"onSaveRoom",[j.a],Object.getOwnPropertyDescriptor(es.prototype,"onSaveRoom"),es.prototype),Object(C.a)(es.prototype,"onMobileNumberChanged",[j.a],Object.getOwnPropertyDescriptor(es.prototype,"onMobileNumberChanged"),es.prototype),Object(C.a)(es.prototype,"onMobileNumberBlur",[j.a],Object.getOwnPropertyDescriptor(es.prototype,"onMobileNumberBlur"),es.prototype),Object(C.a)(es.prototype,"onStartTimeChange",[j.a],Object.getOwnPropertyDescriptor(es.prototype,"onStartTimeChange"),es.prototype),es);n(1991);!function(e){e.Min15="Min15",e.Min30="Min30",e.Min45="Min45",e.Hour1="Hour1",e.Hour2="Hour2",e.Custom="Custom"}(rs||(rs={}));var Ns,Vs=(ts={},Object($.a)(ts,rs.Min15,15),Object($.a)(ts,rs.Min30,30),Object($.a)(ts,rs.Min45,45),Object($.a)(ts,rs.Hour1,60),Object($.a)(ts,rs.Hour2,120),ts),As=(ns=function(e){function t(e){var n;Object(i.a)(this,t),n=Object(c.a)(this,Object(p.a)(t).call(this,e));var r=e.courseDuration,o=r<36e5?rs.Hour1:r<=72e5?rs.Hour2:rs.Custom;return n.state={duration:o},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"start",value:function(){if(this.state.duration!==rs.Custom){var e=this.props.delay?this.props.delay:0,t=Vs[this.state.duration];this.props.onStartIn(e,t)}else this.props.onScheduleWithCustomDuration()}},{key:"onDurationChange",value:function(e){this.setState({duration:e})}},{key:"render",value:function(){var e=0===this.props.delay?"now":"in ".concat(this.props.delay," mins");return u.createElement("div",{className:"quick-scheduler"},u.createElement("i",{className:"fa fa-calendar","aria-hidden":"true"}),u.createElement("h2",null,"Schedule Session"),u.createElement("h4",null,"You can start a session ",e," or schedule one for later"),u.createElement("div",{className:"start-button"},u.createElement(T.a,{className:"btn",onClick:this.start},"Start ",e),u.createElement("span",null,"at ",this.props.startTime.format("h:mma")," (GMT ",Zr.tz(Zr.tz.guess()).format("Z"),") with"),u.createElement(T.x,{value:this.state.duration,onChange:this.onDurationChange},u.createElement(T.n,{value:rs.Min15},"15-mins"),u.createElement(T.n,{value:rs.Min30},"30-mins"),u.createElement(T.n,{value:rs.Min45},"45-mins"),u.createElement(T.n,{value:rs.Hour1},"1-hour"),u.createElement(T.n,{value:rs.Hour2},"2-hours"),u.createElement(T.n,{value:rs.Custom},"Custom")),u.createElement("span",null,"duration")),u.createElement("span",{className:"separator"},"Or"))}}]),t}(u.Component),Object(C.a)(ns.prototype,"start",[j.a],Object.getOwnPropertyDescriptor(ns.prototype,"start"),ns.prototype),Object(C.a)(ns.prototype,"onDurationChange",[j.a],Object.getOwnPropertyDescriptor(ns.prototype,"onDurationChange"),ns.prototype),ns),Is=(n(1992),Ns=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._minTimeInterval=void 0;var r=!!e.startTime&&!!e.expirationTime,o=e.startTime&&e.startTime.isValid()?e.startTime:m(),a=e.expirationTime&&e.expirationTime.isValid()?e.expirationTime:m().add(1,"h");return n.state={createModalVisible:r,startTime:o,expirationTime:a,minStartDate:n.minStartDate},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._minTimeInterval=setInterval((function(){e.state.minStartDate.isSame(e.minStartDate,"minute")||e.setState({minStartDate:e.minStartDate})}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this._minTimeInterval)}},{key:"schedule",value:function(e,t){var n=t.diff(e);t=this.courseDuration>n?e.clone().add(this.courseDuration,"ms"):t,this.setState({createModalVisible:!0,startTime:m(e),expirationTime:m(t)})}},{key:"onStartTimeChange",value:function(e){this.setState({startTime:e})}},{key:"onExpirationChange",value:function(e){this.setState({expirationTime:e})}},{key:"toggleCreateModal",value:function(){this.setState({createModalVisible:!this.state.createModalVisible})}},{key:"onStartIn",value:function(e,t){var n=uo(this.props.room,m().add(e,"minutes").seconds(0),m().add(t+e,"minutes").seconds(0),m.tz.guess());this.saveRoom(this.props.course,n)}},{key:"onScheduleWithCustomDuration",value:function(){var e=m().add(this.delay,"minutes").seconds(0),t=this.courseDuration||36e5,n=m(e).add(t,"milliseconds").seconds(0);this.schedule(e,n)}},{key:"updateUser",value:function(e){return this.props.dispatch(this.props.asyncActions.updateUser(e))}},{key:"saveRoom",value:function(e,t){var n=this;return this._validateTimeAndWarn(e,t)?this.props.dispatch(this.props.asyncActions.addRoom(e,t)).then((function(e){n.props.dispatch(new v.O("upcoming_session")),n.props.dispatch(Object(h.g)(Object(Y.Pb)(e.secret)))})):Promise.reject("Time is not valid")}},{key:"render",value:function(){return u.createElement("div",{className:"session-scheduler"},u.createElement(As,{delay:this.delay,startTime:this.state.minStartDate,courseDuration:this.courseDuration,onStartIn:this.onStartIn,onScheduleWithCustomDuration:this.onScheduleWithCustomDuration}),u.createElement(Pa,{rooms:this.props.rooms,courses:this.props.courses,templates:this.props.templates,onSelectSlot:this.schedule}),u.createElement(Ms,{onToggle:this.toggleCreateModal,minStartDate:this.state.minStartDate,minExpDate:this.minExpDate,course:this.props.course,room:this.props.room,visible:this.state.createModalVisible,startTime:this.state.startTime,expirationTime:this.state.expirationTime,onSaveRoom:this.saveRoom,onStartTimeChange:this.onStartTimeChange,onExpirationChange:this.onExpirationChange,onUserUpdate:this.updateUser,user:this.props.user}))}},{key:"_validateTimeAndWarn",value:function(e,t){var n=co(t,this._getCourseTemplate(e),void 0,this.props.courseDuration);return!n.isValid&&n.notification&&this.props.dispatch(new v.i(n.notification)),n.isValid}},{key:"_getCourseTemplate",value:function(e){return this.props.templates.get(e.templateId)}},{key:"delay",get:function(){return po(this._getCourseTemplate(this.props.course))}},{key:"minStartDate",get:function(){return m().add(this.delay,"minutes").seconds(0)}},{key:"minExpDate",get:function(){return m(this.state.startTime).add(this.courseDuration,"ms")}},{key:"courseDuration",get:function(){var e=this.props.course.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);return 60*Math.ceil(e/60/1e3)*1e3}}]),t}(u.Component),Object(C.a)(Ns.prototype,"schedule",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"schedule"),Ns.prototype),Object(C.a)(Ns.prototype,"onStartTimeChange",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"onStartTimeChange"),Ns.prototype),Object(C.a)(Ns.prototype,"onExpirationChange",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"onExpirationChange"),Ns.prototype),Object(C.a)(Ns.prototype,"toggleCreateModal",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"toggleCreateModal"),Ns.prototype),Object(C.a)(Ns.prototype,"onStartIn",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"onStartIn"),Ns.prototype),Object(C.a)(Ns.prototype,"onScheduleWithCustomDuration",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"onScheduleWithCustomDuration"),Ns.prototype),Object(C.a)(Ns.prototype,"updateUser",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"updateUser"),Ns.prototype),Object(C.a)(Ns.prototype,"saveRoom",[j.a],Object.getOwnPropertyDescriptor(Ns.prototype,"saveRoom"),Ns.prototype),Ns),Us=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e)))._cb=void 0,n._failedToInitUnsubscribe=void 0,n._onInitUnsubscribe=void 0,n._routeQueryParams=void 0,n._upcomingSessions=void 0,n._cb=function(){n.props.dispatch(Object(h.h)(Y.F))},n._routeQueryParams=new Y.db(e.location),n._loadData((function(){n._logoutIfJwtExpiresSoon(),n._checkIfCostShouldBeShown()})),n._upcomingSessions=new Rs(e),Object(Y.Db)(Y.q,e.location.pathname)||Object(O.c)(O.a.TryFlowSession),n.state={notDeletedCourses:e.courses.filter((function(e){return!e.deleted})).toMap(),notDeletedRooms:e.rooms.filter((function(e){return!e.deleted})).toMap()},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Object(b.b)().onLogout(this._cb)}},{key:"componentWillUnmount",value:function(){Object(b.b)().unsubscribe(this._cb),this._failedToInitUnsubscribe&&this._failedToInitUnsubscribe(),this._onInitUnsubscribe&&this._onInitUnsubscribe(),this._upcomingSessions.destroyTimers()}},{key:"componentWillReceiveProps",value:function(e){this._upcomingSessions.updateTimers(e)}},{key:"componentDidUpdate",value:function(e){var t={};this.props.courses!==e.courses&&(t.notDeletedCourses=this.props.courses.filter((function(e){return!e.deleted})).toMap()),this.props.rooms!==e.rooms&&(t.notDeletedRooms=this.props.rooms.filter((function(e){return!e.deleted})).toMap()),this.props.courses===e.courses&&this.props.rooms===e.rooms||this.setState(t)}},{key:"render",value:function(){var e=this;return u.createElement("section",{className:"app-wrapper page-wrapper"},u.createElement(U.a,null),u.createElement(H,{predefined:!0}),u.createElement(L.a,null),u.createElement(y.d,null,u.createElement(y.b,{path:Y.b,exact:!0,render:function(){return u.createElement(q,{dispatch:e.props.dispatch})}}),u.createElement(y.b,{path:Y.nb,exact:!0,render:function(){return u.createElement(K.a,{courses:e.state.notDeletedCourses,dispatch:e.props.dispatch,location:e.props.location})}}),u.createElement(y.b,{path:Y.E,render:function(){return u.createElement(bs,{remoteClientManager:e.props.remoteClientManager,location:e.props.location,dispatch:e.props.dispatch,user:e.props.user,asyncActions:e.props.asyncActions,templates:e.nonLegacyTemplates,courses:e.state.notDeletedCourses,rooms:e.state.notDeletedRooms,vms:e.props.vms,cost:e.props.cost,loadingInitialData:e.props.loadingInitialData,routes:{cardFormRoute:Y.s,customizeVmRoute:Y.v,customVmSelectorRoute:Y.u,sessionDetailsRoute:Y.ib,vmSelectorRoute:Y.rb}})}}),u.createElement(y.b,{path:Y.I,render:function(){return u.createElement(Os,{user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,courses:e.state.notDeletedCourses,templates:e.props.templates,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:Y.eb,render:function(t){var n=t.match,r=e.state.notDeletedCourses.get(n.params.id),o=(r||{chapters:[]}).chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);o=60*Math.ceil(o/60/1e3)*1e3;var a=new Y.db(e.props.location),i=a.params.start,s=a.params.expiration,c=o>(i&&s?s-i:0)?parseInt(i,10)+o:s,p=i?m(i,Y.cb):void 0,l=c?m(c,Y.cb):void 0,d=Object(O.d)(O.a.SessionCreationRoom);return r?u.createElement(Is,{courses:e.props.courses,course:r,room:new P.P(d||{}),templates:e.props.templates,dispatch:e.props.dispatch,user:e.props.user,asyncActions:e.props.asyncActions,rooms:e.state.notDeletedRooms,startTime:p,expirationTime:l,courseDuration:o}):null}}),u.createElement(y.b,{path:Y.w,render:function(){return u.createElement(cs,{asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,templates:e.props.templates,currentChapter:e.props.currentChapter,rooms:e.state.notDeletedRooms,courses:e.props.courses,location:e.props.location,user:e.props.user,cost:e.props.cost,vms:e.props.vms,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:Y.V,render:function(){var t="true"===new Y.db(e.props.location).params.schedule;return u.createElement(Ss,{loadingInitialData:e.props.loadingInitialData,asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,user:e.props.user,templates:e.nonLegacyTemplates,rooms:e.state.notDeletedRooms,courses:e.state.notDeletedCourses,cost:e.props.cost,currentChapter:e.props.currentChapter,vms:e.props.vms,remoteClientManager:e.props.remoteClientManager,schedule:t,location:e.props.location,routes:{recordChaptersRoute:Y.Lb,recordingDetailsRoute:Y.S,recordingChaptersRoute:Y.O,recordingCardFormRoute:Y.L,recordingCustomizeVmRoute:Y.R,recordingCustomVmSelectorRoute:Y.Q,recordingsRoute:Y.Z,recordingVmSelectorRoute:Y.W},chaptersWrapperRoutes:{recordChaptersRoute:Y.Lb,recordingChapterMediaRoute:Y.M,recordingChapterPreviewRoute:Y.N,recordingChaptersRoute:Y.O,recordingChaptersUnsupportedRoute:Y.P},chapterListRoutes:{recordingChapterMediaRoute:Y.Jb,recordingChapterPreviewRoute:Y.Kb,recordingChaptersUnsupportedRoute:Y.Mb}})}}),u.createElement(y.b,{path:Y.q,render:function(){return u.createElement(Ps,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cost:e.props.cost,courses:e.state.notDeletedCourses,currentChapter:e.props.currentChapter,location:e.props.location,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,rooms:e.state.notDeletedRooms,templates:e.props.templates,user:e.props.user,vms:e.props.vms})}}),u.createElement(y.a,{to:Y.H})),u.createElement(I,{dispatch:this.props.dispatch,user:this.props.user,cost:this.props.cost,attendeeId:this.queryParams.attendee,courses:this.state.notDeletedCourses,templates:this.props.templates,asyncActions:this.props.asyncActions}))}},{key:"_loadData",value:function(e){var t=this;this._failedToInitUnsubscribe=this.props.appInitializer.onAppFailedToInitialize((function(){e(),t.props.dispatch(new v.i(new P.I({type:P.J.Info,title:"Something went wrong",text:"Please reload the page",permanent:!0})))})),this._onInitUnsubscribe=this.props.appInitializer.onAppInitialized(e),this.props.appInitializer.loadData()}},{key:"_checkIfCostShouldBeShown",value:function(){var e=this.state.notDeletedRooms.get(this.queryParams.room)||new P.P({}),t=this.state.notDeletedCourses.get(e.courseId),n=!!e.id&&Object(En.g)(e),r=this.props,o=r.dispatch,a=r.asyncActions;t&&n&&o(a.loadRoomCost(e))}},{key:"_logoutIfJwtExpiresSoon",value:function(){var e=Object(b.b)(),t=e.getJwtExpiry()-Date.now();(t=t/1e3/60/60/24)<=1&&(e.logout(),this.props.dispatch(new v.i(new P.I({type:P.J.Info,title:"Authorization token expiry",text:"Your authorization token is about to expire soon. Please login again"}))))}},{key:"queryParams",get:function(){return this._routeQueryParams.params}},{key:"nonLegacyTemplates",get:function(){return this.props.templates.filter((function(e){return!Object(g.h)(e)})).toMap()}}]),t}(u.Component);n.d(t,"AppWrapper",(function(){return Us}))}}]);
//# sourceMappingURL=4.f721d327.chunk.js.map